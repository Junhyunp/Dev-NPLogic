# NPLogic 업로드 기능 테스트 시나리오

## 테스트 파일 목록

| 파일명 | 용도 | 설명 |
|--------|------|------|
| `test_물건목록_샘플.xlsx` | Excel 업로드 테스트 | 10개의 샘플 물건 데이터 포함 |
| `test_sample_document.pdf` | PDF 업로드 테스트 | 단순 텍스트 문서 |

---

## 테스트 시나리오 A: Excel 업로드

### 사전 조건
- 앱이 정상 실행된 상태
- 로그인 완료 (Supabase 연동 필요)
- 테스트용 프로그램이 생성되어 있거나, 새로 생성할 예정

### 테스트 절차

#### 1단계: 프로그램 준비
1. 앱 실행 및 로그인
2. 좌측 메뉴에서 **"프로그램관리"** 클릭
3. **"+ 새 프로그램"** 버튼 클릭하여 테스트용 프로그램 생성
   - 프로그램명: `테스트_프로그램_업로드`
   - 설명: `업로드 테스트용`
4. 생성된 프로그램 선택

#### 2단계: 데이터 업로드 화면 접근
1. 프로그램 상세 화면에서 **"데이터 업로드"** 메뉴/탭 선택
2. 또는 좌측 메뉴에서 직접 **"데이터 업로드"** 클릭

#### 3단계: Excel 파일 업로드
1. 상단의 **"Excel 업로드"** 탭이 선택되어 있는지 확인
2. 다음 중 하나로 파일 선택:
   - **방법 A**: `test_물건목록_샘플.xlsx` 파일을 드롭존에 드래그앤드롭
   - **방법 B**: **"📂 파일 선택하기"** 버튼 클릭 후 파일 선택

#### 4단계: 컬럼 매핑 확인
1. 파일 선택 후 우측에 **"컬럼 매핑"** 섹션이 표시되는지 확인
2. **"🔄 자동 매핑"** 버튼 클릭
3. 자동 매핑 결과 확인:
   | 시스템 컬럼 | 매핑된 Excel 컬럼 |
   |------------|------------------|
   | ProjectId (프로젝트 ID) | ProjectId |
   | PropertyNumber (물건번호) | PropertyNumber |
   | PropertyType (물건유형) | PropertyType |
   | AddressFull (전체주소) | AddressFull |
   | AddressRoad (도로명주소) | AddressRoad |
   | AddressJibun (지번주소) | AddressJibun |
   | LandArea (토지면적) | LandArea |
   | BuildingArea (건물면적) | BuildingArea |
   | AppraisalValue (감정가) | AppraisalValue |
   | MinimumBid (최저입찰가) | MinimumBid |

#### 5단계: 미리보기 확인
1. **"데이터 미리보기 (상위 10행)"** 섹션에서 데이터 확인
2. 데이터가 올바르게 표시되는지 검증

#### 6단계: 업로드 실행
1. **"🚀 업로드 시작"** 버튼 클릭
2. 진행률 표시 확인
3. 완료 메시지 확인: "총 10개의 물건이 성공적으로 업로드되었습니다."

#### 7단계: 결과 검증
1. **"프로그램관리"** 화면으로 이동
2. 테스트 프로그램 선택
3. 물건 목록에서 10개의 물건이 추가되었는지 확인
4. 각 물건의 상세 정보가 올바른지 확인

### 예상 결과
- [ ] Excel 파일이 정상적으로 읽혀짐
- [ ] 컬럼 자동 매핑이 올바르게 동작함
- [ ] 10개의 물건 데이터가 DB에 저장됨
- [ ] 물건 목록에서 업로드된 데이터 확인 가능

---

## 테스트 시나리오 B: PDF 업로드

### 사전 조건
- 앱이 정상 실행된 상태
- 로그인 완료
- Supabase Storage 연결 설정 완료

### 테스트 절차

#### 1단계: 데이터 업로드 화면 접근
1. 앱 실행 및 로그인
2. **"데이터 업로드"** 메뉴 선택

#### 2단계: PDF 탭 선택
1. 상단의 **"📄 PDF 업로드"** 탭 클릭

#### 3단계: PDF 파일 선택
1. **"📂 파일 선택하기"** 버튼 클릭
2. `test_sample_document.pdf` 파일 선택
3. 선택된 파일이 목록에 표시되는지 확인:
   - 파일명: test_sample_document.pdf
   - 파일 크기 표시
   - 상태: "대기중"

#### 4단계: 업로드 실행
1. **"🚀 업로드 시작"** 버튼 클릭
2. 진행률 표시 확인
3. 상태가 "완료"로 변경되는지 확인

#### 5단계: 결과 검증
1. 완료 메시지 확인
2. (선택) Supabase 대시보드에서 Storage > documents 버킷 확인

### 예상 결과
- [ ] PDF 파일이 정상적으로 선택됨
- [ ] 파일 크기가 올바르게 표시됨
- [ ] Supabase Storage에 파일 업로드 성공
- [ ] 업로드 완료 후 상태가 "완료"로 표시됨

---

## 샘플 데이터 정보

### Excel 테스트 데이터 (test_물건목록_샘플.xlsx)

| # | 물건번호 | 물건유형 | 위치 | 감정가 |
|---|---------|---------|------|--------|
| 1 | 2024-001 | 아파트 | 서울 강남구 | 15억 |
| 2 | 2024-002 | 다가구 | 서울 서초구 | 28억 |
| 3 | 2024-003 | 상가 | 서울 마포구 | 8.5억 |
| 4 | 2024-004 | 오피스텔 | 경기 성남시 | 4.5억 |
| 5 | 2024-005 | 토지 | 경기 용인시 | 32억 |
| 6 | 2024-006 | 아파트 | 부산 해운대구 | 9.8억 |
| 7 | 2024-007 | 공장 | 경기 화성시 | 55억 |
| 8 | 2024-008 | 다세대 | 인천 남동구 | 3.2억 |
| 9 | 2024-009 | 근린시설 | 대전 서구 | 12억 |
| 10 | 2024-010 | 아파트 | 대구 수성구 | 7.2억 |

---

## 트러블슈팅

### Excel 업로드 실패 시
1. **파일 형식 확인**: `.xlsx` 또는 `.xls` 파일만 지원
2. **필수 컬럼 확인**: 위 10개 컬럼이 모두 있는지 확인
3. **데이터 형식 확인**: 숫자 컬럼(면적, 금액)에 문자가 있으면 오류 발생

### PDF 업로드 실패 시
1. **Supabase 연결 확인**: 환경 변수 설정 확인
2. **파일 크기 확인**: Supabase Storage 제한 확인 (기본 50MB)
3. **네트워크 확인**: 인터넷 연결 상태 확인

---

## 관련 파일 위치

| 구분 | 경로 |
|------|------|
| Excel 업로드 View | `src/NPLogic.App/Views/DataUploadView.xaml` |
| Excel 업로드 ViewModel | `src/NPLogic.App/ViewModels/DataUploadViewModel.cs` |
| PDF 업로드 Service | `src/NPLogic.App/Services/StorageService.cs` |

---

*작성일: 2025-01-04*

