<UserControl x:Class="NPLogic.Views.Loan.Sections.MciSection"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" 
             d:DesignHeight="350" d:DesignWidth="1000">
    
    <UserControl.Resources>
        <SolidColorBrush x:Key="TableBorderBrush" Color="#D0D0D0"/>
        <SolidColorBrush x:Key="HeaderBg" Color="#E7E7E7"/>
        <SolidColorBrush x:Key="YellowBg" Color="#FFFF00"/>
        <SolidColorBrush x:Key="BlueBg" Color="#BDD7EE"/>
        <SolidColorBrush x:Key="IndigoBg" Color="#C5CAE9"/>
        <SolidColorBrush x:Key="GreenBg" Color="#92D050"/>
        <SolidColorBrush x:Key="LightGreenBg" Color="#C6EFCE"/>
        
        <Style x:Key="CellBorder" TargetType="Border">
            <Setter Property="BorderBrush" Value="{StaticResource TableBorderBrush}"/>
            <Setter Property="BorderThickness" Value="0,0,1,1"/>
            <Setter Property="Padding" Value="6,4"/>
        </Style>
        
        <Style x:Key="HeaderCell" TargetType="Border" BasedOn="{StaticResource CellBorder}">
            <Setter Property="Background" Value="{StaticResource HeaderBg}"/>
        </Style>
        
        <Style x:Key="HeaderText" TargetType="TextBlock">
            <Setter Property="FontSize" Value="10"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="HorizontalAlignment" Value="Center"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>
        
        <Style x:Key="LabelText" TargetType="TextBlock">
            <Setter Property="FontSize" Value="10"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>
        
        <Style x:Key="AmountText" TargetType="TextBlock">
            <Setter Property="FontSize" Value="10"/>
            <Setter Property="HorizontalAlignment" Value="Right"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>
    </UserControl.Resources>
    
    <Border BorderBrush="{StaticResource TableBorderBrush}" BorderThickness="1,1,0,0">
        <StackPanel>
            <!-- 섹션 헤더 -->
            <Border Background="{StaticResource IndigoBg}" Padding="8,4" BorderBrush="{StaticResource TableBorderBrush}" BorderThickness="0,0,1,1">
                <TextBlock Text="MCI 보증" FontWeight="Bold" FontSize="12"/>
            </Border>
            
            <!-- 1안 / 2안 헤더 -->
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="150"/>
                    <ColumnDefinition Width="100"/>
                    <ColumnDefinition Width="100"/>
                </Grid.ColumnDefinitions>
                
                <Border Grid.Column="0" Style="{StaticResource HeaderCell}">
                    <TextBlock Text="구분" Style="{StaticResource HeaderText}"/>
                </Border>
                <Border Grid.Column="1" Style="{StaticResource HeaderCell}">
                    <TextBlock Text="1안 (AZ)" Style="{StaticResource HeaderText}"/>
                </Border>
                <Border Grid.Column="2" Style="{StaticResource HeaderCell}">
                    <TextBlock Text="2안 (BA)" Style="{StaticResource HeaderText}"/>
                </Border>
            </Grid>
            
            <!-- MCI최초가입금액 -->
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="150"/>
                    <ColumnDefinition Width="100"/>
                    <ColumnDefinition Width="100"/>
                </Grid.ColumnDefinitions>
                
                <Border Grid.Column="0" Style="{StaticResource CellBorder}" Background="White">
                    <TextBlock Text="MCI최초가입금액" Style="{StaticResource LabelText}"/>
                </Border>
                <Border Grid.Column="1" Style="{StaticResource CellBorder}" Background="White">
                    <TextBlock Text="{Binding MciData1.MciInitialAmount, StringFormat=N0}" Style="{StaticResource AmountText}"/>
                </Border>
                <Border Grid.Column="2" Style="{StaticResource CellBorder}" Background="White">
                    <TextBlock Text="{Binding MciData2.MciInitialAmount, StringFormat=N0}" Style="{StaticResource AmountText}"/>
                </Border>
            </Grid>
            
            <!-- MCI가입잔액 -->
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="150"/>
                    <ColumnDefinition Width="100"/>
                    <ColumnDefinition Width="100"/>
                </Grid.ColumnDefinitions>
                
                <Border Grid.Column="0" Style="{StaticResource CellBorder}" Background="White">
                    <TextBlock Text="MCI가입잔액" Style="{StaticResource LabelText}"/>
                </Border>
                <Border Grid.Column="1" Style="{StaticResource CellBorder}" Background="White">
                    <TextBlock Text="{Binding MciData1.MciBalance, StringFormat=N0}" Style="{StaticResource AmountText}"/>
                </Border>
                <Border Grid.Column="2" Style="{StaticResource CellBorder}" Background="White">
                    <TextBlock Text="{Binding MciData2.MciBalance, StringFormat=N0}" Style="{StaticResource AmountText}"/>
                </Border>
            </Grid>
            
            <!-- 최종이수일 -->
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="150"/>
                    <ColumnDefinition Width="100"/>
                    <ColumnDefinition Width="100"/>
                </Grid.ColumnDefinitions>
                
                <Border Grid.Column="0" Style="{StaticResource CellBorder}" Background="White">
                    <TextBlock Text="최종이수일" Style="{StaticResource LabelText}"/>
                </Border>
                <Border Grid.Column="1" Style="{StaticResource CellBorder}" Background="White">
                    <TextBlock Text="{Binding MciData1.LastInterestDate, StringFormat=yyyy-MM-dd}" HorizontalAlignment="Center" FontSize="10"/>
                </Border>
                <Border Grid.Column="2" Style="{StaticResource CellBorder}" Background="White">
                    <TextBlock Text="{Binding MciData2.LastInterestDate, StringFormat=yyyy-MM-dd}" HorizontalAlignment="Center" FontSize="10"/>
                </Border>
            </Grid>
            
            <!-- 예상배당일 -->
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="150"/>
                    <ColumnDefinition Width="100"/>
                    <ColumnDefinition Width="100"/>
                </Grid.ColumnDefinitions>
                
                <Border Grid.Column="0" Style="{StaticResource CellBorder}" Background="White">
                    <TextBlock Text="예상배당일" Style="{StaticResource LabelText}"/>
                </Border>
                <Border Grid.Column="1" Style="{StaticResource CellBorder}" Background="{StaticResource YellowBg}">
                    <TextBlock Text="{Binding MciData1.ExpectedDividendDate, StringFormat=yyyy-MM-dd}" HorizontalAlignment="Center" FontSize="10"/>
                </Border>
                <Border Grid.Column="2" Style="{StaticResource CellBorder}" Background="{StaticResource YellowBg}">
                    <TextBlock Text="{Binding MciData2.ExpectedDividendDate, StringFormat=yyyy-MM-dd}" HorizontalAlignment="Center" FontSize="10"/>
                </Border>
            </Grid>
            
            <!-- 일수 -->
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="150"/>
                    <ColumnDefinition Width="100"/>
                    <ColumnDefinition Width="100"/>
                </Grid.ColumnDefinitions>
                
                <Border Grid.Column="0" Style="{StaticResource CellBorder}" Background="White">
                    <TextBlock Text="일수" Style="{StaticResource LabelText}"/>
                </Border>
                <Border Grid.Column="1" Style="{StaticResource CellBorder}" Background="{StaticResource BlueBg}">
                    <TextBlock Text="{Binding MciData1.Days}" HorizontalAlignment="Center" FontSize="10"/>
                </Border>
                <Border Grid.Column="2" Style="{StaticResource CellBorder}" Background="{StaticResource BlueBg}">
                    <TextBlock Text="{Binding MciData2.Days}" HorizontalAlignment="Center" FontSize="10"/>
                </Border>
            </Grid>
            
            <!-- 정상이자율 -->
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="150"/>
                    <ColumnDefinition Width="100"/>
                    <ColumnDefinition Width="100"/>
                </Grid.ColumnDefinitions>
                
                <Border Grid.Column="0" Style="{StaticResource CellBorder}" Background="White">
                    <TextBlock Text="정상이자율" Style="{StaticResource LabelText}"/>
                </Border>
                <Border Grid.Column="1" Style="{StaticResource CellBorder}" Background="White">
                    <TextBlock Text="{Binding MciData1.NormalInterestRate, StringFormat=P2}" HorizontalAlignment="Center" FontSize="10"/>
                </Border>
                <Border Grid.Column="2" Style="{StaticResource CellBorder}" Background="White">
                    <TextBlock Text="{Binding MciData2.NormalInterestRate, StringFormat=P2}" HorizontalAlignment="Center" FontSize="10"/>
                </Border>
            </Grid>
            
            <!-- 유효담보가 배당액 -->
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="150"/>
                    <ColumnDefinition Width="100"/>
                    <ColumnDefinition Width="100"/>
                </Grid.ColumnDefinitions>
                
                <Border Grid.Column="0" Style="{StaticResource CellBorder}" Background="White">
                    <TextBlock Text="유효담보가 배당액" Style="{StaticResource LabelText}"/>
                </Border>
                <Border Grid.Column="1" Style="{StaticResource CellBorder}" Background="{StaticResource BlueBg}">
                    <TextBlock Text="{Binding MciData1.ValidCollateralDividend, StringFormat=N0}" Style="{StaticResource AmountText}"/>
                </Border>
                <Border Grid.Column="2" Style="{StaticResource CellBorder}" Background="{StaticResource BlueBg}">
                    <TextBlock Text="{Binding MciData2.ValidCollateralDividend, StringFormat=N0}" Style="{StaticResource AmountText}"/>
                </Border>
            </Grid>
            
            <!-- 배당후 손실액 -->
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="150"/>
                    <ColumnDefinition Width="100"/>
                    <ColumnDefinition Width="100"/>
                </Grid.ColumnDefinitions>
                
                <Border Grid.Column="0" Style="{StaticResource CellBorder}" Background="White">
                    <TextBlock Text="배당후 손실액" Style="{StaticResource LabelText}"/>
                </Border>
                <Border Grid.Column="1" Style="{StaticResource CellBorder}" Background="{StaticResource BlueBg}">
                    <TextBlock Text="{Binding MciData1.PostDividendLoss, StringFormat=N0}" Style="{StaticResource AmountText}"/>
                </Border>
                <Border Grid.Column="2" Style="{StaticResource CellBorder}" Background="{StaticResource BlueBg}">
                    <TextBlock Text="{Binding MciData2.PostDividendLoss, StringFormat=N0}" Style="{StaticResource AmountText}"/>
                </Border>
            </Grid>
            
            <!-- MCI 청구액 -->
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="150"/>
                    <ColumnDefinition Width="100"/>
                    <ColumnDefinition Width="100"/>
                </Grid.ColumnDefinitions>
                
                <Border Grid.Column="0" Style="{StaticResource CellBorder}" Background="{StaticResource LightGreenBg}">
                    <TextBlock Text="MCI 청구액" Style="{StaticResource LabelText}" FontWeight="SemiBold"/>
                </Border>
                <Border Grid.Column="1" Style="{StaticResource CellBorder}" Background="{StaticResource GreenBg}">
                    <TextBlock Text="{Binding MciData1.MciClaimAmount, StringFormat=N0}" Style="{StaticResource AmountText}" FontWeight="Bold"/>
                </Border>
                <Border Grid.Column="2" Style="{StaticResource CellBorder}" Background="{StaticResource GreenBg}">
                    <TextBlock Text="{Binding MciData2.MciClaimAmount, StringFormat=N0}" Style="{StaticResource AmountText}" FontWeight="Bold"/>
                </Border>
            </Grid>
            
            <!-- 설명 -->
            <Border Background="#E8EAF6" Padding="8,4" BorderBrush="{StaticResource TableBorderBrush}" BorderThickness="0,0,1,1">
                <TextBlock FontSize="9" Foreground="#666666" TextWrapping="Wrap">
                    <Run Text="• MCI 청구액 = min(배당후 손실액, MCI가입잔액 × 청구지급율%)"/>
                    <LineBreak/>
                    <Run Text="• 유효담보가 배당액 = min(유효담보가, 예상배당금)"/>
                </TextBlock>
            </Border>
        </StackPanel>
    </Border>
</UserControl>
