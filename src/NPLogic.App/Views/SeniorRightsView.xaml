<UserControl x:Class="NPLogic.Views.SeniorRightsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:NPLogic.Views"
             xmlns:vm="clr-namespace:NPLogic.ViewModels"
             mc:Ignorable="d" 
             d:DesignHeight="900" d:DesignWidth="1600"
             d:DataContext="{d:DesignInstance Type=vm:SeniorRightsViewModel}"
             Loaded="SeniorRightsView_Loaded">
    
    <UserControl.Resources>
        <!-- 테이블 스타일 (LoanDetailView와 동일) -->
        <SolidColorBrush x:Key="TableBorderBrush" Color="#E0E0E0"/>
        
        <!-- 섹션 헤더 스타일 -->
        <Style x:Key="SectionHeaderStyle" TargetType="TextBlock">
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Foreground" Value="{StaticResource PrimaryBrush}"/>
            <Setter Property="Margin" Value="0,0,0,12"/>
        </Style>
        
        <!-- 라벨 스타일 -->
        <Style x:Key="LabelStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="TextTrimming" Value="CharacterEllipsis"/>
            <Setter Property="TextWrapping" Value="NoWrap"/>
        </Style>
        
        <!-- 값 스타일 -->
        <Style x:Key="ValueStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="TextTrimming" Value="CharacterEllipsis"/>
            <Setter Property="TextWrapping" Value="NoWrap"/>
        </Style>
        
        <!-- 금액 스타일 -->
        <Style x:Key="AmountStyle" TargetType="TextBlock" BasedOn="{StaticResource ValueStyle}">
            <Setter Property="HorizontalAlignment" Value="Right"/>
        </Style>
        
        <!-- 테이블 셀 스타일 -->
        <Style x:Key="TableCellStyle" TargetType="Border">
            <Setter Property="BorderBrush" Value="{StaticResource TableBorderBrush}"/>
            <Setter Property="BorderThickness" Value="0,0,1,1"/>
            <Setter Property="Padding" Value="6,6"/>
            <Setter Property="Background" Value="Transparent"/>
        </Style>
        
        <!-- 테이블 헤더 셀 스타일 -->
        <Style x:Key="TableHeaderCellStyle" TargetType="Border" BasedOn="{StaticResource TableCellStyle}">
            <Setter Property="Background" Value="{StaticResource SurfaceColor}"/>
            <Setter Property="Padding" Value="4,6"/>
        </Style>
        
        <!-- 노란색 하이라이트 셀 -->
        <Style x:Key="YellowHighlightCellStyle" TargetType="Border" BasedOn="{StaticResource TableCellStyle}">
            <Setter Property="Background" Value="#FFFDE7"/>
        </Style>
        
        <!-- 입력 TextBox 스타일 -->
        <Style x:Key="InputTextBoxStyle" TargetType="TextBox">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0,0,0,1"/>
            <Setter Property="BorderBrush" Value="{StaticResource TableBorderBrush}"/>
            <Setter Property="Padding" Value="2,2"/>
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
        </Style>
        
        <!-- 읽기 전용 TextBox 스타일 -->
        <Style x:Key="ReadOnlyTextBoxStyle" TargetType="TextBox" BasedOn="{StaticResource InputTextBoxStyle}">
            <Setter Property="IsReadOnly" Value="True"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
        </Style>
        
        <!-- 컴팩트 CheckBox -->
        <Style x:Key="CompactCheckBoxStyle" TargetType="CheckBox">
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Margin" Value="0"/>
        </Style>
        
        <!-- 컴팩트 DatePicker -->
        <Style x:Key="CompactDatePickerStyle" TargetType="DatePicker">
            <Setter Property="FontSize" Value="10"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Padding" Value="2"/>
        </Style>
        
        <!-- 링크 버튼 스타일 -->
        <Style x:Key="LinkButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Foreground" Value="{StaticResource PrimaryBrush}"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Padding" Value="4,2"/>
        </Style>
    </UserControl.Resources>
    
    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- 헤더 영역 -->
        <Grid Grid.Row="0" Margin="0,0,0,12">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <StackPanel Grid.Column="0">
                <TextBlock Text="선순위(Ⅴ)" 
                           Style="{StaticResource H2TextStyle}"
                           Margin="0,0,0,4"/>
                <TextBlock Style="{StaticResource BodyTextStyle}" Opacity="0.7">
                    <Run Text="경매사건 및 선순위 분석 | 선순위 합계:"/>
                    <Run Text="{Binding SeniorRightsTotal, StringFormat=N0, FallbackValue=0}" FontWeight="SemiBold"/>
                    <Run Text="원"/>
                </TextBlock>
            </StackPanel>

            <StackPanel Grid.Column="1" Orientation="Horizontal">
                <Button Content="Excel 내보내기" 
                        Command="{Binding ExportToExcelCommand}"
                        Style="{StaticResource SecondaryButton}"
                        Padding="16,8"
                        Margin="0,0,8,0"/>
                <Button Content="새로고침" 
                        Command="{Binding RefreshCommand}"
                        Style="{StaticResource SecondaryButton}"
                        Padding="16,8"/>
            </StackPanel>
        </Grid>

        <!-- 메인 컨텐츠 - 수평 스크롤 지원 -->
        <Border Grid.Row="1" Background="{StaticResource SurfaceColor}" CornerRadius="8" Padding="12">
            <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                <StackPanel MinWidth="1400">
                    
                    <!-- ========== 1. 경매사건 및 선순위 상단 정보 ========== -->
                    <Border BorderBrush="{StaticResource TableBorderBrush}" BorderThickness="1" Margin="0,0,0,16">
                        <StackPanel>
                            <TextBlock Text="경매사건 및 선순위" Style="{StaticResource SectionHeaderStyle}" Margin="8,8,8,4"/>
                            
                            <!-- 선행/후행 동시 표시 (피드백 #28) -->
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                
                                <!-- 선행 정보 -->
                                <Border Grid.Column="0" BorderBrush="{StaticResource TableBorderBrush}" BorderThickness="0,0,1,0">
                                    <StackPanel>
                                        <TextBlock Text="선행" FontWeight="SemiBold" FontSize="12" Padding="8,4" Background="#E3F2FD"/>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="100"/>
                                                <ColumnDefinition Width="140"/>
                                                <ColumnDefinition Width="80"/>
                                                <ColumnDefinition Width="140"/>
                                                <ColumnDefinition Width="80"/>
                                                <ColumnDefinition Width="140"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            
                                            <!-- Row 1 -->
                                            <Border Grid.Row="0" Grid.Column="0" Style="{StaticResource TableHeaderCellStyle}">
                                                <TextBlock Text="경매개시여부" Style="{StaticResource LabelStyle}"/>
                                            </Border>
                                            <Border Grid.Row="0" Grid.Column="1" Style="{StaticResource TableCellStyle}">
                                                <ComboBox SelectedValue="{Binding PrecedentAuctionStatus}" SelectedValuePath="Tag" FontSize="11">
                                                    <ComboBoxItem Content="경매개시" Tag="opened"/>
                                                    <ComboBoxItem Content="경매미개시" Tag="not_opened"/>
                                                </ComboBox>
                                            </Border>
                                            <Border Grid.Row="0" Grid.Column="2" Style="{StaticResource TableHeaderCellStyle}">
                                                <TextBlock Text="관할법원" Style="{StaticResource LabelStyle}"/>
                                            </Border>
                                            <Border Grid.Row="0" Grid.Column="3" Style="{StaticResource TableCellStyle}">
                                                <TextBox Text="{Binding PrecedentCourtName, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource InputTextBoxStyle}"/>
                                            </Border>
                                            <Border Grid.Row="0" Grid.Column="4" Style="{StaticResource TableHeaderCellStyle}">
                                                <TextBlock Text="경매사건번호" Style="{StaticResource LabelStyle}"/>
                                            </Border>
                                            <Border Grid.Row="0" Grid.Column="5" Style="{StaticResource TableCellStyle}">
                                                <TextBox Text="{Binding PrecedentCaseNumber, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource InputTextBoxStyle}"/>
                                            </Border>
                                            
                                            <!-- Row 2 -->
                                            <Border Grid.Row="1" Grid.Column="0" Style="{StaticResource TableHeaderCellStyle}">
                                                <TextBlock Text="경매신청기관" Style="{StaticResource LabelStyle}"/>
                                            </Border>
                                            <Border Grid.Row="1" Grid.Column="1" Style="{StaticResource TableCellStyle}">
                                                <TextBox Text="{Binding PrecedentAuctionApplicant, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource InputTextBoxStyle}"/>
                                            </Border>
                                            <Border Grid.Row="1" Grid.Column="2" Style="{StaticResource TableHeaderCellStyle}">
                                                <TextBlock Text="경매개시일자" Style="{StaticResource LabelStyle}"/>
                                            </Border>
                                            <Border Grid.Row="1" Grid.Column="3" Style="{StaticResource TableCellStyle}">
                                                <DatePicker SelectedDate="{Binding PrecedentAuctionStartDate}" Style="{StaticResource CompactDatePickerStyle}"/>
                                            </Border>
                                            <Border Grid.Row="1" Grid.Column="4" Style="{StaticResource TableHeaderCellStyle}">
                                                <TextBlock Text="배당요구종기일" Style="{StaticResource LabelStyle}"/>
                                            </Border>
                                            <Border Grid.Row="1" Grid.Column="5" Style="{StaticResource TableCellStyle}">
                                                <DatePicker SelectedDate="{Binding PrecedentClaimDeadlineDate}" Style="{StaticResource CompactDatePickerStyle}"/>
                                            </Border>
                                            
                                            <!-- Row 3 -->
                                            <Border Grid.Row="2" Grid.Column="0" Style="{StaticResource TableHeaderCellStyle}">
                                                <TextBlock Text="청구금액" Style="{StaticResource LabelStyle}"/>
                                            </Border>
                                            <Border Grid.Row="2" Grid.Column="1" Style="{StaticResource TableCellStyle}">
                                                <TextBox Text="{Binding PrecedentClaimAmount, StringFormat=N0, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource InputTextBoxStyle}"/>
                                            </Border>
                                            <Border Grid.Row="2" Grid.Column="2" Style="{StaticResource TableHeaderCellStyle}">
                                                <TextBlock Text="최초법사가" Style="{StaticResource LabelStyle}"/>
                                            </Border>
                                            <Border Grid.Row="2" Grid.Column="3" Style="{StaticResource YellowHighlightCellStyle}">
                                                <TextBox Text="{Binding PrecedentInitialAppraisalValue, StringFormat=N0, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource InputTextBoxStyle}"/>
                                            </Border>
                                            <Border Grid.Row="2" Grid.Column="4" Style="{StaticResource TableHeaderCellStyle}">
                                                <TextBlock Text="최초경매기일" Style="{StaticResource LabelStyle}"/>
                                            </Border>
                                            <Border Grid.Row="2" Grid.Column="5" Style="{StaticResource TableCellStyle}">
                                                <DatePicker SelectedDate="{Binding PrecedentInitialAuctionDate}" Style="{StaticResource CompactDatePickerStyle}"/>
                                            </Border>
                                            
                                            <!-- Row 4 -->
                                            <Border Grid.Row="3" Grid.Column="0" Style="{StaticResource TableHeaderCellStyle}">
                                                <TextBlock Text="최종경매회차" Style="{StaticResource LabelStyle}"/>
                                            </Border>
                                            <Border Grid.Row="3" Grid.Column="1" Style="{StaticResource TableCellStyle}">
                                                <TextBox Text="{Binding PrecedentFinalAuctionRound, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource InputTextBoxStyle}"/>
                                            </Border>
                                            <Border Grid.Row="3" Grid.Column="2" Style="{StaticResource TableHeaderCellStyle}">
                                                <TextBlock Text="최종경매기일" Style="{StaticResource LabelStyle}"/>
                                            </Border>
                                            <Border Grid.Row="3" Grid.Column="3" Style="{StaticResource TableCellStyle}">
                                                <DatePicker SelectedDate="{Binding PrecedentFinalAuctionDate}" Style="{StaticResource CompactDatePickerStyle}"/>
                                            </Border>
                                            <Border Grid.Row="3" Grid.Column="4" Style="{StaticResource TableHeaderCellStyle}">
                                                <TextBlock Text="최종경매결과" Style="{StaticResource LabelStyle}"/>
                                            </Border>
                                            <Border Grid.Row="3" Grid.Column="5" Style="{StaticResource TableCellStyle}">
                                                <TextBox Text="{Binding PrecedentFinalAuctionResult, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource InputTextBoxStyle}"/>
                                            </Border>
                                        </Grid>
                                    </StackPanel>
                                </Border>
                                
                                <!-- 후행 정보 -->
                                <Border Grid.Column="1">
                                    <StackPanel>
                                        <TextBlock Text="후행" FontWeight="SemiBold" FontSize="12" Padding="8,4" Background="#FFF3E0"/>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="100"/>
                                                <ColumnDefinition Width="140"/>
                                                <ColumnDefinition Width="80"/>
                                                <ColumnDefinition Width="140"/>
                                                <ColumnDefinition Width="80"/>
                                                <ColumnDefinition Width="140"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            
                                            <!-- Row 1 -->
                                            <Border Grid.Row="0" Grid.Column="0" Style="{StaticResource TableHeaderCellStyle}">
                                                <TextBlock Text="경매개시여부" Style="{StaticResource LabelStyle}"/>
                                            </Border>
                                            <Border Grid.Row="0" Grid.Column="1" Style="{StaticResource TableCellStyle}">
                                                <ComboBox SelectedValue="{Binding SubsequentAuctionStatus}" SelectedValuePath="Tag" FontSize="11">
                                                    <ComboBoxItem Content="경매개시" Tag="opened"/>
                                                    <ComboBoxItem Content="경매미개시" Tag="not_opened"/>
                                                </ComboBox>
                                            </Border>
                                            <Border Grid.Row="0" Grid.Column="2" Style="{StaticResource TableHeaderCellStyle}">
                                                <TextBlock Text="관할법원" Style="{StaticResource LabelStyle}"/>
                                            </Border>
                                            <Border Grid.Row="0" Grid.Column="3" Style="{StaticResource TableCellStyle}">
                                                <TextBox Text="{Binding SubsequentCourtName, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource InputTextBoxStyle}"/>
                                            </Border>
                                            <Border Grid.Row="0" Grid.Column="4" Style="{StaticResource TableHeaderCellStyle}">
                                                <TextBlock Text="경매사건번호" Style="{StaticResource LabelStyle}"/>
                                            </Border>
                                            <Border Grid.Row="0" Grid.Column="5" Style="{StaticResource TableCellStyle}">
                                                <TextBox Text="{Binding SubsequentCaseNumber, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource InputTextBoxStyle}"/>
                                            </Border>
                                            
                                            <!-- Row 2 -->
                                            <Border Grid.Row="1" Grid.Column="0" Style="{StaticResource TableHeaderCellStyle}">
                                                <TextBlock Text="경매신청기관" Style="{StaticResource LabelStyle}"/>
                                            </Border>
                                            <Border Grid.Row="1" Grid.Column="1" Style="{StaticResource TableCellStyle}">
                                                <TextBox Text="{Binding SubsequentAuctionApplicant, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource InputTextBoxStyle}"/>
                                            </Border>
                                            <Border Grid.Row="1" Grid.Column="2" Style="{StaticResource TableHeaderCellStyle}">
                                                <TextBlock Text="경매개시일자" Style="{StaticResource LabelStyle}"/>
                                            </Border>
                                            <Border Grid.Row="1" Grid.Column="3" Style="{StaticResource TableCellStyle}">
                                                <DatePicker SelectedDate="{Binding SubsequentAuctionStartDate}" Style="{StaticResource CompactDatePickerStyle}"/>
                                            </Border>
                                            <Border Grid.Row="1" Grid.Column="4" Style="{StaticResource TableHeaderCellStyle}">
                                                <TextBlock Text="배당요구종기일" Style="{StaticResource LabelStyle}"/>
                                            </Border>
                                            <Border Grid.Row="1" Grid.Column="5" Style="{StaticResource TableCellStyle}">
                                                <DatePicker SelectedDate="{Binding SubsequentClaimDeadlineDate}" Style="{StaticResource CompactDatePickerStyle}"/>
                                            </Border>
                                            
                                            <!-- Row 3 -->
                                            <Border Grid.Row="2" Grid.Column="0" Style="{StaticResource TableHeaderCellStyle}">
                                                <TextBlock Text="낙찰금액" Style="{StaticResource LabelStyle}"/>
                                            </Border>
                                            <Border Grid.Row="2" Grid.Column="1" Style="{StaticResource TableCellStyle}">
                                                <TextBox Text="{Binding SubsequentWinningBidAmount, StringFormat=N0, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource InputTextBoxStyle}"/>
                                            </Border>
                                            <Border Grid.Row="2" Grid.Column="2" Style="{StaticResource TableHeaderCellStyle}">
                                                <TextBlock Text="최종경매일 최저입찰가" Style="{StaticResource LabelStyle}"/>
                                            </Border>
                                            <Border Grid.Row="2" Grid.Column="3" Style="{StaticResource TableCellStyle}">
                                                <TextBox Text="{Binding SubsequentMinimumBid, StringFormat=N0, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource InputTextBoxStyle}"/>
                                            </Border>
                                            <Border Grid.Row="2" Grid.Column="4" Style="{StaticResource TableHeaderCellStyle}">
                                                <TextBlock Text="차후예정 최저입찰가" Style="{StaticResource LabelStyle}"/>
                                            </Border>
                                            <Border Grid.Row="2" Grid.Column="5" Style="{StaticResource TableCellStyle}">
                                                <TextBox Text="{Binding SubsequentNextMinimumBid, StringFormat=N0, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource InputTextBoxStyle}"/>
                                            </Border>
                                            
                                            <!-- Row 4: 링크 버튼들 -->
                                            <Border Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="6" Style="{StaticResource TableCellStyle}">
                                                <StackPanel Orientation="Horizontal">
                                                    <Button Content="당사자내역" Command="{Binding OpenPartyDetailsCommand}" Style="{StaticResource LinkButtonStyle}" Margin="0,0,16,0"/>
                                                    <Button Content="경매사건검색" Command="{Binding OpenAuctionSearchCommand}" Style="{StaticResource LinkButtonStyle}" Margin="0,0,16,0"/>
                                                    <Button Content="기일내역검색" Command="{Binding OpenScheduleSearchCommand}" Style="{StaticResource LinkButtonStyle}" Margin="0,0,16,0"/>
                                                    <Button Content="문건송달내역" Command="{Binding OpenDocumentDeliveryCommand}" Style="{StaticResource LinkButtonStyle}"/>
                                                </StackPanel>
                                            </Border>
                                        </Grid>
                                    </StackPanel>
                                </Border>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- ========== 2. 체크박스 섹션 + 등기부 정보 ========== -->
                    <Border BorderBrush="{StaticResource TableBorderBrush}" BorderThickness="1" Margin="0,0,0,16">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="350"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <!-- 좌측: 체크박스 섹션 -->
                            <Border Grid.Column="0" BorderBrush="{StaticResource TableBorderBrush}" BorderThickness="0,0,1,0">
                                <StackPanel Margin="8">
                                    <TextBlock Text="전입/임차 현황" Style="{StaticResource SectionHeaderStyle}"/>
                                    
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="180"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        
                                        <Border Grid.Row="0" Grid.Column="0" Style="{StaticResource TableHeaderCellStyle}">
                                            <TextBlock Text="물건지, 소유주 주소지 일치여부" Style="{StaticResource LabelStyle}"/>
                                        </Border>
                                        <Border Grid.Row="0" Grid.Column="1" Style="{StaticResource TableCellStyle}">
                                            <CheckBox IsChecked="{Binding AddressMatch}" Style="{StaticResource CompactCheckBoxStyle}" Content="Y"/>
                                        </Border>
                                        
                                        <Border Grid.Row="1" Grid.Column="0" Style="{StaticResource TableHeaderCellStyle}">
                                            <TextBlock Text="소유주 전입" Style="{StaticResource LabelStyle}"/>
                                        </Border>
                                        <Border Grid.Row="1" Grid.Column="1" Style="{StaticResource TableCellStyle}">
                                            <CheckBox IsChecked="{Binding OwnerRegistered}" Style="{StaticResource CompactCheckBoxStyle}" Content="Y"/>
                                        </Border>
                                        
                                        <Border Grid.Row="2" Grid.Column="0" Style="{StaticResource TableHeaderCellStyle}">
                                            <TextBlock Text="전입인(임차인)" Style="{StaticResource LabelStyle}"/>
                                        </Border>
                                        <Border Grid.Row="2" Grid.Column="1" Style="{StaticResource TableCellStyle}">
                                            <TextBox Text="{Binding TenantName, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource InputTextBoxStyle}"/>
                                        </Border>
                                        
                                        <Border Grid.Row="3" Grid.Column="0" Style="{StaticResource TableHeaderCellStyle}">
                                            <TextBlock Text="전입일(임차시작일)" Style="{StaticResource LabelStyle}"/>
                                        </Border>
                                        <Border Grid.Row="3" Grid.Column="1" Style="{StaticResource TableCellStyle}">
                                            <DatePicker SelectedDate="{Binding TenantMoveInDate}" Style="{StaticResource CompactDatePickerStyle}"/>
                                        </Border>
                                        
                                        <Border Grid.Row="4" Grid.Column="0" Style="{StaticResource TableHeaderCellStyle}">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="주택공시가격" Style="{StaticResource LabelStyle}"/>
                                                <Button Content="조회" Command="{Binding OpenHousingPriceCommand}" Style="{StaticResource LinkButtonStyle}" Margin="4,0,0,0"/>
                                            </StackPanel>
                                        </Border>
                                        <Border Grid.Row="4" Grid.Column="1" Style="{StaticResource TableCellStyle}">
                                            <TextBox Text="{Binding HousingOfficialPrice, StringFormat=N0, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource InputTextBoxStyle}"/>
                                        </Border>
                                        
                                        <Border Grid.Row="5" Grid.Column="0" Style="{StaticResource TableHeaderCellStyle}">
                                            <TextBlock Text="임금채권" Style="{StaticResource LabelStyle}"/>
                                        </Border>
                                        <Border Grid.Row="5" Grid.Column="1" Style="{StaticResource TableCellStyle}">
                                            <CheckBox IsChecked="{Binding HasWageClaim}" Style="{StaticResource CompactCheckBoxStyle}" Content="Y"/>
                                        </Border>
                                        
                                        <Border Grid.Row="6" Grid.Column="0" Style="{StaticResource TableHeaderCellStyle}">
                                            <TextBlock Text="임금채권 추정가압류" Style="{StaticResource LabelStyle}"/>
                                        </Border>
                                        <Border Grid.Row="6" Grid.Column="1" Style="{StaticResource TableCellStyle}">
                                            <CheckBox IsChecked="{Binding WageClaimEstimatedSeizure}" Style="{StaticResource CompactCheckBoxStyle}" Content="Y"/>
                                        </Border>
                                        
                                        <Border Grid.Row="7" Grid.Column="0" Style="{StaticResource TableHeaderCellStyle}">
                                            <TextBlock Text="임금채권 배당요구신청" Style="{StaticResource LabelStyle}"/>
                                        </Border>
                                        <Border Grid.Row="7" Grid.Column="1" Style="{StaticResource TableCellStyle}">
                                            <CheckBox IsChecked="{Binding WageClaimSubmitted}" Style="{StaticResource CompactCheckBoxStyle}" Content="Y"/>
                                        </Border>
                                        
                                        <Border Grid.Row="8" Grid.Column="0" Style="{StaticResource TableHeaderCellStyle}">
                                            <TextBlock Text="당해세 교부청구" Style="{StaticResource LabelStyle}"/>
                                        </Border>
                                        <Border Grid.Row="8" Grid.Column="1" Style="{StaticResource TableCellStyle}">
                                            <CheckBox IsChecked="{Binding HasTaxClaim}" Style="{StaticResource CompactCheckBoxStyle}" Content="Y"/>
                                        </Border>
                                        
                                        <Border Grid.Row="9" Grid.Column="0" Style="{StaticResource TableHeaderCellStyle}">
                                            <TextBlock Text="선순위조세 교부청구" Style="{StaticResource LabelStyle}"/>
                                        </Border>
                                        <Border Grid.Row="9" Grid.Column="1" Style="{StaticResource TableCellStyle}">
                                            <CheckBox IsChecked="{Binding HasSeniorTaxClaim}" Style="{StaticResource CompactCheckBoxStyle}" Content="Y"/>
                                        </Border>
                                    </Grid>
                                </StackPanel>
                            </Border>
                            
                            <!-- 우측: 등기부 정보 테이블 -->
                            <StackPanel Grid.Column="1" Margin="8">
                                <TextBlock Text="접수정보 (등기부)" Style="{StaticResource SectionHeaderStyle}"/>
                                
                                <DataGrid ItemsSource="{Binding RegistryEntries}" 
                                          AutoGenerateColumns="False" 
                                          IsReadOnly="True"
                                          Background="{StaticResource SurfaceBrush}"
                                          BorderBrush="{StaticResource TableBorderBrush}"
                                          BorderThickness="1"
                                          CanUserAddRows="False"
                                          GridLinesVisibility="All"
                                          HorizontalGridLinesBrush="{StaticResource TableBorderBrush}"
                                          VerticalGridLinesBrush="{StaticResource TableBorderBrush}"
                                          MaxHeight="200"
                                          RowHeight="32"
                                          FontSize="11">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="접수정보" Binding="{Binding RegistrationNumber}" Width="100"/>
                                        <DataGridTextColumn Header="근저당권자" Binding="{Binding RightHolder}" Width="180"/>
                                        <DataGridTextColumn Header="채권최고액" Binding="{Binding ClaimAmount, StringFormat=N0}" Width="120"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- ========== 3. 열람 자료 섹션 (피드백 #29) ========== -->
                    <Border BorderBrush="{StaticResource TableBorderBrush}" BorderThickness="1" Margin="0,0,0,16">
                        <StackPanel>
                            <TextBlock Text="열람 자료" Style="{StaticResource SectionHeaderStyle}" Margin="8,8,8,4"/>
                            
                            <Grid Margin="8">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                
                                <!-- 전입세대열람 -->
                                <Border Grid.Column="0" BorderBrush="{StaticResource TableBorderBrush}" BorderThickness="1" Margin="0,0,4,0">
                                    <StackPanel>
                                        <Border Background="#E8F5E9" Padding="8,4">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="전입세대열람" FontWeight="SemiBold" FontSize="12"/>
                                                <TextBlock Text="(주택)" FontSize="10" Opacity="0.7" Margin="4,0,0,0" VerticalAlignment="Center"/>
                                            </StackPanel>
                                        </Border>
                                        <Border Padding="8" MinHeight="100">
                                            <StackPanel>
                                                <Button Content="이미지 붙여넣기" Command="{Binding PasteTenantRegistryImageCommand}" Style="{StaticResource SecondaryButton}" Padding="8,4" FontSize="10" Margin="0,0,0,8"/>
                                                <Image Source="{Binding TenantRegistryImage}" MaxHeight="80" Stretch="Uniform"/>
                                                <TextBlock Text="{Binding TenantRegistryImageInfo}" FontSize="10" Opacity="0.7" TextWrapping="Wrap"/>
                                            </StackPanel>
                                        </Border>
                                    </StackPanel>
                                </Border>
                                
                                <!-- 상가임대차열람 -->
                                <Border Grid.Column="1" BorderBrush="{StaticResource TableBorderBrush}" BorderThickness="1" Margin="0,0,4,0">
                                    <StackPanel>
                                        <Border Background="#FFF3E0" Padding="8,4">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="상가임대차열람" FontWeight="SemiBold" FontSize="12"/>
                                                <TextBlock Text="(상가)" FontSize="10" Opacity="0.7" Margin="4,0,0,0" VerticalAlignment="Center"/>
                                            </StackPanel>
                                        </Border>
                                        <Border Padding="8" MinHeight="100">
                                            <StackPanel>
                                                <Button Content="이미지 붙여넣기" Command="{Binding PasteCommercialLeaseImageCommand}" Style="{StaticResource SecondaryButton}" Padding="8,4" FontSize="10" Margin="0,0,0,8"/>
                                                <Image Source="{Binding CommercialLeaseImage}" MaxHeight="80" Stretch="Uniform"/>
                                                <TextBlock Text="{Binding CommercialLeaseImageInfo}" FontSize="10" Opacity="0.7" TextWrapping="Wrap"/>
                                            </StackPanel>
                                        </Border>
                                    </StackPanel>
                                </Border>
                                
                                <!-- 권리분석 -->
                                <Border Grid.Column="2" BorderBrush="{StaticResource TableBorderBrush}" BorderThickness="1" Margin="0,0,4,0">
                                    <StackPanel>
                                        <Border Background="#E3F2FD" Padding="8,4">
                                            <TextBlock Text="권리분석" FontWeight="SemiBold" FontSize="12"/>
                                        </Border>
                                        <Border Padding="8" MinHeight="100">
                                            <StackPanel>
                                                <Button Content="이미지 붙여넣기" Command="{Binding PasteRightsAnalysisImageCommand}" Style="{StaticResource SecondaryButton}" Padding="8,4" FontSize="10" Margin="0,0,0,8"/>
                                                <Image Source="{Binding RightsAnalysisImage}" MaxHeight="80" Stretch="Uniform"/>
                                                <TextBlock Text="{Binding RightsAnalysisImageInfo}" FontSize="10" Opacity="0.7" TextWrapping="Wrap"/>
                                            </StackPanel>
                                        </Border>
                                    </StackPanel>
                                </Border>
                                
                                <!-- 임금자료 -->
                                <Border Grid.Column="3" BorderBrush="{StaticResource TableBorderBrush}" BorderThickness="1">
                                    <StackPanel>
                                        <Border Background="#FCE4EC" Padding="8,4">
                                            <TextBlock Text="임금자료" FontWeight="SemiBold" FontSize="12"/>
                                        </Border>
                                        <Border Padding="8" MinHeight="100">
                                            <StackPanel>
                                                <Button Content="이미지 붙여넣기" Command="{Binding PasteWageDataImageCommand}" Style="{StaticResource SecondaryButton}" Padding="8,4" FontSize="10" Margin="0,0,0,8"/>
                                                <Image Source="{Binding WageDataImage}" MaxHeight="80" Stretch="Uniform"/>
                                                <TextBlock Text="{Binding WageDataImageInfo}" FontSize="10" Opacity="0.7" TextWrapping="Wrap"/>
                                            </StackPanel>
                                        </Border>
                                    </StackPanel>
                                </Border>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- ========== 4. Tool Box: 주택임대차 테이블 ========== -->
                    <Border BorderBrush="{StaticResource TableBorderBrush}" BorderThickness="1" Margin="0,0,0,16">
                        <StackPanel>
                            <Border Background="#E8F5E9" Padding="8,4">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="Tool Box > 주택임대차" FontWeight="SemiBold" FontSize="12"/>
                                    <Button Content="+ 행 추가" Command="{Binding AddResidentialLeaseRowCommand}" Style="{StaticResource LinkButtonStyle}" Margin="16,0,0,0"/>
                                </StackPanel>
                            </Border>
                            
                            <DataGrid ItemsSource="{Binding ResidentialLeases}" 
                                      AutoGenerateColumns="False" 
                                      CanUserAddRows="False"
                                      Background="Transparent"
                                      BorderThickness="0"
                                      GridLinesVisibility="All"
                                      HorizontalGridLinesBrush="{StaticResource TableBorderBrush}"
                                      VerticalGridLinesBrush="{StaticResource TableBorderBrush}"
                                      RowHeight="32"
                                      FontSize="11"
                                      MaxHeight="200">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="구분" Binding="{Binding Category}" Width="60"/>
                                    <DataGridTextColumn Header="면적" Binding="{Binding Area}" Width="60"/>
                                    <DataGridTextColumn Header="임차인" Binding="{Binding TenantName}" Width="100"/>
                                    <DataGridTextColumn Header="임차개시일" Binding="{Binding LeaseStartDate, StringFormat=yyyy-MM-dd}" Width="90"/>
                                    <DataGridTextColumn Header="임차종료일" Binding="{Binding LeaseEndDate, StringFormat=yyyy-MM-dd}" Width="90"/>
                                    <DataGridTextColumn Header="전입일" Binding="{Binding MoveInDate, StringFormat=yyyy-MM-dd}" Width="90"/>
                                    <DataGridTextColumn Header="보증금" Binding="{Binding Deposit, StringFormat=N0}" Width="100"/>
                                    <DataGridTextColumn Header="월세" Binding="{Binding MonthlyRent, StringFormat=N0}" Width="80"/>
                                    <DataGridTextColumn Header="소액보증금" Binding="{Binding SmallDeposit, StringFormat=N0}" Width="100"/>
                                    <DataGridTextColumn Header="선순위 보증금" Binding="{Binding SeniorDeposit, StringFormat=N0}" Width="100"/>
                                </DataGrid.Columns>
                            </DataGrid>
                            
                            <Border Background="#F5F5F5" Padding="8,4">
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                    <TextBlock Text="합계:" FontWeight="SemiBold" FontSize="11" Margin="0,0,8,0"/>
                                    <TextBlock Text="{Binding ResidentialLeasesTotalDeposit, StringFormat=N0}" FontWeight="Bold" FontSize="11"/>
                                    <TextBlock Text="원" FontSize="11" Margin="2,0,0,0"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </Border>

                    <!-- ========== 5. Tool Box: 상가임대차 테이블 ========== -->
                    <Border BorderBrush="{StaticResource TableBorderBrush}" BorderThickness="1" Margin="0,0,0,16">
                        <StackPanel>
                            <Border Background="#FFF3E0" Padding="8,4">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="Tool Box > 상가임대차" FontWeight="SemiBold" FontSize="12"/>
                                    <Button Content="+ 행 추가" Command="{Binding AddCommercialLeaseRowCommand}" Style="{StaticResource LinkButtonStyle}" Margin="16,0,0,0"/>
                                </StackPanel>
                            </Border>
                            
                            <DataGrid ItemsSource="{Binding CommercialLeases}" 
                                      AutoGenerateColumns="False" 
                                      CanUserAddRows="False"
                                      Background="Transparent"
                                      BorderThickness="0"
                                      GridLinesVisibility="All"
                                      HorizontalGridLinesBrush="{StaticResource TableBorderBrush}"
                                      VerticalGridLinesBrush="{StaticResource TableBorderBrush}"
                                      RowHeight="32"
                                      FontSize="11"
                                      MaxHeight="200">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="구분" Binding="{Binding Category}" Width="60"/>
                                    <DataGridTextColumn Header="면적" Binding="{Binding Area}" Width="60"/>
                                    <DataGridTextColumn Header="임차인" Binding="{Binding TenantName}" Width="100"/>
                                    <DataGridTextColumn Header="임차개시일" Binding="{Binding LeaseStartDate, StringFormat=yyyy-MM-dd}" Width="90"/>
                                    <DataGridTextColumn Header="임차종료일" Binding="{Binding LeaseEndDate, StringFormat=yyyy-MM-dd}" Width="90"/>
                                    <DataGridTextColumn Header="확정신고일" Binding="{Binding ConfirmationDate, StringFormat=yyyy-MM-dd}" Width="90"/>
                                    <DataGridTextColumn Header="보증금" Binding="{Binding Deposit, StringFormat=N0}" Width="100"/>
                                    <DataGridTextColumn Header="월세" Binding="{Binding MonthlyRent, StringFormat=N0}" Width="80"/>
                                    <DataGridTextColumn Header="소액보증금" Binding="{Binding SmallDeposit, StringFormat=N0}" Width="100"/>
                                    <DataGridTextColumn Header="선순위 보증금" Binding="{Binding SeniorDeposit, StringFormat=N0}" Width="100"/>
                                </DataGrid.Columns>
                            </DataGrid>
                            
                            <Border Background="#F5F5F5" Padding="8,4">
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                    <TextBlock Text="합계:" FontWeight="SemiBold" FontSize="11" Margin="0,0,8,0"/>
                                    <TextBlock Text="{Binding CommercialLeasesTotalDeposit, StringFormat=N0}" FontWeight="Bold" FontSize="11"/>
                                    <TextBlock Text="원" FontSize="11" Margin="2,0,0,0"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </Border>

                    <!-- ========== 6. Tool Box: 임금채권 테이블 ========== -->
                    <Border BorderBrush="{StaticResource TableBorderBrush}" BorderThickness="1" Margin="0,0,0,16">
                        <StackPanel>
                            <Border Background="#FCE4EC" Padding="8,4">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="Tool Box > 임금채권" FontWeight="SemiBold" FontSize="12"/>
                                    <Button Content="+ 행 추가" Command="{Binding AddWageClaimRowCommand}" Style="{StaticResource LinkButtonStyle}" Margin="16,0,0,0"/>
                                </StackPanel>
                            </Border>
                            
                            <DataGrid ItemsSource="{Binding WageClaims}" 
                                      AutoGenerateColumns="False" 
                                      CanUserAddRows="False"
                                      Background="Transparent"
                                      BorderThickness="0"
                                      GridLinesVisibility="All"
                                      HorizontalGridLinesBrush="{StaticResource TableBorderBrush}"
                                      VerticalGridLinesBrush="{StaticResource TableBorderBrush}"
                                      RowHeight="32"
                                      FontSize="11"
                                      MaxHeight="200">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="순번" Binding="{Binding SequenceNumber}" Width="50"/>
                                    <DataGridTextColumn Header="성명" Binding="{Binding EmployeeName}" Width="80"/>
                                    <DataGridTextColumn Header="생년월일" Binding="{Binding BirthDate, StringFormat=yyMMdd}" Width="70"/>
                                    <DataGridTextColumn Header="가압류일자" Binding="{Binding SeizureDate, StringFormat=yyyy-MM-dd}" Width="90"/>
                                    <DataGridTextColumn Header="가압류금액" Binding="{Binding SeizureAmount, StringFormat=N0}" Width="100"/>
                                    <DataGridTextColumn Header="배당요구일자" Binding="{Binding ClaimDate, StringFormat=yyyy-MM-dd}" Width="90"/>
                                    <DataGridTextColumn Header="임금" Binding="{Binding WageAmount, StringFormat=N0}" Width="90"/>
                                    <DataGridTextColumn Header="퇴직금" Binding="{Binding SeveranceAmount, StringFormat=N0}" Width="90"/>
                                    <DataGridTextColumn Header="기타" Binding="{Binding OtherAmount, StringFormat=N0}" Width="70"/>
                                    <DataGridTextColumn Header="합계" Binding="{Binding TotalAmount, StringFormat=N0}" Width="100"/>
                                    <DataGridTextColumn Header="3개월 임금" Binding="{Binding ThreeMonthWage, StringFormat=N0}" Width="100"/>
                                    <DataGridTextColumn Header="3년분 퇴직금" Binding="{Binding ThreeYearSeverance, StringFormat=N0}" Width="100"/>
                                    <DataGridTextColumn Header="체당금지급액" Binding="{Binding SubstitutePayment, StringFormat=N0}" Width="100"/>
                                    <DataGridTextColumn Header="반영금액" Binding="{Binding ReflectedAmount, StringFormat=N0}" Width="100"/>
                                    <DataGridTextColumn Header="비고" Binding="{Binding Notes}" Width="150"/>
                                </DataGrid.Columns>
                            </DataGrid>
                            
                            <Border Background="#F5F5F5" Padding="8,4">
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                    <TextBlock Text="합계:" FontWeight="SemiBold" FontSize="11" Margin="0,0,8,0"/>
                                    <TextBlock Text="{Binding WageClaimsTotalAmount, StringFormat=N0}" FontWeight="Bold" FontSize="11"/>
                                    <TextBlock Text="원" FontSize="11" Margin="2,0,0,0"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </Border>

                    <!-- ========== 7. 선순위 구분 테이블 ========== -->
                    <Border BorderBrush="{StaticResource TableBorderBrush}" BorderThickness="1" Margin="0,0,0,16">
                        <StackPanel>
                            <TextBlock Text="선순위 구분" Style="{StaticResource SectionHeaderStyle}" Margin="8,8,8,4"/>
                            
                            <Grid Margin="8">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="150"/>
                                    <ColumnDefinition Width="120"/>
                                    <ColumnDefinition Width="120"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                
                                <!-- 헤더 -->
                                <Border Grid.Row="0" Grid.Column="0" Style="{StaticResource TableHeaderCellStyle}">
                                    <TextBlock Text="선순위 구분" Style="{StaticResource LabelStyle}" FontWeight="SemiBold"/>
                                </Border>
                                <Border Grid.Row="0" Grid.Column="1" Style="{StaticResource TableHeaderCellStyle}">
                                    <TextBlock Text="DD" Style="{StaticResource LabelStyle}" FontWeight="SemiBold" HorizontalAlignment="Center"/>
                                </Border>
                                <Border Grid.Row="0" Grid.Column="2" Style="{StaticResource TableHeaderCellStyle}">
                                    <TextBlock Text="평가자 반영 금액" Style="{StaticResource LabelStyle}" FontWeight="SemiBold" HorizontalAlignment="Center"/>
                                </Border>
                                <Border Grid.Row="0" Grid.Column="3" Style="{StaticResource TableHeaderCellStyle}">
                                    <TextBlock Text="상세추정 근거" Style="{StaticResource LabelStyle}" FontWeight="SemiBold"/>
                                </Border>
                                
                                <!-- 선순위근저당권 -->
                                <Border Grid.Row="1" Grid.Column="0" Style="{StaticResource TableHeaderCellStyle}">
                                    <TextBlock Text="선순위근저당권" Style="{StaticResource LabelStyle}"/>
                                </Border>
                                <Border Grid.Row="1" Grid.Column="1" Style="{StaticResource TableCellStyle}">
                                    <TextBox Text="{Binding SeniorMortgageDd, StringFormat=N0, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource InputTextBoxStyle}" HorizontalContentAlignment="Right"/>
                                </Border>
                                <Border Grid.Row="1" Grid.Column="2" Style="{StaticResource TableCellStyle}">
                                    <TextBox Text="{Binding SeniorMortgageReflected, StringFormat=N0, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource InputTextBoxStyle}" HorizontalContentAlignment="Right"/>
                                </Border>
                                <Border Grid.Row="1" Grid.Column="3" Style="{StaticResource TableCellStyle}">
                                    <TextBox Text="{Binding SeniorMortgageReason, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource InputTextBoxStyle}"/>
                                </Border>
                                
                                <!-- 유치권 신고금액 -->
                                <Border Grid.Row="2" Grid.Column="0" Style="{StaticResource TableHeaderCellStyle}">
                                    <TextBlock Text="유치권 신고금액" Style="{StaticResource LabelStyle}"/>
                                </Border>
                                <Border Grid.Row="2" Grid.Column="1" Style="{StaticResource TableCellStyle}">
                                    <TextBox Text="{Binding LienDd, StringFormat=N0, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource InputTextBoxStyle}" HorizontalContentAlignment="Right"/>
                                </Border>
                                <Border Grid.Row="2" Grid.Column="2" Style="{StaticResource TableCellStyle}">
                                    <TextBox Text="{Binding LienReflected, StringFormat=N0, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource InputTextBoxStyle}" HorizontalContentAlignment="Right"/>
                                </Border>
                                <Border Grid.Row="2" Grid.Column="3" Style="{StaticResource TableCellStyle}">
                                    <TextBox Text="{Binding LienReason, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource InputTextBoxStyle}"/>
                                </Border>
                                
                                <!-- 선순위소액보증금 -->
                                <Border Grid.Row="3" Grid.Column="0" Style="{StaticResource TableHeaderCellStyle}">
                                    <TextBlock Text="선순위소액보증금" Style="{StaticResource LabelStyle}"/>
                                </Border>
                                <Border Grid.Row="3" Grid.Column="1" Style="{StaticResource TableCellStyle}">
                                    <TextBox Text="{Binding SmallDepositDd, StringFormat=N0, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource InputTextBoxStyle}" HorizontalContentAlignment="Right"/>
                                </Border>
                                <Border Grid.Row="3" Grid.Column="2" Style="{StaticResource TableCellStyle}">
                                    <TextBox Text="{Binding SmallDepositReflected, StringFormat=N0, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource InputTextBoxStyle}" HorizontalContentAlignment="Right"/>
                                </Border>
                                <Border Grid.Row="3" Grid.Column="3" Style="{StaticResource TableCellStyle}">
                                    <TextBox Text="{Binding SmallDepositReason, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource InputTextBoxStyle}"/>
                                </Border>
                                
                                <!-- 선순위임차보증금 -->
                                <Border Grid.Row="4" Grid.Column="0" Style="{StaticResource TableHeaderCellStyle}">
                                    <TextBlock Text="선순위임차보증금" Style="{StaticResource LabelStyle}"/>
                                </Border>
                                <Border Grid.Row="4" Grid.Column="1" Style="{StaticResource TableCellStyle}">
                                    <TextBox Text="{Binding LeaseDepositDd, StringFormat=N0, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource InputTextBoxStyle}" HorizontalContentAlignment="Right"/>
                                </Border>
                                <Border Grid.Row="4" Grid.Column="2" Style="{StaticResource TableCellStyle}">
                                    <TextBox Text="{Binding LeaseDepositReflected, StringFormat=N0, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource InputTextBoxStyle}" HorizontalContentAlignment="Right"/>
                                </Border>
                                <Border Grid.Row="4" Grid.Column="3" Style="{StaticResource TableCellStyle}">
                                    <TextBox Text="{Binding LeaseDepositReason, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource InputTextBoxStyle}"/>
                                </Border>
                                
                                <!-- 선순위 임금채권 -->
                                <Border Grid.Row="5" Grid.Column="0" Style="{StaticResource TableHeaderCellStyle}">
                                    <TextBlock Text="선순위 임금채권" Style="{StaticResource LabelStyle}"/>
                                </Border>
                                <Border Grid.Row="5" Grid.Column="1" Style="{StaticResource TableCellStyle}">
                                    <TextBox Text="{Binding WageClaimDd, StringFormat=N0, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource InputTextBoxStyle}" HorizontalContentAlignment="Right"/>
                                </Border>
                                <Border Grid.Row="5" Grid.Column="2" Style="{StaticResource TableCellStyle}">
                                    <TextBox Text="{Binding WageClaimReflected, StringFormat=N0, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource InputTextBoxStyle}" HorizontalContentAlignment="Right"/>
                                </Border>
                                <Border Grid.Row="5" Grid.Column="3" Style="{StaticResource TableCellStyle}">
                                    <TextBox Text="{Binding WageClaimReason, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource InputTextBoxStyle}"/>
                                </Border>
                                
                                <!-- 당해세 -->
                                <Border Grid.Row="6" Grid.Column="0" Style="{StaticResource TableHeaderCellStyle}">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="당해세" Style="{StaticResource LabelStyle}"/>
                                        <Button Content="조회" Command="{Binding OpenEtaxCommand}" Style="{StaticResource LinkButtonStyle}" Margin="4,0,0,0"/>
                                    </StackPanel>
                                </Border>
                                <Border Grid.Row="6" Grid.Column="1" Style="{StaticResource TableCellStyle}">
                                    <TextBox Text="{Binding CurrentTaxDd, StringFormat=N0, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource InputTextBoxStyle}" HorizontalContentAlignment="Right"/>
                                </Border>
                                <Border Grid.Row="6" Grid.Column="2" Style="{StaticResource TableCellStyle}">
                                    <TextBox Text="{Binding CurrentTax, StringFormat=N0, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource InputTextBoxStyle}" HorizontalContentAlignment="Right"/>
                                </Border>
                                <Border Grid.Row="6" Grid.Column="3" Style="{StaticResource TableCellStyle}">
                                    <TextBox Text="{Binding CurrentTaxReason, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource InputTextBoxStyle}"/>
                                </Border>
                                
                                <!-- 선순위 조세채권 -->
                                <Border Grid.Row="7" Grid.Column="0" Style="{StaticResource TableHeaderCellStyle}">
                                    <TextBlock Text="선순위 조세채권" Style="{StaticResource LabelStyle}"/>
                                </Border>
                                <Border Grid.Row="7" Grid.Column="1" Style="{StaticResource TableCellStyle}">
                                    <TextBox Text="{Binding SeniorTaxClaimDd, StringFormat=N0, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource InputTextBoxStyle}" HorizontalContentAlignment="Right"/>
                                </Border>
                                <Border Grid.Row="7" Grid.Column="2" Style="{StaticResource TableCellStyle}">
                                    <TextBox Text="{Binding SeniorTaxClaimReflected, StringFormat=N0, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource InputTextBoxStyle}" HorizontalContentAlignment="Right"/>
                                </Border>
                                <Border Grid.Row="7" Grid.Column="3" Style="{StaticResource TableCellStyle}">
                                    <TextBox Text="{Binding SeniorTaxClaimReason, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource InputTextBoxStyle}"/>
                                </Border>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- ========== 8. 선순위 요약 + 배당 시뮬레이션 (하단 - 피드백 #27, #31) ========== -->
                    <Border BorderBrush="{StaticResource TableBorderBrush}" BorderThickness="1" Background="#F5F5F5">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <!-- 선순위 요약 -->
                            <Border Grid.Column="0" BorderBrush="{StaticResource TableBorderBrush}" BorderThickness="0,0,1,0" Padding="16">
                                <StackPanel>
                                    <TextBlock Text="선순위 요약" Style="{StaticResource SectionHeaderStyle}"/>
                                    
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="150"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        
                                        <Border Grid.Row="0" Grid.Column="0" Style="{StaticResource TableHeaderCellStyle}">
                                            <TextBlock Text="선임차보증금" Style="{StaticResource LabelStyle}"/>
                                        </Border>
                                        <Border Grid.Row="0" Grid.Column="1" Style="{StaticResource TableCellStyle}">
                                            <TextBlock Text="{Binding TotalLeaseDeposit, StringFormat=N0}" Style="{StaticResource AmountStyle}"/>
                                        </Border>
                                        
                                        <Border Grid.Row="1" Grid.Column="0" Style="{StaticResource TableHeaderCellStyle}">
                                            <TextBlock Text="당해세" Style="{StaticResource LabelStyle}"/>
                                        </Border>
                                        <Border Grid.Row="1" Grid.Column="1" Style="{StaticResource TableCellStyle}">
                                            <TextBlock Text="{Binding CurrentTax, StringFormat=N0}" Style="{StaticResource AmountStyle}"/>
                                        </Border>
                                        
                                        <Border Grid.Row="2" Grid.Column="0" Style="{StaticResource TableHeaderCellStyle}">
                                            <TextBlock Text="기타 선순위" Style="{StaticResource LabelStyle}"/>
                                        </Border>
                                        <Border Grid.Row="2" Grid.Column="1" Style="{StaticResource TableCellStyle}">
                                            <TextBlock Text="{Binding OtherSeniorRights, StringFormat=N0}" Style="{StaticResource AmountStyle}"/>
                                        </Border>
                                        
                                        <Border Grid.Row="3" Grid.Column="0" Style="{StaticResource TableHeaderCellStyle}" Background="#E3F2FD">
                                            <TextBlock Text="선순위 합계" Style="{StaticResource LabelStyle}" FontWeight="Bold"/>
                                        </Border>
                                        <Border Grid.Row="3" Grid.Column="1" Style="{StaticResource TableCellStyle}" Background="#E3F2FD">
                                            <TextBlock Text="{Binding SeniorRightsTotal, StringFormat=N0}" Style="{StaticResource AmountStyle}" FontWeight="Bold" Foreground="{StaticResource PrimaryBrush}"/>
                                        </Border>
                                    </Grid>
                                </StackPanel>
                            </Border>
                            
                            <!-- 배당 시뮬레이션 -->
                            <Border Grid.Column="1" Padding="16">
                                <StackPanel>
                                    <TextBlock Text="배당 시뮬레이션" Style="{StaticResource SectionHeaderStyle}"/>
                                    
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="150"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        
                                        <Border Grid.Row="0" Grid.Column="0" Style="{StaticResource TableHeaderCellStyle}">
                                            <TextBlock Text="예상 낙찰가" Style="{StaticResource LabelStyle}"/>
                                        </Border>
                                        <Border Grid.Row="0" Grid.Column="1" Style="{StaticResource TableCellStyle}">
                                            <TextBox Text="{Binding ExpectedBidPrice, StringFormat=N0, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource InputTextBoxStyle}" HorizontalContentAlignment="Right"/>
                                        </Border>
                                        
                                        <Border Grid.Row="1" Grid.Column="0" Style="{StaticResource TableHeaderCellStyle}">
                                            <TextBlock Text="경매비용" Style="{StaticResource LabelStyle}"/>
                                        </Border>
                                        <Border Grid.Row="1" Grid.Column="1" Style="{StaticResource TableCellStyle}">
                                            <TextBox Text="{Binding AuctionCost, StringFormat=N0, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource InputTextBoxStyle}" HorizontalContentAlignment="Right"/>
                                        </Border>
                                        
                                        <Border Grid.Row="2" Grid.Column="0" Style="{StaticResource TableHeaderCellStyle}">
                                            <TextBlock Text="배당가능 재원" Style="{StaticResource LabelStyle}"/>
                                        </Border>
                                        <Border Grid.Row="2" Grid.Column="1" Style="{StaticResource TableCellStyle}">
                                            <TextBlock Text="{Binding DistributableAmount, StringFormat=N0}" Style="{StaticResource AmountStyle}"/>
                                        </Border>
                                        
                                        <Border Grid.Row="3" Grid.Column="0" Style="{StaticResource TableHeaderCellStyle}">
                                            <TextBlock Text="선순위 차감 후" Style="{StaticResource LabelStyle}"/>
                                        </Border>
                                        <Border Grid.Row="3" Grid.Column="1" Style="{StaticResource TableCellStyle}">
                                            <TextBlock Text="{Binding RemainingAmount, StringFormat=N0}" Style="{StaticResource AmountStyle}"/>
                                        </Border>
                                        
                                        <Border Grid.Row="4" Grid.Column="0" Style="{StaticResource TableHeaderCellStyle}" Background="#E8F5E9">
                                            <TextBlock Text="예상 회수율" Style="{StaticResource LabelStyle}" FontWeight="Bold"/>
                                        </Border>
                                        <Border Grid.Row="4" Grid.Column="1" Style="{StaticResource TableCellStyle}" Background="#E8F5E9">
                                            <TextBlock Style="{StaticResource AmountStyle}" FontWeight="Bold">
                                                <Run Text="{Binding RecoveryRate, StringFormat=N1}"/>
                                                <Run Text="%"/>
                                            </TextBlock>
                                        </Border>
                                    </Grid>
                                </StackPanel>
                            </Border>
                        </Grid>
                    </Border>

                    <!-- 저장 버튼 -->
                    <Border Background="#F5F5F5" Padding="12" CornerRadius="4" Margin="0,16,0,0">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            
                            <StackPanel Grid.Column="1" Orientation="Horizontal">
                                <Button Content="저장" 
                                        Command="{Binding SaveRightAnalysisCommand}"
                                        Style="{StaticResource PrimaryButton}"
                                        Padding="24,8"
                                        FontSize="12"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                </StackPanel>
            </ScrollViewer>
        </Border>

        <!-- 로딩 오버레이 -->
        <Border Grid.RowSpan="2" Background="#80000000" CornerRadius="8"
                Visibility="{Binding IsLoading, Converter={StaticResource BooleanToVisibilityConverter}}">
            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                <ProgressBar IsIndeterminate="True" Width="200"/>
                <TextBlock Text="로딩 중..." Foreground="White" Margin="0,16,0,0"/>
            </StackPanel>
        </Border>

        <!-- 에러 메시지 -->
        <Border Grid.Row="1" Background="#E57373" CornerRadius="8" Padding="16" Margin="0,16,0,0"
                VerticalAlignment="Bottom"
                Visibility="{Binding ErrorMessage, Converter={StaticResource NullToVisibilityConverter}}">
            <TextBlock Text="{Binding ErrorMessage}" Foreground="White" TextWrapping="Wrap"/>
        </Border>
    </Grid>
</UserControl>
