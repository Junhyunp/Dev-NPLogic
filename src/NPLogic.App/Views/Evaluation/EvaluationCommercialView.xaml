<UserControl x:Class="NPLogic.Views.Evaluation.EvaluationCommercialView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             mc:Ignorable="d" 
             d:DesignHeight="900" d:DesignWidth="1400">

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="16"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- ì¢Œì¸¡: ìƒê°€êµ¬ë¶„ + ìž„ëŒ€ë™í–¥ + ì¸µë³„íš¨ìš©ë¹„ìœ¨ -->
        <ScrollViewer Grid.Column="0" VerticalScrollBarVisibility="Auto">
            <StackPanel>
                <!-- ìƒê°€êµ¬ë¶„ ì„ íƒ -->
                <Border Style="{StaticResource CardBorder}" Padding="16" Margin="0,0,0,16">
                    <StackPanel>
                        <TextBlock Text="ðŸ¢ ìƒê°€êµ¬ë¶„" Style="{StaticResource SectionHeader}" Margin="0,0,0,12"/>
                        <StackPanel Orientation="Horizontal">
                            <RadioButton Content="ì˜¤í”¼ìŠ¤" 
                                         IsChecked="{Binding IsOffice}"
                                         GroupName="CommercialType"
                                         Margin="0,0,16,0"/>
                            <RadioButton Content="ì¤‘ëŒ€í˜•ìƒê°€" 
                                         IsChecked="{Binding IsMediumLargeCommercial}"
                                         GroupName="CommercialType"
                                         Margin="0,0,16,0"/>
                            <RadioButton Content="ì†Œê·œëª¨ìƒê°€" 
                                         IsChecked="{Binding IsSmallCommercial}"
                                         GroupName="CommercialType"
                                         Margin="0,0,16,0"/>
                            <RadioButton Content="ì§‘í•©ìƒê°€" 
                                         IsChecked="{Binding IsCollectiveCommercial}"
                                         GroupName="CommercialType"
                                         Margin="0,0,16,0"/>
                            <RadioButton Content="í•´ë‹¹ì—†ìŒ" 
                                         IsChecked="{Binding IsNotApplicable}"
                                         GroupName="CommercialType"/>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- ìƒê¶Œì§€ë„ -->
                <Border Style="{StaticResource CardBorder}" Padding="16" Margin="0,0,0,16">
                    <StackPanel>
                        <Grid Margin="0,0,0,12">
                            <TextBlock Text="ðŸ—ºï¸ ìƒê¶Œì§€ë„" Style="{StaticResource SectionHeader}" Margin="0"/>
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                <Button Content="R-ONE ì—°ë™" 
                                        Command="{Binding OpenROneMapCommand}"
                                        Style="{StaticResource SecondaryButton}"
                                        Padding="12,4"
                                        Margin="0,0,8,0"/>
                                <Button Content="ê°€ì ¸ì˜¤ê¸°" 
                                        Command="{Binding LoadCommercialDistrictMapCommand}"
                                        Style="{StaticResource SecondaryButton}"
                                        Padding="12,4"/>
                            </StackPanel>
                        </Grid>
                        
                        <Border Background="{StaticResource BlueGray50Brush}" 
                                CornerRadius="4"
                                Height="180"
                                Cursor="Hand">
                            <TextBlock Text="í•œêµ­ë¶€ë™ì‚°ì› ìƒê¶Œì •ë³´ í‘œì‹œ"
                                       Style="{StaticResource BodyTextStyle}"
                                       Opacity="0.6"
                                       HorizontalAlignment="Center"
                                       VerticalAlignment="Center"/>
                        </Border>
                    </StackPanel>
                </Border>

                <!-- ìž„ëŒ€ë™í–¥ -->
                <Border Style="{StaticResource CardBorder}" Padding="16" Margin="0,0,0,16">
                    <StackPanel>
                        <Grid Margin="0,0,0,12">
                            <TextBlock Text="ðŸ“Š ìž„ëŒ€ë™í–¥" Style="{StaticResource SectionHeader}" Margin="0"/>
                            <Button Content="ì¡°íšŒ" 
                                    Command="{Binding FetchRentalTrendCommand}"
                                    Style="{StaticResource SecondaryButton}"
                                    Padding="12,4"
                                    HorizontalAlignment="Right"/>
                        </Grid>

                        <!-- ìž„ëŒ€ìˆ˜ìµë¥  -->
                        <TextBlock Text="ìž„ëŒ€ìˆ˜ìµë¥ " Style="{StaticResource LabelText}" FontWeight="Bold" Margin="0,0,0,8"/>
                        <Grid Margin="0,0,0,16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <Border Grid.Column="0" Background="{StaticResource BlueGray50Brush}" CornerRadius="4" Padding="12" Margin="0,0,8,0">
                                <StackPanel>
                                    <TextBlock Text="ì†Œë“ìˆ˜ìµë¥ " Style="{StaticResource LabelText}" FontSize="11"/>
                                    <TextBlock Text="{Binding IncomeYieldRate, StringFormat={}{0:P2}}" 
                                               Style="{StaticResource ValueText}" FontWeight="Bold"/>
                                </StackPanel>
                            </Border>
                            <Border Grid.Column="1" Background="{StaticResource BlueGray50Brush}" CornerRadius="4" Padding="12" Margin="0,0,8,0">
                                <StackPanel>
                                    <TextBlock Text="ìžë³¸ìˆ˜ìµë¥ " Style="{StaticResource LabelText}" FontSize="11"/>
                                    <TextBlock Text="{Binding CapitalYieldRate, StringFormat={}{0:P2}}" 
                                               Style="{StaticResource ValueText}" FontWeight="Bold"/>
                                </StackPanel>
                            </Border>
                            <Border Grid.Column="2" Background="{StaticResource BlueGray50Brush}" CornerRadius="4" Padding="12">
                                <StackPanel>
                                    <TextBlock Text="íˆ¬ìžìˆ˜ìµë¥ " Style="{StaticResource LabelText}" FontSize="11"/>
                                    <TextBlock Text="{Binding InvestmentYieldRate, StringFormat={}{0:P2}}" 
                                               Style="{StaticResource ValueText}" FontWeight="Bold" Foreground="{StaticResource PrimaryBrush}"/>
                                </StackPanel>
                            </Border>
                        </Grid>

                        <!-- ë¶„ê¸°ë³„ ë™í–¥ í…Œì´ë¸” -->
                        <TextBlock Text="ë¶„ê¸°ë³„ ìž„ëŒ€ë™í–¥" Style="{StaticResource LabelText}" FontWeight="Bold" Margin="0,0,0,8"/>
                        <DataGrid ItemsSource="{Binding QuarterlyRentalTrends}"
                                  AutoGenerateColumns="False"
                                  CanUserAddRows="False"
                                  CanUserDeleteRows="False"
                                  HeadersVisibility="Column"
                                  GridLinesVisibility="All"
                                  BorderThickness="1"
                                  BorderBrush="{StaticResource BlueGray200Brush}"
                                  MaxHeight="150"
                                  FontSize="11">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="ë¶„ê¸°" Binding="{Binding Quarter}" Width="80" IsReadOnly="True"/>
                                <DataGridTextColumn Header="ìž„ëŒ€ê°€ê²©ì§€ìˆ˜" Binding="{Binding RentalPriceIndex, StringFormat=N2}" Width="100" IsReadOnly="True"/>
                                <DataGridTextColumn Header="ê³µì‹¤ë¥ " Binding="{Binding VacancyRate, StringFormat=P2}" Width="80" IsReadOnly="True"/>
                                <DataGridTextColumn Header="ìž„ëŒ€ë£Œ(ì²œì›/ãŽ¡)" Binding="{Binding RentalPrice, StringFormat=N1}" Width="*" IsReadOnly="True"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </StackPanel>
                </Border>

                <!-- ì¸µë³„íš¨ìš©ë¹„ìœ¨ -->
                <Border Style="{StaticResource CardBorder}" Padding="16" Margin="0,0,0,16">
                    <StackPanel>
                        <TextBlock Text="ðŸ“ˆ ì¸µë³„íš¨ìš©ë¹„ìœ¨" Style="{StaticResource SectionHeader}" Margin="0,0,0,12"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <!-- í–‰ 1 -->
                            <Border Grid.Row="0" Grid.Column="0" Background="{StaticResource BlueGray100Brush}" Padding="8,6" Margin="0,0,1,1">
                                <TextBlock Text="ì§€í•˜1ì¸µ" Style="{StaticResource LabelText}" HorizontalAlignment="Center"/>
                            </Border>
                            <Border Grid.Row="0" Grid.Column="1" Background="{StaticResource BlueGray100Brush}" Padding="8,6" Margin="0,0,1,1">
                                <TextBlock Text="1ì¸µ" Style="{StaticResource LabelText}" HorizontalAlignment="Center"/>
                            </Border>
                            <Border Grid.Row="0" Grid.Column="2" Background="{StaticResource BlueGray100Brush}" Padding="8,6" Margin="0,0,1,1">
                                <TextBlock Text="2ì¸µ" Style="{StaticResource LabelText}" HorizontalAlignment="Center"/>
                            </Border>
                            <Border Grid.Row="0" Grid.Column="3" Background="{StaticResource BlueGray100Brush}" Padding="8,6" Margin="0,0,0,1">
                                <TextBlock Text="3ì¸µ" Style="{StaticResource LabelText}" HorizontalAlignment="Center"/>
                            </Border>

                            <Border Grid.Row="1" Grid.Column="0" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="1,0,1,1" Padding="8,6">
                                <TextBlock Text="{Binding FloorEfficiencyB1, StringFormat={}{0:P0}}" Style="{StaticResource ValueText}" HorizontalAlignment="Center"/>
                            </Border>
                            <Border Grid.Row="1" Grid.Column="1" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="0,0,1,1" Padding="8,6">
                                <TextBlock Text="{Binding FloorEfficiency1, StringFormat={}{0:P0}}" Style="{StaticResource ValueText}" HorizontalAlignment="Center" FontWeight="Bold" Foreground="{StaticResource PrimaryBrush}"/>
                            </Border>
                            <Border Grid.Row="1" Grid.Column="2" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="0,0,1,1" Padding="8,6">
                                <TextBlock Text="{Binding FloorEfficiency2, StringFormat={}{0:P0}}" Style="{StaticResource ValueText}" HorizontalAlignment="Center"/>
                            </Border>
                            <Border Grid.Row="1" Grid.Column="3" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="0,0,1,1" Padding="8,6">
                                <TextBlock Text="{Binding FloorEfficiency3, StringFormat={}{0:P0}}" Style="{StaticResource ValueText}" HorizontalAlignment="Center"/>
                            </Border>

                            <!-- í–‰ 2: 4ì¸µ~7ì¸µ -->
                            <Border Grid.Row="2" Grid.Column="0" Background="{StaticResource BlueGray100Brush}" Padding="8,6" Margin="0,8,1,1">
                                <TextBlock Text="4ì¸µ" Style="{StaticResource LabelText}" HorizontalAlignment="Center"/>
                            </Border>
                            <Border Grid.Row="2" Grid.Column="1" Background="{StaticResource BlueGray100Brush}" Padding="8,6" Margin="0,8,1,1">
                                <TextBlock Text="5ì¸µ~7ì¸µ" Style="{StaticResource LabelText}" HorizontalAlignment="Center"/>
                            </Border>
                            <Border Grid.Row="2" Grid.Column="2" Background="{StaticResource BlueGray100Brush}" Padding="8,6" Margin="0,8,1,1">
                                <TextBlock Text="8ì¸µ~10ì¸µ" Style="{StaticResource LabelText}" HorizontalAlignment="Center"/>
                            </Border>
                            <Border Grid.Row="2" Grid.Column="3" Background="{StaticResource BlueGray100Brush}" Padding="8,6" Margin="0,8,0,1">
                                <TextBlock Text="11ì¸µì´ìƒ" Style="{StaticResource LabelText}" HorizontalAlignment="Center"/>
                            </Border>
                        </Grid>
                        <Grid Margin="0,1,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <Border Grid.Column="0" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="1,0,1,1" Padding="8,6">
                                <TextBlock Text="{Binding FloorEfficiency4, StringFormat={}{0:P0}}" Style="{StaticResource ValueText}" HorizontalAlignment="Center"/>
                            </Border>
                            <Border Grid.Column="1" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="0,0,1,1" Padding="8,6">
                                <TextBlock Text="{Binding FloorEfficiency5to7, StringFormat={}{0:P0}}" Style="{StaticResource ValueText}" HorizontalAlignment="Center"/>
                            </Border>
                            <Border Grid.Column="2" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="0,0,1,1" Padding="8,6">
                                <TextBlock Text="{Binding FloorEfficiency8to10, StringFormat={}{0:P0}}" Style="{StaticResource ValueText}" HorizontalAlignment="Center"/>
                            </Border>
                            <Border Grid.Column="3" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="0,0,1,1" Padding="8,6">
                                <TextBlock Text="{Binding FloorEfficiency11plus, StringFormat={}{0:P0}}" Style="{StaticResource ValueText}" HorizontalAlignment="Center"/>
                            </Border>
                        </Grid>
                    </StackPanel>
                </Border>

                <!-- Tool Box: ìž„ëŒ€í˜¸ê°€ë¶„ì„ -->
                <Border Style="{StaticResource CardBorder}" Padding="16" Margin="0,0,0,16">
                    <StackPanel>
                        <TextBlock Text="ðŸ“ ìž„ëŒ€í˜¸ê°€ë¶„ì„" Style="{StaticResource SectionHeader}" Margin="0,0,0,12"/>
                        <DataGrid ItemsSource="{Binding RentalQuotes}"
                                  AutoGenerateColumns="False"
                                  CanUserAddRows="False"
                                  CanUserDeleteRows="False"
                                  HeadersVisibility="Column"
                                  GridLinesVisibility="All"
                                  BorderThickness="1"
                                  BorderBrush="{StaticResource BlueGray200Brush}"
                                  MaxHeight="180"
                                  FontSize="11">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="í˜¸ê°€" Binding="{Binding QuoteNumber}" Width="50" IsReadOnly="True"/>
                                <DataGridTextColumn Header="ë¶„ì–‘(í‰)" Binding="{Binding SupplyAreaPyeong, StringFormat=N2}" Width="70"/>
                                <DataGridTextColumn Header="ì „ìš©(í‰)" Binding="{Binding ExclusiveAreaPyeong, StringFormat=N2}" Width="70"/>
                                <DataGridTextColumn Header="ë³´ì¦ê¸ˆ" Binding="{Binding Deposit, StringFormat=N0}" Width="90"/>
                                <DataGridTextColumn Header="ì›”ìž„ëŒ€ë£Œ" Binding="{Binding MonthlyRent, StringFormat=N0}" Width="90"/>
                                <DataGridTextColumn Header="ì „ìš©í‰ë‹¹ìž„ëŒ€ë£Œ" Binding="{Binding UnitRent, StringFormat=N0}" Width="100"/>
                                <DataGridTextColumn Header="ì¸µìˆ˜" Binding="{Binding Floor}" Width="50"/>
                            </DataGrid.Columns>
                        </DataGrid>
                        
                        <Border Background="{StaticResource BlueGray50Brush}" CornerRadius="4" Padding="12" Margin="0,12,0,0">
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                <TextBlock Text="í‰ê·  ì „ìš©í‰ë‹¹ ìž„ëŒ€ë£Œ:" Style="{StaticResource LabelText}" VerticalAlignment="Center"/>
                                <TextBlock Text="{Binding AverageUnitRent, StringFormat=\{0:N0\}ì›}" 
                                           Style="{StaticResource ValueText}" FontWeight="Bold" Margin="8,0,0,0"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </Border>
            </StackPanel>
        </ScrollViewer>

        <!-- ìš°ì¸¡: ìˆ˜ìµê°€ì¹˜ + ë¬´ìƒìž„ëŒ€ + ë‚™ì°°í†µê³„ + ì„ ìˆœìœ„ê´€ë¦¬ë¹„ -->
        <ScrollViewer Grid.Column="2" VerticalScrollBarVisibility="Auto">
            <StackPanel>
                <!-- Tool Box: ìˆ˜ìµê°€ì¹˜ ë¶„ì„ -->
                <Border Style="{StaticResource CardBorder}" Padding="16" Margin="0,0,0,16">
                    <StackPanel>
                        <TextBlock Text="ðŸ’° ìˆ˜ìµê°€ì¹˜ ë¶„ì„" Style="{StaticResource SectionHeader}" Margin="0,0,0,12"/>
                        
                        <!-- ë¯¼ê°ë„ ë¶„ì„ -->
                        <TextBlock Text="ë¯¼ê°ë„ ë¶„ì„" Style="{StaticResource LabelText}" FontWeight="Bold" Margin="0,0,0,8"/>
                        <Grid Margin="0,0,0,16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="100"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0" Grid.Column="0" Text="ê¸°ë³¸í• ì¸ìœ¨" Style="{StaticResource LabelText}" Margin="0,0,0,8" VerticalAlignment="Center"/>
                            <TextBox Grid.Row="0" Grid.Column="1" 
                                     Text="{Binding BaseDiscountRate, StringFormat={}{0:P1}, UpdateSourceTrigger=PropertyChanged}" 
                                     Margin="0,0,0,8" Width="100" HorizontalAlignment="Left"/>
                            
                            <TextBlock Grid.Row="1" Grid.Column="0" Text="ë¯¼ê°ë„ ê¸°ì¤€" Style="{StaticResource LabelText}" VerticalAlignment="Center"/>
                            <TextBox Grid.Row="1" Grid.Column="1" 
                                     Text="{Binding SensitivityBasis, StringFormat={}{0:P2}, UpdateSourceTrigger=PropertyChanged}" 
                                     Width="100" HorizontalAlignment="Left"/>
                        </Grid>

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <Border Grid.Column="0" Background="{StaticResource BlueGray50Brush}" CornerRadius="4" Padding="12" Margin="0,0,8,0">
                                <StackPanel>
                                    <TextBlock Text="5.5%" Style="{StaticResource LabelText}" FontSize="11" HorizontalAlignment="Center"/>
                                    <TextBlock Text="{Binding IncomeValue55, StringFormat=\{0:N0\}}" 
                                               Style="{StaticResource ValueText}" FontWeight="Bold" HorizontalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                            <Border Grid.Column="1" Background="{StaticResource PrimaryBrush}" CornerRadius="4" Padding="12" Margin="0,0,8,0">
                                <StackPanel>
                                    <TextBlock Text="6.0%" Foreground="White" FontSize="11" HorizontalAlignment="Center"/>
                                    <TextBlock Text="{Binding IncomeValue60, StringFormat=\{0:N0\}}" 
                                               Foreground="White" FontWeight="Bold" HorizontalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                            <Border Grid.Column="2" Background="{StaticResource BlueGray50Brush}" CornerRadius="4" Padding="12">
                                <StackPanel>
                                    <TextBlock Text="6.5%" Style="{StaticResource LabelText}" FontSize="11" HorizontalAlignment="Center"/>
                                    <TextBlock Text="{Binding IncomeValue65, StringFormat=\{0:N0\}}" 
                                               Style="{StaticResource ValueText}" FontWeight="Bold" HorizontalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                        </Grid>

                        <Border Background="{StaticResource BlueGray50Brush}" CornerRadius="4" Padding="12" Margin="0,12,0,0">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="ìˆ˜ìµê°€ì¹˜" Style="{StaticResource LabelText}" FontSize="11"/>
                                    <TextBlock Text="{Binding IncomeValue, StringFormat=\{0:N0\}}" 
                                               Style="{StaticResource ValueText}" FontWeight="Bold"/>
                                </StackPanel>
                                <StackPanel Grid.Column="1">
                                    <TextBlock Text="í‰ë‹¹ê°€ì•¡" Style="{StaticResource LabelText}" FontSize="11"/>
                                    <TextBlock Text="{Binding UnitIncomeValue, StringFormat=\{0:N0\}}" 
                                               Style="{StaticResource ValueText}" FontWeight="Bold"/>
                                </StackPanel>
                            </Grid>
                        </Border>
                    </StackPanel>
                </Border>

                <!-- Tool Box: ë¬´ìƒìž„ëŒ€ë¶„ì„ -->
                <Border Style="{StaticResource CardBorder}" Padding="16" Margin="0,0,0,16">
                    <StackPanel>
                        <TextBlock Text="ðŸ†“ ë¬´ìƒìž„ëŒ€ë¶„ì„" Style="{StaticResource SectionHeader}" Margin="0,0,0,12"/>
                        
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <Border Grid.Row="0" Grid.Column="0" Background="{StaticResource BlueGray100Brush}" Padding="8,6" Margin="0,0,1,1">
                                <TextBlock Text="1ë…„ì°¨" Style="{StaticResource LabelText}" FontSize="11" HorizontalAlignment="Center"/>
                            </Border>
                            <Border Grid.Row="0" Grid.Column="1" Background="{StaticResource BlueGray100Brush}" Padding="8,6" Margin="0,0,1,1">
                                <TextBlock Text="2ë…„ì°¨" Style="{StaticResource LabelText}" FontSize="11" HorizontalAlignment="Center"/>
                            </Border>
                            <Border Grid.Row="0" Grid.Column="2" Background="{StaticResource BlueGray100Brush}" Padding="8,6" Margin="0,0,1,1">
                                <TextBlock Text="3ë…„ì°¨" Style="{StaticResource LabelText}" FontSize="11" HorizontalAlignment="Center"/>
                            </Border>
                            <Border Grid.Row="0" Grid.Column="3" Background="{StaticResource BlueGray100Brush}" Padding="8,6" Margin="0,0,1,1">
                                <TextBlock Text="4ë…„ì°¨" Style="{StaticResource LabelText}" FontSize="11" HorizontalAlignment="Center"/>
                            </Border>
                            <Border Grid.Row="0" Grid.Column="4" Background="{StaticResource BlueGray100Brush}" Padding="8,6" Margin="0,0,0,1">
                                <TextBlock Text="5ë…„ì°¨" Style="{StaticResource LabelText}" FontSize="11" HorizontalAlignment="Center"/>
                            </Border>

                            <Border Grid.Row="1" Grid.Column="0" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="1,0,1,1" Padding="4">
                                <TextBox Text="{Binding FreeRentMonths1, UpdateSourceTrigger=PropertyChanged}" 
                                         HorizontalContentAlignment="Center" FontSize="11"/>
                            </Border>
                            <Border Grid.Row="1" Grid.Column="1" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="0,0,1,1" Padding="4">
                                <TextBox Text="{Binding FreeRentMonths2, UpdateSourceTrigger=PropertyChanged}" 
                                         HorizontalContentAlignment="Center" FontSize="11"/>
                            </Border>
                            <Border Grid.Row="1" Grid.Column="2" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="0,0,1,1" Padding="4">
                                <TextBox Text="{Binding FreeRentMonths3, UpdateSourceTrigger=PropertyChanged}" 
                                         HorizontalContentAlignment="Center" FontSize="11"/>
                            </Border>
                            <Border Grid.Row="1" Grid.Column="3" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="0,0,1,1" Padding="4">
                                <TextBox Text="{Binding FreeRentMonths4, UpdateSourceTrigger=PropertyChanged}" 
                                         HorizontalContentAlignment="Center" FontSize="11"/>
                            </Border>
                            <Border Grid.Row="1" Grid.Column="4" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="0,0,1,1" Padding="4">
                                <TextBox Text="{Binding FreeRentMonths5, UpdateSourceTrigger=PropertyChanged}" 
                                         HorizontalContentAlignment="Center" FontSize="11"/>
                            </Border>
                        </Grid>

                        <Border Background="{StaticResource BlueGray50Brush}" CornerRadius="4" Padding="12">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="IRR" Style="{StaticResource LabelText}" FontSize="11"/>
                                    <TextBlock Text="{Binding IrrValue, StringFormat={}{0:P2}}" 
                                               Style="{StaticResource ValueText}" FontWeight="Bold"/>
                                </StackPanel>
                                <StackPanel Grid.Column="1">
                                    <TextBlock Text="TV (Total Value)" Style="{StaticResource LabelText}" FontSize="11"/>
                                    <TextBlock Text="{Binding TotalValue, StringFormat=\{0:N0\}}" 
                                               Style="{StaticResource ValueText}" FontWeight="Bold"/>
                                </StackPanel>
                            </Grid>
                        </Border>
                    </StackPanel>
                </Border>

                <!-- ë‚™ì°°í†µê³„ -->
                <Border Style="{StaticResource CardBorder}" Padding="16" Margin="0,0,0,16">
                    <StackPanel>
                        <Grid Margin="0,0,0,12">
                            <TextBlock Text="ðŸ“ˆ ë‚™ì°°í†µê³„" Style="{StaticResource SectionHeader}" Margin="0"/>
                        </Grid>
                        
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="80"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <Border Grid.Row="0" Grid.Column="0" Background="{StaticResource BlueGray100Brush}" Padding="8,6" Margin="0,0,1,1">
                                <TextBlock Text="ì§€ì—­í†µê³„" Style="{StaticResource LabelText}" FontWeight="SemiBold"/>
                            </Border>
                            <Border Grid.Row="0" Grid.Column="1" Background="{StaticResource BlueGray100Brush}" Padding="8,6" Margin="0,0,1,1">
                                <TextBlock Text="{Binding RegionName1}" Style="{StaticResource ValueText}" FontWeight="SemiBold" HorizontalAlignment="Center"/>
                            </Border>
                            <Border Grid.Row="0" Grid.Column="2" Background="{StaticResource BlueGray100Brush}" Padding="8,6" Margin="0,0,1,1">
                                <TextBlock Text="{Binding RegionName2}" Style="{StaticResource ValueText}" FontWeight="SemiBold" HorizontalAlignment="Center"/>
                            </Border>
                            <Border Grid.Row="0" Grid.Column="3" Background="{StaticResource BlueGray100Brush}" Padding="8,6" Margin="0,0,0,1">
                                <TextBlock Text="{Binding RegionName3}" Style="{StaticResource ValueText}" FontWeight="SemiBold" HorizontalAlignment="Center"/>
                            </Border>

                            <Border Grid.Row="1" Grid.Column="0" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="1,0,1,1" Padding="8,6">
                                <TextBlock Text="1ë…„ í‰ê· " Style="{StaticResource LabelText}"/>
                            </Border>
                            <Border Grid.Row="1" Grid.Column="1" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="0,0,1,1" Padding="8,6">
                                <TextBlock Text="{Binding Stats1Year_Display1}" Style="{StaticResource ValueText}" HorizontalAlignment="Center"/>
                            </Border>
                            <Border Grid.Row="1" Grid.Column="2" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="0,0,1,1" Padding="8,6">
                                <TextBlock Text="{Binding Stats1Year_Display2}" Style="{StaticResource ValueText}" HorizontalAlignment="Center"/>
                            </Border>
                            <Border Grid.Row="1" Grid.Column="3" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="0,0,1,1" Padding="8,6">
                                <TextBlock Text="{Binding Stats1Year_Display3}" Style="{StaticResource ValueText}" HorizontalAlignment="Center"/>
                            </Border>

                            <Border Grid.Row="2" Grid.Column="0" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="1,0,1,1" Padding="8,6">
                                <TextBlock Text="6ê°œì›” í‰ê· " Style="{StaticResource LabelText}"/>
                            </Border>
                            <Border Grid.Row="2" Grid.Column="1" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="0,0,1,1" Padding="8,6">
                                <TextBlock Text="{Binding Stats6Month_Display1}" Style="{StaticResource ValueText}" HorizontalAlignment="Center"/>
                            </Border>
                            <Border Grid.Row="2" Grid.Column="2" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="0,0,1,1" Padding="8,6">
                                <TextBlock Text="{Binding Stats6Month_Display2}" Style="{StaticResource ValueText}" HorizontalAlignment="Center"/>
                            </Border>
                            <Border Grid.Row="2" Grid.Column="3" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="0,0,1,1" Padding="8,6">
                                <TextBlock Text="{Binding Stats6Month_Display3}" Style="{StaticResource ValueText}" HorizontalAlignment="Center"/>
                            </Border>

                            <Border Grid.Row="3" Grid.Column="0" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="1,0,1,1" Padding="8,6">
                                <TextBlock Text="3ê°œì›” í‰ê· " Style="{StaticResource LabelText}"/>
                            </Border>
                            <Border Grid.Row="3" Grid.Column="1" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="0,0,1,1" Padding="8,6">
                                <TextBlock Text="{Binding Stats3Month_Display1}" Style="{StaticResource ValueText}" HorizontalAlignment="Center"/>
                            </Border>
                            <Border Grid.Row="3" Grid.Column="2" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="0,0,1,1" Padding="8,6">
                                <TextBlock Text="{Binding Stats3Month_Display2}" Style="{StaticResource ValueText}" HorizontalAlignment="Center"/>
                            </Border>
                            <Border Grid.Row="3" Grid.Column="3" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="0,0,1,1" Padding="8,6">
                                <TextBlock Text="{Binding Stats3Month_Display3}" Style="{StaticResource ValueText}" HorizontalAlignment="Center"/>
                            </Border>

                            <Border Grid.Row="0" Grid.RowSpan="4" Grid.Column="4"
                                    Background="{StaticResource PrimaryBrush}"
                                    CornerRadius="8"
                                    Padding="16,12"
                                    Margin="12,0,0,0"
                                    VerticalAlignment="Center">
                                <StackPanel>
                                    <TextBlock Text="{Binding AppliedBidRate, StringFormat={}{0:P1}}" 
                                               FontSize="18"
                                               FontWeight="Bold"
                                               Foreground="White"
                                               HorizontalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                        </Grid>
                    </StackPanel>
                </Border>

                <!-- Tool Box: ì„ ìˆœìœ„ê´€ë¦¬ë¹„ -->
                <Border Style="{StaticResource CardBorder}" Padding="16">
                    <StackPanel>
                        <TextBlock Text="ðŸ¢ ì„ ìˆœìœ„ê´€ë¦¬ë¹„" Style="{StaticResource SectionHeader}" Margin="0,0,0,12"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="120"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0" Grid.Column="0" Text="ê´€ë¦¬ì‚¬ë¬´ì†Œ ë²ˆí˜¸" Style="{StaticResource LabelText}" Margin="0,0,0,8"/>
                            <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding ManagementOfficePhone, UpdateSourceTrigger=PropertyChanged}" Margin="0,0,0,8"/>
                            
                            <TextBlock Grid.Row="1" Grid.Column="0" Text="ì²´ë‚©ê´€ë¦¬ë¹„" Style="{StaticResource LabelText}" Margin="0,0,0,8"/>
                            <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding ArrearsFee, StringFormat=N0, UpdateSourceTrigger=PropertyChanged}" Margin="0,0,0,8"/>
                            
                            <TextBlock Grid.Row="2" Grid.Column="0" Text="ì›” ê´€ë¦¬ë¹„" Style="{StaticResource LabelText}" Margin="0,0,0,8"/>
                            <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding MonthlyFee, StringFormat=N0, UpdateSourceTrigger=PropertyChanged}" Margin="0,0,0,8"/>
                        </Grid>

                        <Border Background="{StaticResource BlueGray50Brush}" CornerRadius="4" Padding="12" Margin="0,8,0,0">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="1ì•ˆ ì¶”ì •ê´€ë¦¬ë¹„" Style="{StaticResource LabelText}" FontSize="11"/>
                                    <TextBlock Text="{Binding Scenario1EstimatedFee, StringFormat=\{0:N0\}}" 
                                               Style="{StaticResource ValueText}" FontWeight="Bold"/>
                                </StackPanel>
                                <StackPanel Grid.Column="1">
                                    <TextBlock Text="2ì•ˆ ì¶”ì •ê´€ë¦¬ë¹„" Style="{StaticResource LabelText}" FontSize="11"/>
                                    <TextBlock Text="{Binding Scenario2EstimatedFee, StringFormat=\{0:N0\}}" 
                                               Style="{StaticResource ValueText}" FontWeight="Bold"/>
                                </StackPanel>
                            </Grid>
                        </Border>
                    </StackPanel>
                </Border>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</UserControl>
