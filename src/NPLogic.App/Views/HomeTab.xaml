<UserControl x:Class="NPLogic.Views.HomeTab"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:controls="clr-namespace:NPLogic.Controls;assembly=NPLogic.UI"
             xmlns:vm="clr-namespace:NPLogic.ViewModels"
             mc:Ignorable="d" 
             d:DesignHeight="1200" d:DesignWidth="1400"
             d:DataContext="{d:DesignInstance Type=vm:PropertyDetailViewModel}">
    
    <UserControl.Resources>
        <!-- 카드 스타일 -->
        <Style x:Key="SummaryCardStyle" TargetType="Border">
            <Setter Property="Background" Value="{StaticResource BackgroundBrush}"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="16"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="Black" Opacity="0.08" BlurRadius="10" ShadowDepth="2"/>
                </Setter.Value>
            </Setter>
        </Style>
        
        <!-- 카드 헤더 스타일 -->
        <Style x:Key="CardHeaderStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="{StaticResource FontSizeH4}"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="{StaticResource PrimaryBrush}"/>
            <Setter Property="Margin" Value="0,0,0,12"/>
        </Style>
        
        <!-- 라벨 스타일 -->
        <Style x:Key="LabelStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="{StaticResource FontSizeSmall}"/>
            <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
            <Setter Property="Margin" Value="0,4"/>
        </Style>
        
        <!-- 값 스타일 -->
        <Style x:Key="ValueStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="{StaticResource FontSizeBody}"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Margin" Value="0,4"/>
        </Style>
        
        <!-- 금액 값 스타일 -->
        <Style x:Key="AmountValueStyle" TargetType="TextBlock" BasedOn="{StaticResource ValueStyle}">
            <Setter Property="Foreground" Value="{StaticResource PrimaryBrush}"/>
        </Style>
        
        <!-- 상태 뱃지 스타일 -->
        <Style x:Key="StatusBadgeStyle" TargetType="Border">
            <Setter Property="CornerRadius" Value="4"/>
            <Setter Property="Padding" Value="8,4"/>
            <Setter Property="Margin" Value="4,0"/>
        </Style>
    </UserControl.Resources>
    
    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
        <Grid Margin="24">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            
            <!-- ========== Row 0: 물건 헤더 ========== -->
            <!-- 피드백 섹션 16: 흰색 배경 + 네이비 테두리로 통일 -->
            <Border Grid.Row="0"
                    Background="{StaticResource SurfaceBrush}"
                    CornerRadius="12"
                    Padding="24"
                    Margin="0,0,0,20"
                    BorderBrush="{StaticResource PrimaryBrush}"
                    BorderThickness="2">
                <Border.Effect>
                    <DropShadowEffect Color="Black" Opacity="0.1" BlurRadius="15" ShadowDepth="3"/>
                </Border.Effect>
                
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <StackPanel Grid.Column="0">
                        <TextBlock Style="{StaticResource H2TextStyle}" 
                                   Foreground="{StaticResource PrimaryBrush}"
                                   Margin="0,0,0,8">
                            <Run Text="물건번호: "/>
                            <Run Text="{Binding Property.PropertyNumber}" FontWeight="Bold"/>
                        </TextBlock>
                        
                        <TextBlock Text="{Binding DisplayAddress}" 
                                   Style="{StaticResource BodyTextStyle}"
                                   TextWrapping="Wrap"
                                   Opacity="0.8"
                                   Margin="0,0,0,12"/>
                        
                        <StackPanel Orientation="Horizontal">
                            <!-- 물건 유형 뱃지 -->
                            <Border Background="{StaticResource PrimaryBrush}"
                                    CornerRadius="4"
                                    Padding="12,6"
                                    Margin="0,0,8,0"
                                    Visibility="{Binding Property.PropertyType, Converter={StaticResource NullToVisibilityConverter}, FallbackValue=Collapsed}">
                                <TextBlock Text="{Binding Property.PropertyType, FallbackValue='-'}" 
                                           Foreground="White"
                                           FontWeight="SemiBold"
                                           FontSize="{StaticResource FontSizeBody}"/>
                            </Border>
                            
                            <!-- 상태 뱃지 -->
                            <Border CornerRadius="4" Padding="12,6">
                                <Border.Style>
                                    <Style TargetType="Border">
                                        <Setter Property="Background" Value="{StaticResource WarningBrush}"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Property.Status}" Value="completed">
                                                <Setter Property="Background" Value="{StaticResource SuccessBrush}"/>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Property.Status}" Value="processing">
                                                <Setter Property="Background" Value="{StaticResource InfoBrush}"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Border.Style>
                                <TextBlock Foreground="White" FontWeight="SemiBold" FontSize="{StaticResource FontSizeBody}">
                                    <TextBlock.Style>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="Text" Value="대기"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Property.Status}" Value="completed">
                                                    <Setter Property="Text" Value="완료"/>
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding Property.Status}" Value="processing">
                                                    <Setter Property="Text" Value="진행중"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style>
                                </TextBlock>
                            </Border>
                        </StackPanel>
                    </StackPanel>
                    
                    <!-- 프로젝트 정보 -->
                    <Border Grid.Column="1"
                            Background="White"
                            CornerRadius="8"
                            Padding="16"
                            VerticalAlignment="Center">
                        <StackPanel>
                            <TextBlock Text="프로젝트" 
                                       Style="{StaticResource CaptionTextStyle}"
                                       Foreground="{StaticResource TextSecondaryBrush}"
                                       Margin="0,0,0,4"/>
                            <TextBlock Text="{Binding ProgramName}" 
                                       Style="{StaticResource H4TextStyle}"
                                       FontWeight="Bold"/>
                        </StackPanel>
                    </Border>
                </Grid>
            </Border>
            
            <!-- ========== Row 1: 차주 정보 + Loan 요약 ========== -->
            <Grid Grid.Row="1" Margin="0,0,0,16">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="16"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                
                <!-- 차주 정보 카드 -->
                <Border Grid.Column="0" Style="{StaticResource SummaryCardStyle}">
                    <StackPanel>
                        <TextBlock Text="차주 정보" Style="{StaticResource CardHeaderStyle}"/>
                        
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="110"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <!-- 차주번호 -->
                            <TextBlock Grid.Row="0" Grid.Column="0" Text="차주번호" Style="{StaticResource LabelStyle}"/>
                            <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding BorrowerSummary.BorrowerNumber, FallbackValue=-}" Style="{StaticResource ValueStyle}"/>
                            
                            <!-- 차주명 -->
                            <TextBlock Grid.Row="1" Grid.Column="0" Text="차주명" Style="{StaticResource LabelStyle}"/>
                            <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding BorrowerSummary.BorrowerName, FallbackValue=-}" Style="{StaticResource ValueStyle}"/>
                            
                            <!-- 차주유형 -->
                            <TextBlock Grid.Row="2" Grid.Column="0" Text="차주유형" Style="{StaticResource LabelStyle}"/>
                            <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding BorrowerSummary.BorrowerType, FallbackValue=-}" Style="{StaticResource ValueStyle}"/>
                            
                            <!-- 상태 -->
                            <TextBlock Grid.Row="3" Grid.Column="0" Text="상태" Style="{StaticResource LabelStyle}"/>
                            <StackPanel Grid.Row="3" Grid.Column="1" Orientation="Horizontal" Margin="0,4">
                                <Border Background="#FFEBEE" CornerRadius="3" Padding="6,2" Margin="0,0,4,0"
                                        Visibility="{Binding BorrowerSummary.IsRestructuring, Converter={StaticResource BoolToVisibilityConverter}}">
                                    <TextBlock Text="회생" FontSize="11" Foreground="#C62828"/>
                                </Border>
                                <Border Background="#FFF3E0" CornerRadius="3" Padding="6,2" Margin="0,0,4,0"
                                        Visibility="{Binding BorrowerSummary.IsOpened, Converter={StaticResource BoolToVisibilityConverter}}">
                                    <TextBlock Text="개회" FontSize="11" Foreground="#E65100"/>
                                </Border>
                                <Border Background="#EFEBE9" CornerRadius="3" Padding="6,2"
                                        Visibility="{Binding BorrowerSummary.IsDeceased, Converter={StaticResource BoolToVisibilityConverter}}">
                                    <TextBlock Text="사망" FontSize="11" Foreground="#4E342E"/>
                                </Border>
                                <TextBlock Text="정상" Foreground="{StaticResource SuccessBrush}">
                                    <TextBlock.Style>
                                        <Style TargetType="TextBlock" BasedOn="{StaticResource ValueStyle}">
                                            <Setter Property="Visibility" Value="Visible"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding BorrowerSummary.IsRestructuring}" Value="True">
                                                    <Setter Property="Visibility" Value="Collapsed"/>
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding BorrowerSummary.IsOpened}" Value="True">
                                                    <Setter Property="Visibility" Value="Collapsed"/>
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding BorrowerSummary.IsDeceased}" Value="True">
                                                    <Setter Property="Visibility" Value="Collapsed"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style>
                                </TextBlock>
                            </StackPanel>
                            
                            <!-- OPB -->
                            <TextBlock Grid.Row="4" Grid.Column="0" Text="OPB" Style="{StaticResource LabelStyle}"/>
                            <TextBlock Grid.Row="4" Grid.Column="1" Text="{Binding BorrowerSummary.OpbDisplay, FallbackValue=-}" Style="{StaticResource AmountValueStyle}"/>
                            
                            <!-- XNPV 1안 -->
                            <TextBlock Grid.Row="5" Grid.Column="0" Text="XNPV 1안" Style="{StaticResource LabelStyle}"/>
                            <StackPanel Grid.Row="5" Grid.Column="1" Orientation="Horizontal" Margin="0,4">
                                <TextBlock Text="{Binding BorrowerSummary.XnpvScenario1, StringFormat={}{0:N0}원, FallbackValue=-}" Style="{StaticResource ValueStyle}"/>
                                <TextBlock Text=" (" Foreground="{StaticResource TextSecondaryBrush}"/>
                                <TextBlock Text="{Binding BorrowerSummary.XnpvRatio1Display, FallbackValue=-}" Foreground="{StaticResource InfoBrush}"/>
                                <TextBlock Text=")" Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            
                            <!-- XNPV 2안 -->
                            <TextBlock Grid.Row="6" Grid.Column="0" Text="XNPV 2안" Style="{StaticResource LabelStyle}"/>
                            <StackPanel Grid.Row="6" Grid.Column="1" Orientation="Horizontal" Margin="0,4">
                                <TextBlock Text="{Binding BorrowerSummary.XnpvScenario2, StringFormat={}{0:N0}원, FallbackValue=-}" Style="{StaticResource ValueStyle}"/>
                                <TextBlock Text=" (" Foreground="{StaticResource TextSecondaryBrush}"/>
                                <TextBlock Text="{Binding BorrowerSummary.XnpvRatio2Display, FallbackValue=-}" Foreground="{StaticResource InfoBrush}"/>
                                <TextBlock Text=")" Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                        </Grid>
                    </StackPanel>
                </Border>
                
                <!-- Loan 요약 카드 -->
                <Border Grid.Column="2" Style="{StaticResource SummaryCardStyle}">
                    <StackPanel>
                        <TextBlock Text="Loan 요약" Style="{StaticResource CardHeaderStyle}"/>
                        
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="110"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <!-- 대출 건수 -->
                            <TextBlock Grid.Row="0" Grid.Column="0" Text="대출 건수" Style="{StaticResource LabelStyle}"/>
                            <TextBlock Grid.Row="0" Grid.Column="1" Style="{StaticResource ValueStyle}">
                                <Run Text="{Binding LoanSummary.LoanCount, FallbackValue=0}"/>
                                <Run Text="건" Foreground="{StaticResource TextSecondaryBrush}"/>
                            </TextBlock>
                            
                            <!-- 대출원금잔액 -->
                            <TextBlock Grid.Row="1" Grid.Column="0" Text="대출원금잔액" Style="{StaticResource LabelStyle}"/>
                            <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding LoanSummary.TotalPrincipalBalanceDisplay, FallbackValue=-}" Style="{StaticResource AmountValueStyle}"/>
                            
                            <!-- 채권액 합계 -->
                            <TextBlock Grid.Row="2" Grid.Column="0" Text="채권액 합계" Style="{StaticResource LabelStyle}"/>
                            <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding LoanSummary.TotalClaimAmountDisplay, FallbackValue=-}" Style="{StaticResource ValueStyle}"/>
                            
                            <!-- Loan Cap 1안 -->
                            <TextBlock Grid.Row="3" Grid.Column="0" Text="Loan Cap 1안" Style="{StaticResource LabelStyle}"/>
                            <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding LoanSummary.TotalLoanCap1Display, FallbackValue=-}" Style="{StaticResource AmountValueStyle}"/>
                            
                            <!-- Loan Cap 2안 -->
                            <TextBlock Grid.Row="4" Grid.Column="0" Text="Loan Cap 2안" Style="{StaticResource LabelStyle}"/>
                            <TextBlock Grid.Row="4" Grid.Column="1" Text="{Binding LoanSummary.TotalLoanCap2Display, FallbackValue=-}" Style="{StaticResource AmountValueStyle}"/>
                            
                            <!-- 보증서 현황 -->
                            <TextBlock Grid.Row="5" Grid.Column="0" Text="보증서 현황" Style="{StaticResource LabelStyle}"/>
                            <TextBlock Grid.Row="5" Grid.Column="1" Text="{Binding LoanSummary.GuaranteeStatusDisplay, FallbackValue=-}" Style="{StaticResource ValueStyle}"/>
                        </Grid>
                    </StackPanel>
                </Border>
            </Grid>
            
            <!-- ========== Row 2: 담보물건 + 선순위 ========== -->
            <Grid Grid.Row="2" Margin="0,0,0,16">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="16"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                
                <!-- 담보물건 카드 -->
                <Border Grid.Column="0" Style="{StaticResource SummaryCardStyle}">
                    <StackPanel>
                        <TextBlock Text="담보물건" Style="{StaticResource CardHeaderStyle}"/>
                        
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="110"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <!-- 담보종류 -->
                            <TextBlock Grid.Row="0" Grid.Column="0" Text="담보종류" Style="{StaticResource LabelStyle}"/>
                            <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding CollateralSummary.PropertyType, FallbackValue=-}" Style="{StaticResource ValueStyle}"/>
                            
                            <!-- 토지 면적 -->
                            <TextBlock Grid.Row="1" Grid.Column="0" Text="토지 면적" Style="{StaticResource LabelStyle}"/>
                            <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding CollateralSummary.LandAreaDisplay, FallbackValue=-}" Style="{StaticResource ValueStyle}"/>
                            
                            <!-- 건물 면적 -->
                            <TextBlock Grid.Row="2" Grid.Column="0" Text="건물 면적" Style="{StaticResource LabelStyle}"/>
                            <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding CollateralSummary.BuildingAreaDisplay, FallbackValue=-}" Style="{StaticResource ValueStyle}"/>
                            
                            <!-- 감정평가액 -->
                            <TextBlock Grid.Row="3" Grid.Column="0" Text="감정평가액" Style="{StaticResource LabelStyle}"/>
                            <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding CollateralSummary.AppraisalValueDisplay, FallbackValue=-}" Style="{StaticResource AmountValueStyle}"/>
                            
                            <!-- 공장저당 -->
                            <TextBlock Grid.Row="4" Grid.Column="0" Text="공장저당" Style="{StaticResource LabelStyle}"/>
                            <TextBlock Grid.Row="4" Grid.Column="1" Text="{Binding CollateralSummary.FactoryMortgageDisplay, FallbackValue=-}" Style="{StaticResource ValueStyle}"/>
                            
                            <!-- 공단입주 -->
                            <TextBlock Grid.Row="5" Grid.Column="0" Text="공단입주" Style="{StaticResource LabelStyle}"/>
                            <TextBlock Grid.Row="5" Grid.Column="1" Text="{Binding CollateralSummary.IndustrialComplexDisplay, FallbackValue=-}" Style="{StaticResource ValueStyle}"/>
                        </Grid>
                    </StackPanel>
                </Border>
                
                <!-- 선순위 요약 카드 -->
                <Border Grid.Column="2" Style="{StaticResource SummaryCardStyle}">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="선순위 요약" Style="{StaticResource CardHeaderStyle}"/>
                            <TextBlock Text=" (DD/반영)" 
                                       FontSize="{StaticResource FontSizeSmall}" 
                                       Foreground="{StaticResource TextTertiaryBrush}"
                                       VerticalAlignment="Center"
                                       Margin="8,0,0,12"/>
                        </StackPanel>
                        
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="100"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <!-- 선순위 근저당 -->
                            <TextBlock Grid.Row="0" Grid.Column="0" Text="선순위근저당" Style="{StaticResource LabelStyle}"/>
                            <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding SeniorRightsSummary.SeniorMortgageDisplay, FallbackValue=0 / 0}" Style="{StaticResource ValueStyle}" FontSize="12"/>
                            
                            <!-- 유치권 -->
                            <TextBlock Grid.Row="1" Grid.Column="0" Text="유치권" Style="{StaticResource LabelStyle}"/>
                            <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding SeniorRightsSummary.LienDisplay, FallbackValue=0 / 0}" Style="{StaticResource ValueStyle}" FontSize="12"/>
                            
                            <!-- 소액보증금 -->
                            <TextBlock Grid.Row="2" Grid.Column="0" Text="소액보증금" Style="{StaticResource LabelStyle}"/>
                            <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding SeniorRightsSummary.SmallDepositDisplay, FallbackValue=0 / 0}" Style="{StaticResource ValueStyle}" FontSize="12"/>
                            
                            <!-- 임차보증금 -->
                            <TextBlock Grid.Row="3" Grid.Column="0" Text="임차보증금" Style="{StaticResource LabelStyle}"/>
                            <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding SeniorRightsSummary.LeaseDepositDisplay, FallbackValue=0 / 0}" Style="{StaticResource ValueStyle}" FontSize="12"/>
                            
                            <!-- 임금채권 -->
                            <TextBlock Grid.Row="4" Grid.Column="0" Text="임금채권" Style="{StaticResource LabelStyle}"/>
                            <TextBlock Grid.Row="4" Grid.Column="1" Text="{Binding SeniorRightsSummary.WageClaimDisplay, FallbackValue=0 / 0}" Style="{StaticResource ValueStyle}" FontSize="12"/>
                            
                            <!-- 당해세 -->
                            <TextBlock Grid.Row="5" Grid.Column="0" Text="당해세" Style="{StaticResource LabelStyle}"/>
                            <TextBlock Grid.Row="5" Grid.Column="1" Text="{Binding SeniorRightsSummary.CurrentTaxDisplay, FallbackValue=0 / 0}" Style="{StaticResource ValueStyle}" FontSize="12"/>
                            
                            <!-- 조세채권 -->
                            <TextBlock Grid.Row="6" Grid.Column="0" Text="조세채권" Style="{StaticResource LabelStyle}"/>
                            <TextBlock Grid.Row="6" Grid.Column="1" Text="{Binding SeniorRightsSummary.SeniorTaxDisplay, FallbackValue=0 / 0}" Style="{StaticResource ValueStyle}" FontSize="12"/>
                            
                            <!-- 합계 -->
                            <TextBlock Grid.Row="7" Grid.Column="0" Text="합계" Style="{StaticResource LabelStyle}" FontWeight="Bold"/>
                            <TextBlock Grid.Row="7" Grid.Column="1" Text="{Binding SeniorRightsSummary.TotalReflectedDisplay, FallbackValue=-}" Style="{StaticResource AmountValueStyle}"/>
                        </Grid>
                    </StackPanel>
                </Border>
            </Grid>
            
            <!-- ========== Row 3: 평가 요약 + 경(공)매일정 ========== -->
            <Grid Grid.Row="3" Margin="0,0,0,16">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="16"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                
                <!-- 평가 요약 카드 -->
                <Border Grid.Column="0" Style="{StaticResource SummaryCardStyle}">
                    <StackPanel>
                        <TextBlock Text="평가 요약" Style="{StaticResource CardHeaderStyle}"/>
                        
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="110"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <!-- 평가유형 -->
                            <TextBlock Grid.Row="0" Grid.Column="0" Text="평가유형" Style="{StaticResource LabelStyle}"/>
                            <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding EvaluationSummary.EvaluationType, FallbackValue=-}" Style="{StaticResource ValueStyle}"/>
                            
                            <!-- 시나리오1 낙찰가 -->
                            <TextBlock Grid.Row="1" Grid.Column="0" Text="1안 낙찰가" Style="{StaticResource LabelStyle}"/>
                            <StackPanel Grid.Row="1" Grid.Column="1" Orientation="Horizontal" Margin="0,4">
                                <TextBlock Text="{Binding EvaluationSummary.Scenario1Display, FallbackValue=-}" Style="{StaticResource AmountValueStyle}"/>
                                <TextBlock Text=" (" Foreground="{StaticResource TextSecondaryBrush}"/>
                                <TextBlock Text="{Binding EvaluationSummary.Scenario1BidRateDisplay, FallbackValue=-}" Foreground="{StaticResource InfoBrush}"/>
                                <TextBlock Text=")" Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            
                            <!-- 시나리오2 낙찰가 -->
                            <TextBlock Grid.Row="2" Grid.Column="0" Text="2안 낙찰가" Style="{StaticResource LabelStyle}"/>
                            <StackPanel Grid.Row="2" Grid.Column="1" Orientation="Horizontal" Margin="0,4">
                                <TextBlock Text="{Binding EvaluationSummary.Scenario2Display, FallbackValue=-}" Style="{StaticResource AmountValueStyle}"/>
                                <TextBlock Text=" (" Foreground="{StaticResource TextSecondaryBrush}"/>
                                <TextBlock Text="{Binding EvaluationSummary.Scenario2BidRateDisplay, FallbackValue=-}" Foreground="{StaticResource InfoBrush}"/>
                                <TextBlock Text=")" Foreground="{StaticResource TextSecondaryBrush}"/>
                            </StackPanel>
                            
                            <!-- 적용 낙찰가율 -->
                            <TextBlock Grid.Row="3" Grid.Column="0" Text="적용 낙찰가율" Style="{StaticResource LabelStyle}"/>
                            <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding EvaluationSummary.AppliedBidRateDisplay, FallbackValue=-}" Style="{StaticResource ValueStyle}" Foreground="{StaticResource PrimaryBrush}"/>
                            
                            <!-- 평가사유 -->
                            <TextBlock Grid.Row="4" Grid.Column="0" Text="평가사유" Style="{StaticResource LabelStyle}"/>
                            <TextBlock Grid.Row="4" Grid.Column="1" 
                                       Text="{Binding EvaluationSummary.EvaluationReason, FallbackValue=-}" 
                                       Style="{StaticResource ValueStyle}"
                                       TextTrimming="CharacterEllipsis"
                                       ToolTip="{Binding EvaluationSummary.EvaluationReason}"/>
                        </Grid>
                    </StackPanel>
                </Border>
                
                <!-- 경(공)매일정 카드 -->
                <Border Grid.Column="2" Style="{StaticResource SummaryCardStyle}">
                    <StackPanel>
                        <TextBlock Text="경(공)매일정" Style="{StaticResource CardHeaderStyle}"/>
                        
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="110"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <!-- 경매개시여부 -->
                            <TextBlock Grid.Row="0" Grid.Column="0" Text="경매개시" Style="{StaticResource LabelStyle}"/>
                            <Border Grid.Row="0" Grid.Column="1" 
                                    HorizontalAlignment="Left"
                                    CornerRadius="3" 
                                    Padding="8,3"
                                    Margin="0,4">
                                <Border.Style>
                                    <Style TargetType="Border">
                                        <Setter Property="Background" Value="#E3F2FD"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding AuctionSummary.IsAuctionStarted}" Value="True">
                                                <Setter Property="Background" Value="#E8F5E9"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Border.Style>
                                <TextBlock Text="{Binding AuctionSummary.AuctionStatusDisplay, FallbackValue=미개시}" FontSize="12">
                                    <TextBlock.Style>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="Foreground" Value="#1565C0"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding AuctionSummary.IsAuctionStarted}" Value="True">
                                                    <Setter Property="Foreground" Value="#2E7D32"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style>
                                </TextBlock>
                            </Border>
                            
                            <!-- 관할법원/사건번호 -->
                            <TextBlock Grid.Row="1" Grid.Column="0" Text="법원/사건번호" Style="{StaticResource LabelStyle}"/>
                            <TextBlock Grid.Row="1" Grid.Column="1" 
                                       Text="{Binding AuctionSummary.CourtCaseDisplay, FallbackValue=-}" 
                                       Style="{StaticResource ValueStyle}"
                                       TextTrimming="CharacterEllipsis"/>
                            
                            <!-- 최종경매 -->
                            <TextBlock Grid.Row="2" Grid.Column="0" Text="최종경매" Style="{StaticResource LabelStyle}"/>
                            <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding AuctionSummary.FinalAuctionDisplay, FallbackValue=-}" Style="{StaticResource ValueStyle}"/>
                            
                            <!-- 차후예정일 -->
                            <TextBlock Grid.Row="3" Grid.Column="0" Text="차후예정일" Style="{StaticResource LabelStyle}"/>
                            <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding AuctionSummary.NextAuctionDisplay, FallbackValue=-}" Style="{StaticResource ValueStyle}" Foreground="{StaticResource WarningBrush}"/>
                            
                            <!-- 차후 최저입찰가 -->
                            <TextBlock Grid.Row="4" Grid.Column="0" Text="최저입찰가" Style="{StaticResource LabelStyle}"/>
                            <TextBlock Grid.Row="4" Grid.Column="1" Text="{Binding AuctionSummary.NextMinimumBidDisplay, FallbackValue=-}" Style="{StaticResource AmountValueStyle}"/>
                            
                            <!-- 낙찰금액 -->
                            <TextBlock Grid.Row="5" Grid.Column="0" Text="낙찰금액" Style="{StaticResource LabelStyle}"/>
                            <TextBlock Grid.Row="5" Grid.Column="1" Text="{Binding AuctionSummary.WinningBidAmountDisplay, FallbackValue=-}" Style="{StaticResource ValueStyle}"/>
                        </Grid>
                    </StackPanel>
                </Border>
            </Grid>
            
            <!-- ========== Row 4: QA 요약 ========== -->
            <Border Grid.Row="4" Style="{StaticResource SummaryCardStyle}">
                <StackPanel>
                    <TextBlock Text="QA 요약" Style="{StaticResource CardHeaderStyle}"/>
                    
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <!-- 전체 QA -->
                        <Border Grid.Column="0" Background="{StaticResource BlueGray50Brush}" CornerRadius="6" Padding="12" Margin="0,0,8,0">
                            <StackPanel HorizontalAlignment="Center">
                                <TextBlock Text="전체" 
                                           Style="{StaticResource CaptionTextStyle}"
                                           HorizontalAlignment="Center"
                                           Margin="0,0,0,4"/>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                    <TextBlock Text="{Binding Property.QaUnansweredCount, FallbackValue=0}" 
                                               FontWeight="Bold" FontSize="16"
                                               Foreground="#E65100"/>
                                    <TextBlock Text="/" FontSize="14" Opacity="0.5" Margin="2,0" VerticalAlignment="Bottom"/>
                                    <TextBlock Text="{Binding QaList.Count, FallbackValue=0}" 
                                               FontSize="14" Opacity="0.7" VerticalAlignment="Bottom"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                        
                        <!-- 론 QA -->
                        <Border Grid.Column="1" Background="{StaticResource BlueGray50Brush}" CornerRadius="6" Padding="12" Margin="0,0,8,0">
                            <StackPanel HorizontalAlignment="Center">
                                <TextBlock Text="론" 
                                           Style="{StaticResource CaptionTextStyle}"
                                           HorizontalAlignment="Center"
                                           Margin="0,0,0,4"/>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                    <TextBlock Text="{Binding LoanQaPendingCount, FallbackValue=0}" 
                                               FontWeight="SemiBold"
                                               Foreground="#E65100"/>
                                    <TextBlock Text="/" Opacity="0.5" Margin="2,0"/>
                                    <TextBlock Text="{Binding LoanQaTotalCount, FallbackValue=0}" 
                                               Opacity="0.7"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                        
                        <!-- 담보물건 QA -->
                        <Border Grid.Column="2" Background="{StaticResource BlueGray50Brush}" CornerRadius="6" Padding="12" Margin="0,0,8,0">
                            <StackPanel HorizontalAlignment="Center">
                                <TextBlock Text="담보물건" 
                                           Style="{StaticResource CaptionTextStyle}"
                                           HorizontalAlignment="Center"
                                           Margin="0,0,0,4"/>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                    <TextBlock Text="{Binding CollateralQaPendingCount, FallbackValue=0}" 
                                               FontWeight="SemiBold"
                                               Foreground="#E65100"/>
                                    <TextBlock Text="/" Opacity="0.5" Margin="2,0"/>
                                    <TextBlock Text="{Binding CollateralQaTotalCount, FallbackValue=0}" 
                                               Opacity="0.7"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                        
                        <!-- 선순위 QA -->
                        <Border Grid.Column="3" Background="{StaticResource BlueGray50Brush}" CornerRadius="6" Padding="12" Margin="0,0,8,0">
                            <StackPanel HorizontalAlignment="Center">
                                <TextBlock Text="선순위" 
                                           Style="{StaticResource CaptionTextStyle}"
                                           HorizontalAlignment="Center"
                                           Margin="0,0,0,4"/>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                    <TextBlock Text="{Binding SeniorQaPendingCount, FallbackValue=0}" 
                                               FontWeight="SemiBold"
                                               Foreground="#E65100"/>
                                    <TextBlock Text="/" Opacity="0.5" Margin="2,0"/>
                                    <TextBlock Text="{Binding SeniorQaTotalCount, FallbackValue=0}" 
                                               Opacity="0.7"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                        
                        <!-- 평가 QA -->
                        <Border Grid.Column="4" Background="{StaticResource BlueGray50Brush}" CornerRadius="6" Padding="12" Margin="0,0,8,0">
                            <StackPanel HorizontalAlignment="Center">
                                <TextBlock Text="평가" 
                                           Style="{StaticResource CaptionTextStyle}"
                                           HorizontalAlignment="Center"
                                           Margin="0,0,0,4"/>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                    <TextBlock Text="{Binding EvalQaPendingCount, FallbackValue=0}" 
                                               FontWeight="SemiBold"
                                               Foreground="#E65100"/>
                                    <TextBlock Text="/" Opacity="0.5" Margin="2,0"/>
                                    <TextBlock Text="{Binding EvalQaTotalCount, FallbackValue=0}" 
                                               Opacity="0.7"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                        
                        <!-- 경공매 QA -->
                        <Border Grid.Column="5" Background="{StaticResource BlueGray50Brush}" CornerRadius="6" Padding="12">
                            <StackPanel HorizontalAlignment="Center">
                                <TextBlock Text="경공매" 
                                           Style="{StaticResource CaptionTextStyle}"
                                           HorizontalAlignment="Center"
                                           Margin="0,0,0,4"/>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                    <TextBlock Text="{Binding AuctionQaPendingCount, FallbackValue=0}" 
                                               FontWeight="SemiBold"
                                               Foreground="#E65100"/>
                                    <TextBlock Text="/" Opacity="0.5" Margin="2,0"/>
                                    <TextBlock Text="{Binding AuctionQaTotalCount, FallbackValue=0}" 
                                               Opacity="0.7"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                    </Grid>
                    
                    <!-- 안내 문구 -->
                    <TextBlock Text="* 미회신/전체 형식으로 표시됩니다. 각 탭에서 QA를 관리할 수 있습니다."
                               Style="{StaticResource CaptionTextStyle}"
                               Foreground="{StaticResource TextTertiaryBrush}"
                               Margin="0,12,0,0"/>
                </StackPanel>
            </Border>
        </Grid>
    </ScrollViewer>
</UserControl>
