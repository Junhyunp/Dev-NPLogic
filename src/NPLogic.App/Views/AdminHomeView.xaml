<UserControl x:Class="NPLogic.Views.AdminHomeView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:NPLogic.Views"
             xmlns:vm="clr-namespace:NPLogic.ViewModels"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             mc:Ignorable="d" 
             d:DesignHeight="800" d:DesignWidth="1400"
             d:DataContext="{d:DesignInstance Type=vm:AdminHomeViewModel}"
             Loaded="AdminHomeView_Loaded">
    
    <UserControl.Resources>
        <!-- 패널 토글 버튼 스타일 -->
        <Style x:Key="PanelToggleButton" TargetType="ToggleButton">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="4"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ToggleButton">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                Padding="{TemplateBinding Padding}"
                                CornerRadius="4">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="{StaticResource BlueGray100Brush}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </UserControl.Resources>
    
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition x:Name="LeftPanelColumn" Width="300" MinWidth="0"/>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- ========== 좌측: 프로그램 목록 ========== -->
        <Border x:Name="LeftPanel"
                Grid.Column="0" 
                Background="{StaticResource BackgroundBrush}"
                Margin="12,12,4,12">
            <Border.Effect>
                <DropShadowEffect Color="Black" Opacity="0.06" BlurRadius="6" ShadowDepth="1"/>
            </Border.Effect>
            
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- 헤더 -->
                <Border Grid.Row="0" 
                        Background="{StaticResource PrimaryBrush}"
                        Padding="12,8">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <StackPanel>
                            <TextBlock Text="{Binding DisplayName}" 
                                       Foreground="White"
                                       FontSize="13"
                                       FontWeight="SemiBold"/>
                            <TextBlock Text="진행중인 프로그램" 
                                       Foreground="#B0FFFFFF"
                                       FontSize="11"
                                       Margin="0,2,0,0"/>
                        </StackPanel>
                        
                        <Button Grid.Column="1"
                                Content="프로그램 관리"
                                Command="{Binding GoToProgramManagementCommand}"
                                Style="{StaticResource SecondaryButton}"
                                Foreground="White"
                                Background="Transparent"
                                BorderBrush="#80FFFFFF"
                                Padding="8,4"
                                FontSize="11"
                                Margin="0,0,8,0"/>
                        
                        <!-- 좌측 패널 닫기 버튼 -->
                        <ToggleButton x:Name="LeftPanelToggle"
                                      Grid.Column="2"
                                      Style="{StaticResource PanelToggleButton}"
                                      IsChecked="True"
                                      Click="LeftPanelToggle_Click"
                                      ToolTip="패널 접기">
                            <materialDesign:PackIcon Kind="ChevronLeft" Width="18" Height="18" Foreground="White"/>
                        </ToggleButton>
                    </Grid>
                </Border>

                <!-- 통계 요약 -->
                <Border Grid.Row="1" 
                        Background="{StaticResource BlueGray50Brush}"
                        Padding="12,8">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock FontSize="11" Foreground="{StaticResource TextSecondaryBrush}">
                            <Run Text="전체"/>
                            <Run Text="{Binding TotalProgramCount}" FontWeight="SemiBold"/>
                            <Run Text="개 프로그램"/>
                        </TextBlock>
                    </StackPanel>
                </Border>

                <!-- 프로그램 목록 -->
                <DataGrid Grid.Row="2"
                          ItemsSource="{Binding Programs}"
                          SelectedItem="{Binding SelectedProgram}"
                          AutoGenerateColumns="False"
                          CanUserAddRows="False"
                          SelectionMode="Single"
                          GridLinesVisibility="All"
                          HorizontalGridLinesBrush="{StaticResource TableBorderBrush}"
                          VerticalGridLinesBrush="{StaticResource TableBorderBrush}"
                          HeadersVisibility="Column"
                          Background="Transparent"
                          BorderThickness="0"
                          HorizontalScrollBarVisibility="Auto"
                          VerticalScrollBarVisibility="Auto">
                    
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="프로그램명" 
                                          Binding="{Binding ProgramName}" 
                                          Width="120"
                                          IsReadOnly="True"/>
                        
                        <DataGridTextColumn Header="담당팀" 
                                          Binding="{Binding Team}" 
                                          Width="80"
                                          IsReadOnly="True"/>
                        
                        <DataGridTextColumn Header="회계법인" 
                                          Binding="{Binding AccountingFirm}" 
                                          Width="80"
                                          IsReadOnly="True"/>
                        
                        <DataGridTextColumn Header="물건수" 
                                          Binding="{Binding PropertyCount}" 
                                          Width="60"
                                          IsReadOnly="True">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="HorizontalAlignment" Value="Center"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>
                    </DataGrid.Columns>

                    <DataGrid.RowStyle>
                        <Style TargetType="DataGridRow">
                            <Setter Property="Background" Value="Transparent"/>
                            <Setter Property="Cursor" Value="Hand"/>
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="{StaticResource BlueGray50Brush}"/>
                                </Trigger>
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter Property="Background" Value="{StaticResource BlueGray100Brush}"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </DataGrid.RowStyle>

                    <DataGrid.ColumnHeaderStyle>
                        <Style TargetType="DataGridColumnHeader">
                            <Setter Property="Background" Value="{StaticResource BlueGray100Brush}"/>
                            <Setter Property="Foreground" Value="{StaticResource DeepNavy700Brush}"/>
                            <Setter Property="FontWeight" Value="SemiBold"/>
                            <Setter Property="FontSize" Value="11"/>
                            <Setter Property="Padding" Value="8,10"/>
                            <Setter Property="BorderThickness" Value="0,0,1,1"/>
                            <Setter Property="BorderBrush" Value="{StaticResource BlueGray200Brush}"/>
                        </Style>
                    </DataGrid.ColumnHeaderStyle>

                    <DataGrid.CellStyle>
                        <Style TargetType="DataGridCell">
                            <Setter Property="BorderThickness" Value="0"/>
                            <Setter Property="Padding" Value="8,6"/>
                            <Setter Property="FontSize" Value="12"/>
                            <Style.Triggers>
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter Property="Background" Value="Transparent"/>
                                    <Setter Property="Foreground" Value="{StaticResource DeepNavy700Brush}"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </DataGrid.CellStyle>
                </DataGrid>

                <!-- 프로그램 로딩 표시 -->
                <Grid Grid.Row="2"
                      Visibility="{Binding IsProgramsLoading, Converter={StaticResource BooleanToVisibilityConverter}}"
                      Background="#80FFFFFF">
                    <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                        <ProgressBar IsIndeterminate="True" Width="100" Height="4"/>
                        <TextBlock Text="로딩 중..." Margin="0,8,0,0" FontSize="12" Opacity="0.7"/>
                    </StackPanel>
                </Grid>
            </Grid>
        </Border>

        <!-- 구분선 -->
        <GridSplitter Grid.Column="1" 
                      Width="4" 
                      HorizontalAlignment="Center"
                      VerticalAlignment="Stretch"
                      Background="{StaticResource BlueGray200Brush}"/>

        <!-- ========== 우측: 물건 목록 ========== -->
        <Border Grid.Column="2" 
                Background="{StaticResource BackgroundBrush}"
                Margin="4,12,12,12">
            <Border.Effect>
                <DropShadowEffect Color="Black" Opacity="0.06" BlurRadius="6" ShadowDepth="1"/>
            </Border.Effect>
            
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- 헤더 -->
                <Border Grid.Row="0" 
                        Background="{StaticResource SecondaryBrush}"
                        Padding="12,8">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <!-- 좌측 패널 열기 버튼 (접혀있을 때만 표시) -->
                        <ToggleButton x:Name="LeftPanelOpenButton"
                                      Grid.Column="0"
                                      Style="{StaticResource PanelToggleButton}"
                                      Visibility="Collapsed"
                                      Click="LeftPanelOpen_Click"
                                      ToolTip="프로그램 목록 열기"
                                      Margin="0,0,8,0">
                            <materialDesign:PackIcon Kind="ChevronRight" Width="18" Height="18" Foreground="White"/>
                        </ToggleButton>
                        
                        <StackPanel Grid.Column="1">
                            <TextBlock Foreground="White" FontSize="13" FontWeight="SemiBold">
                                <Run Text="프로그램별 진행사항"/>
                            </TextBlock>
                            <TextBlock Foreground="#B0FFFFFF" FontSize="11" Margin="0,2,0,0">
                                <Run Text="프로그램 선택:"/>
                                <Run Text="{Binding SelectedProgram.ProgramName, FallbackValue='선택하세요'}" FontWeight="SemiBold"/>
                            </TextBlock>
                        </StackPanel>
                        
                        <StackPanel Grid.Column="2" Orientation="Horizontal">
                            <Button Content="Assign: 전체"
                                    Style="{StaticResource SecondaryButton}"
                                    Foreground="White"
                                    Background="Transparent"
                                    BorderBrush="#80FFFFFF"
                                    Padding="8,4"
                                    FontSize="11"
                                    Margin="0,0,6,0"/>
                            <Button Content="새로고침"
                                    Command="{Binding RefreshCommand}"
                                    Style="{StaticResource SecondaryButton}"
                                    Foreground="White"
                                    Background="Transparent"
                                    BorderBrush="#80FFFFFF"
                                    Padding="8,4"
                                    FontSize="11"/>
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- 통계 요약 - 더블클릭으로 필터링 -->
                <Border Grid.Row="1" 
                        Background="{StaticResource BlueGray50Brush}"
                        Padding="12,6">
                    <StackPanel Orientation="Horizontal">
                        <Border x:Name="FilterAll" Background="{StaticResource PrimaryBrush}" CornerRadius="3" Padding="8,4" Margin="0,0,8,0" Cursor="Hand"
                                MouseLeftButtonDown="FilterBadge_MouseLeftButtonDown" Tag="all">
                            <TextBlock Foreground="White" FontSize="11">
                                <Run Text="전체"/>
                                <Run Text="{Binding TotalPropertyCount}" FontWeight="SemiBold"/>
                            </TextBlock>
                        </Border>
                        <Border x:Name="FilterPending" Background="{StaticResource WarningBrush}" CornerRadius="3" Padding="8,4" Margin="0,0,8,0" Cursor="Hand"
                                MouseLeftButtonDown="FilterBadge_MouseLeftButtonDown" Tag="pending">
                            <TextBlock Foreground="White" FontSize="11">
                                <Run Text="대기"/>
                                <Run Text="{Binding PendingCount}" FontWeight="SemiBold"/>
                            </TextBlock>
                        </Border>
                        <Border x:Name="FilterProcessing" Background="{StaticResource InfoBrush}" CornerRadius="3" Padding="8,4" Margin="0,0,8,0" Cursor="Hand"
                                MouseLeftButtonDown="FilterBadge_MouseLeftButtonDown" Tag="processing">
                            <TextBlock Foreground="White" FontSize="11">
                                <Run Text="진행"/>
                                <Run Text="{Binding ProcessingCount}" FontWeight="SemiBold"/>
                            </TextBlock>
                        </Border>
                        <Border x:Name="FilterCompleted" Background="{StaticResource SuccessBrush}" CornerRadius="3" Padding="8,4" Cursor="Hand"
                                MouseLeftButtonDown="FilterBadge_MouseLeftButtonDown" Tag="completed">
                            <TextBlock Foreground="White" FontSize="11">
                                <Run Text="완료"/>
                                <Run Text="{Binding CompletedCount}" FontWeight="SemiBold"/>
                            </TextBlock>
                        </Border>
                    </StackPanel>
                </Border>

                <!-- 물건 목록 -->
                <DataGrid Grid.Row="2"
                          x:Name="PropertiesDataGrid"
                          ItemsSource="{Binding Properties}"
                          AutoGenerateColumns="False"
                          CanUserAddRows="False"
                          SelectionMode="Single"
                          GridLinesVisibility="All"
                          HorizontalGridLinesBrush="{StaticResource TableBorderBrush}"
                          VerticalGridLinesBrush="{StaticResource TableBorderBrush}"
                          HeadersVisibility="Column"
                          Background="Transparent"
                          BorderThickness="0"
                          HorizontalScrollBarVisibility="Auto"
                          VerticalScrollBarVisibility="Auto">
                    
                    <DataGrid.Columns>
                        <!-- 차주번호 - 클릭시 비핵심으로 이동 -->
                        <DataGridTemplateColumn Header="차주번호" Width="80" IsReadOnly="True">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding PropertyNumber}"
                                               Padding="4,0"
                                               VerticalAlignment="Center"
                                               Foreground="{StaticResource PrimaryBrush}"
                                               FontWeight="SemiBold"
                                               FontSize="11"
                                               Cursor="Hand"
                                               MouseLeftButtonUp="PropertyNumber_Click"
                                               ToolTip="클릭하여 비핵심 화면으로 이동"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        
                        <!-- 차주명 - 클릭시 비핵심으로 이동 -->
                        <DataGridTemplateColumn Header="차주명" Width="80" IsReadOnly="True">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding DebtorName}"
                                               Padding="4,0"
                                               VerticalAlignment="Center"
                                               FontSize="11"
                                               Cursor="Hand"
                                               MouseLeftButtonUp="PropertyNumber_Click"
                                               ToolTip="클릭하여 비핵심 화면으로 이동"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        
                        <!-- Assign -->
                        <DataGridTemplateColumn Header="Assign" Width="90">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <ComboBox ItemsSource="{Binding DataContext.Evaluators, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                              DisplayMemberPath="Name"
                                              SelectedValuePath="Id"
                                              SelectedValue="{Binding AssignedTo, UpdateSourceTrigger=PropertyChanged}"
                                              SelectionChanged="AssignComboBox_SelectionChanged"
                                              Padding="2"
                                              BorderThickness="0"
                                              FontSize="10"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        
                        <!-- 담보번호 -->
                        <DataGridTextColumn Header="담보번호" 
                                          Binding="{Binding CollateralNumber}" 
                                          Width="80"
                                          IsReadOnly="True"
                                          FontSize="11"/>
                        
                        <!-- 담보종류 -->
                        <DataGridTextColumn Header="담보종류" 
                                          Binding="{Binding PropertyType}" 
                                          Width="60"
                                          IsReadOnly="True"
                                          FontSize="11"/>
                        
                        <!-- 약정서 (읽기전용 - 더블클릭시 해당 화면 이동) -->
                        <DataGridTemplateColumn Header="약정서" Width="42">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <CheckBox IsChecked="{Binding AgreementDoc, Mode=OneWay}"
                                              HorizontalAlignment="Center"
                                              IsHitTestVisible="False"
                                              Focusable="False"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        
                        <!-- 보증서 (읽기전용) -->
                        <DataGridTemplateColumn Header="보증서" Width="42">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <CheckBox IsChecked="{Binding GuaranteeDoc, Mode=OneWay}"
                                              HorizontalAlignment="Center"
                                              IsHitTestVisible="False"
                                              Focusable="False"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        
                        <!-- 경매개시 (읽기전용) -->
                        <DataGridTemplateColumn Header="경매개시" Width="55">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding AuctionStart1}"
                                               HorizontalAlignment="Center"
                                               VerticalAlignment="Center"
                                               FontSize="10"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        
                        <!-- 경매열람 (읽기전용) -->
                        <DataGridTemplateColumn Header="경매열람" Width="55">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <CheckBox IsChecked="{Binding AuctionDocs, Mode=OneWay}"
                                              HorizontalAlignment="Center"
                                              IsHitTestVisible="False"
                                              Focusable="False"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        
                        <!-- 전입열람 (읽기전용) -->
                        <DataGridTemplateColumn Header="전입열람" Width="55">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <CheckBox IsChecked="{Binding TenantDocs, Mode=OneWay}"
                                              HorizontalAlignment="Center"
                                              IsHitTestVisible="False"
                                              Focusable="False"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        
                        <!-- 선순위 (읽기전용) -->
                        <DataGridTemplateColumn Header="선순위" Width="45">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <CheckBox IsChecked="{Binding SeniorRightsReview, Mode=OneWay}"
                                              HorizontalAlignment="Center"
                                              IsHitTestVisible="False"
                                              Focusable="False"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        
                        <!-- 담보평가 (읽기전용) -->
                        <DataGridTemplateColumn Header="담보평가" Width="55">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <CheckBox IsChecked="{Binding AppraisalConfirmed, Mode=OneWay}"
                                              HorizontalAlignment="Center"
                                              IsHitTestVisible="False"
                                              Focusable="False"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        
                        <!-- 경(공)매일정 -->
                        <DataGridTemplateColumn Header="경(공)매일정" Width="80">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding AuctionScheduleDate, StringFormat=yyyy-MM-dd}"
                                               HorizontalAlignment="Center"
                                               VerticalAlignment="Center"
                                               FontSize="10"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        
                        <!-- QA -->
                        <DataGridTemplateColumn Header="QA" Width="35">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Border Background="{StaticResource ErrorBrush}"
                                            CornerRadius="8"
                                            Padding="4,1"
                                            HorizontalAlignment="Center"
                                            Visibility="{Binding QaUnansweredCount, Converter={StaticResource IntToVisibilityConverter}}">
                                        <TextBlock Text="{Binding QaUnansweredCount}"
                                                   Foreground="White"
                                                   FontSize="9"
                                                   FontWeight="Bold"/>
                                    </Border>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        
                        <!-- 권리분석 -->
                        <DataGridTemplateColumn Header="권리분석" Width="55">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Border CornerRadius="3" Padding="3,1" HorizontalAlignment="Center">
                                        <Border.Style>
                                            <Style TargetType="Border">
                                                <Setter Property="Background" Value="{StaticResource BlueGray100Brush}"/>
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding RightsAnalysisStatus}" Value="completed">
                                                        <Setter Property="Background" Value="{StaticResource SuccessBrush}"/>
                                                    </DataTrigger>
                                                    <DataTrigger Binding="{Binding RightsAnalysisStatus}" Value="processing">
                                                        <Setter Property="Background" Value="{StaticResource WarningBrush}"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Border.Style>
                                        <TextBlock FontSize="9" HorizontalAlignment="Center">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="Text" Value="대기"/>
                                                    <Setter Property="Foreground" Value="{StaticResource DeepNavy700Brush}"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RightsAnalysisStatus}" Value="completed">
                                                            <Setter Property="Text" Value="완료"/>
                                                            <Setter Property="Foreground" Value="White"/>
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding RightsAnalysisStatus}" Value="processing">
                                                            <Setter Property="Text" Value="진행"/>
                                                            <Setter Property="Foreground" Value="White"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                    </Border>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        
                        <!-- Interim -->
                        <DataGridTemplateColumn Header="Interim" Width="50">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <CheckBox IsChecked="{Binding InterimCompleted, Mode=OneWay}"
                                              HorizontalAlignment="Center"
                                              IsHitTestVisible="False"
                                              Focusable="False"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        
                        <!-- 진행사항 -->
                        <DataGridTemplateColumn Header="진행사항" Width="60">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Border CornerRadius="3" Padding="4,1" HorizontalAlignment="Center">
                                        <Border.Style>
                                            <Style TargetType="Border">
                                                <Setter Property="Background" Value="{StaticResource BlueGray100Brush}"/>
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding OverallStatus}" Value="completed">
                                                        <Setter Property="Background" Value="{StaticResource SuccessBrush}"/>
                                                    </DataTrigger>
                                                    <DataTrigger Binding="{Binding OverallStatus}" Value="processing">
                                                        <Setter Property="Background" Value="{StaticResource InfoBrush}"/>
                                                    </DataTrigger>
                                                    <DataTrigger Binding="{Binding OverallStatus}" Value="pending">
                                                        <Setter Property="Background" Value="{StaticResource WarningBrush}"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Border.Style>
                                        <TextBlock FontSize="9" HorizontalAlignment="Center">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="Text" Value="대기"/>
                                                    <Setter Property="Foreground" Value="White"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding OverallStatus}" Value="completed">
                                                            <Setter Property="Text" Value="완료"/>
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding OverallStatus}" Value="processing">
                                                            <Setter Property="Text" Value="진행"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                    </Border>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                    </DataGrid.Columns>

                    <DataGrid.RowStyle>
                        <Style TargetType="DataGridRow">
                            <Setter Property="Background" Value="Transparent"/>
                            <Setter Property="Height" Value="28"/>
                            <Setter Property="MinHeight" Value="24"/>
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="{StaticResource BlueGray50Brush}"/>
                                </Trigger>
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter Property="Background" Value="{StaticResource BlueGray100Brush}"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </DataGrid.RowStyle>

                    <DataGrid.ColumnHeaderStyle>
                        <Style TargetType="DataGridColumnHeader">
                            <Setter Property="Background" Value="{StaticResource BlueGray100Brush}"/>
                            <Setter Property="Foreground" Value="{StaticResource DeepNavy700Brush}"/>
                            <Setter Property="FontWeight" Value="SemiBold"/>
                            <Setter Property="FontSize" Value="10"/>
                            <Setter Property="Padding" Value="4,6"/>
                            <Setter Property="BorderThickness" Value="0,0,1,1"/>
                            <Setter Property="BorderBrush" Value="{StaticResource BlueGray200Brush}"/>
                            <Setter Property="HorizontalContentAlignment" Value="Center"/>
                        </Style>
                    </DataGrid.ColumnHeaderStyle>

                    <DataGrid.CellStyle>
                        <Style TargetType="DataGridCell">
                            <Setter Property="BorderThickness" Value="0,0,1,0"/>
                            <Setter Property="BorderBrush" Value="{StaticResource BlueGray100Brush}"/>
                            <Setter Property="Padding" Value="1"/>
                            <Setter Property="VerticalAlignment" Value="Center"/>
                            <Setter Property="FontSize" Value="11"/>
                            <Style.Triggers>
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter Property="Background" Value="Transparent"/>
                                    <Setter Property="Foreground" Value="{StaticResource DeepNavy700Brush}"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </DataGrid.CellStyle>
                </DataGrid>

                <!-- 물건 로딩 표시 -->
                <Grid Grid.Row="2"
                      Visibility="{Binding IsPropertiesLoading, Converter={StaticResource BooleanToVisibilityConverter}}"
                      Background="#80FFFFFF">
                    <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                        <ProgressBar IsIndeterminate="True" Width="150" Height="4"/>
                        <TextBlock Text="물건 목록 로딩 중..." Margin="0,8,0,0" FontSize="12" Opacity="0.7"/>
                    </StackPanel>
                </Grid>

                <!-- 프로그램 미선택 안내 -->
                <Grid Grid.Row="2"
                      Visibility="{Binding SelectedProgram, Converter={StaticResource NullToInverseVisibilityConverter}}"
                      Background="#F8FAFC">
                    <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                        <materialDesign:PackIcon Kind="FolderOpen" Width="64" Height="64" Foreground="#CBD5E1"/>
                        <TextBlock Text="좌측에서 프로그램을 선택해주세요" 
                                   FontSize="14" 
                                   Foreground="#94A3B8"
                                   Margin="0,16,0,0"/>
                    </StackPanel>
                </Grid>
            </Grid>
        </Border>

        <!-- 전체 로딩 오버레이 -->
        <Grid Grid.ColumnSpan="3"
              Visibility="{Binding IsLoading, Converter={StaticResource BooleanToVisibilityConverter}}"
              Background="#80000000">
            <Border Background="White" CornerRadius="8" Padding="32" 
                    VerticalAlignment="Center" HorizontalAlignment="Center">
                <StackPanel>
                    <ProgressBar IsIndeterminate="True" Width="200" Height="4"/>
                    <TextBlock Text="초기화 중..." Margin="0,16,0,0" HorizontalAlignment="Center"/>
                </StackPanel>
            </Border>
        </Grid>
    </Grid>
</UserControl>

