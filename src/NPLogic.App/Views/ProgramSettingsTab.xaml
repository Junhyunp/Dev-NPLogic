<UserControl x:Class="NPLogic.Views.ProgramSettingsTab"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:controls="clr-namespace:NPLogic.Controls;assembly=NPLogic.UI"
             xmlns:System="clr-namespace:System;assembly=mscorlib"
             mc:Ignorable="d" 
             d:DesignHeight="800" d:DesignWidth="1200">
    
    <UserControl.Resources>
        <Style x:Key="SettingCard" TargetType="Border">
            <Setter Property="Background" Value="{StaticResource BackgroundBrush}"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="20"/>
            <Setter Property="Margin" Value="0,0,0,16"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="Black" Opacity="0.1" BlurRadius="10" ShadowDepth="2"/>
                </Setter.Value>
            </Setter>
        </Style>
    </UserControl.Resources>

    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
        <Grid Margin="24">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            
            <!-- ========== í—¤ë” ========== -->
            <Grid Grid.Row="0" Margin="0,0,0,24">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <StackPanel Grid.Column="0">
                    <TextBlock Text="í”„ë¡œê·¸ëž¨ ê¸°ì´ˆë°ì´í„° ì„¤ì •" 
                               Style="{StaticResource H2TextStyle}"
                               Margin="0,0,0,8"/>
                    <TextBlock Text="ë²•ì›ë³„ ì •ë³´, ë²•ë¥ ì ìš©ë¥ , ìž„ëŒ€ì°¨ ê¸°ì¤€ ë“± í”„ë¡œê·¸ëž¨ ë ˆë²¨ì˜ ê¸°ì´ˆ ë°ì´í„°ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤."
                               Style="{StaticResource BodyTextStyle}"
                               Foreground="{StaticResource TextSecondaryBrush}"/>
                </StackPanel>
                <Button Grid.Column="1" 
                        Content="ðŸ”„ ìƒˆë¡œê³ ì¹¨" 
                        Command="{Binding RefreshCommand}" 
                        Style="{StaticResource SecondaryButton}"
                        Padding="16,8"/>
            </Grid>
            
            <!-- ========== 1. ë²•ì›ë³„ ì •ë³´ ì„¤ì • (C-001) ========== -->
            <Border Grid.Row="1" Style="{StaticResource SettingCard}">
                <controls:NPExpandableSection Header="ðŸ›ï¸ ë²•ì›ë³„ ì •ë³´ ì„¤ì •" IsExpanded="True">
                    <DataGrid ItemsSource="{Binding Courts}"
                              SelectedItem="{Binding SelectedCourt}"
                              AutoGenerateColumns="False"
                              CanUserAddRows="True"
                              HorizontalAlignment="Stretch"
                              MinHeight="150"
                              MaxHeight="250">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ë²•ì›ì½”ë“œ" Binding="{Binding CourtCode}" Width="100"/>
                            <DataGridTextColumn Header="ë²•ì›ëª…" Binding="{Binding CourtName}" Width="*" MinWidth="150"/>
                            <DataGridTextColumn Header="ì§€ì—­" Binding="{Binding Region}" Width="80"/>
                            <DataGridTextColumn Header="ê°ì•¡ìœ¨1" Binding="{Binding DiscountRate1, StringFormat=P0}" Width="80"/>
                            <DataGridTextColumn Header="ê°ì•¡ìœ¨2" Binding="{Binding DiscountRate2, StringFormat=P0}" Width="80"/>
                            <DataGridTextColumn Header="ê°ì•¡ìœ¨3" Binding="{Binding DiscountRate3, StringFormat=P0}" Width="80"/>
                            <DataGridTextColumn Header="ê°ì•¡ìœ¨4" Binding="{Binding DiscountRate4, StringFormat=P0}" Width="80"/>
                            <DataGridTemplateColumn Header="ìž‘ì—…" Width="70">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Button Content="ì €ìž¥" Command="{Binding DataContext.SaveCourtCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" Style="{StaticResource PrimaryButton}" Padding="8,2" FontSize="{StaticResource FontSizeSmall}"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </controls:NPExpandableSection>
            </Border>
            
            <!-- ========== 2. ë²•ë¥ ì ìš©ë¥  ì„¤ì • (C-002) ========== -->
            <Border Grid.Row="2" Style="{StaticResource SettingCard}">
                <controls:NPExpandableSection Header="âš–ï¸ ë²•ë¥ ì ìš©ë¥  ì„¤ì •" IsExpanded="True">
                    <DataGrid ItemsSource="{Binding LegalRates}"
                              SelectedItem="{Binding SelectedLegalRate}"
                              AutoGenerateColumns="False"
                              CanUserAddRows="True"
                              HorizontalAlignment="Stretch"
                              MinHeight="150"
                              MaxHeight="200">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ë¬¼ê±´ìœ í˜•" Binding="{Binding PropertyType}" Width="150"/>
                            <DataGridTextColumn Header="ë²•ë¥ ì ìš©ë¥ (%)" Binding="{Binding AppliedRate}" Width="130"/>
                            <DataGridTextColumn Header="ì„¤ëª…" Binding="{Binding Description}" Width="*" MinWidth="200"/>
                            <DataGridTemplateColumn Header="ìž‘ì—…" Width="70">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Button Content="ì €ìž¥" Command="{Binding DataContext.SaveLegalRateCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" Style="{StaticResource PrimaryButton}" Padding="8,2" FontSize="{StaticResource FontSizeSmall}"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </controls:NPExpandableSection>
            </Border>
            
            <!-- ========== 3 & 4. ìž„ëŒ€ì°¨ ê¸°ì¤€ (C-003, C-004) ========== -->
            <Border Grid.Row="3" Style="{StaticResource SettingCard}">
                <controls:NPExpandableSection Header="ðŸ  ìž„ëŒ€ì°¨ ê¸°ì¤€ ì„¤ì •" IsExpanded="True">
                    <DataGrid ItemsSource="{Binding LeaseStandards}"
                              SelectedItem="{Binding SelectedLeaseStandard}"
                              AutoGenerateColumns="False"
                              CanUserAddRows="True"
                              HorizontalAlignment="Stretch"
                              MinHeight="150"
                              MaxHeight="250">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ìœ í˜•" Binding="{Binding LeaseType}" Width="100"/>
                            <DataGridTextColumn Header="ì§€ì—­" Binding="{Binding Region}" Width="80"/>
                            <DataGridTextColumn Header="ì‹œìž‘ì¼" Binding="{Binding StartDate, StringFormat=yyyy-MM-dd}" Width="100"/>
                            <DataGridTextColumn Header="ì¢…ë£Œì¼" Binding="{Binding EndDate, StringFormat=yyyy-MM-dd}" Width="100"/>
                            <DataGridTextColumn Header="ë³´ì¦ê¸ˆë²”ìœ„" Binding="{Binding DepositLimit, StringFormat=N0}" Width="*" MinWidth="120"/>
                            <DataGridTextColumn Header="ë³€ì œê¸ˆì•¡" Binding="{Binding CompensationAmount, StringFormat=N0}" Width="*" MinWidth="120"/>
                            <DataGridTemplateColumn Header="ìž‘ì—…" Width="70">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Button Content="ì €ìž¥" Command="{Binding DataContext.SaveLeaseStandardCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" Style="{StaticResource PrimaryButton}" Padding="8,2" FontSize="{StaticResource FontSizeSmall}"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </controls:NPExpandableSection>
            </Border>
            
            <!-- ========== 5. ê²½ë§¤ë¹„ìš© ì‚°ì • ë°ì´í„° (C-005) ========== -->
            <Border Grid.Row="4" Style="{StaticResource SettingCard}">
                <controls:NPExpandableSection Header="ðŸ’° ê²½ë§¤ë¹„ìš© ì‚°ì • ë°ì´í„°" IsExpanded="True">
                    <DataGrid ItemsSource="{Binding AuctionCostStandards}"
                              SelectedItem="{Binding SelectedAuctionCostStandard}"
                              AutoGenerateColumns="False"
                              CanUserAddRows="True"
                              HorizontalAlignment="Stretch"
                              MinHeight="150"
                              MaxHeight="200">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="í•­ëª©ëª…" Binding="{Binding CostType}" Width="150"/>
                            <DataGridTextColumn Header="ê³„ì‚°ë°©ì‹" Binding="{Binding CalculationMethod}" Width="100"/>
                            <DataGridTextColumn Header="ê¸°ë³¸ê¸ˆì•¡" Binding="{Binding BaseAmount, StringFormat=N0}" Width="130"/>
                            <DataGridTextColumn Header="ìš”ìœ¨(%)" Binding="{Binding Rate}" Width="80"/>
                            <DataGridTextColumn Header="ì„¤ëª…" Binding="{Binding Description}" Width="*" MinWidth="200"/>
                            <DataGridTemplateColumn Header="ìž‘ì—…" Width="70">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Button Content="ì €ìž¥" Command="{Binding DataContext.SaveAuctionCostStandardCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" Style="{StaticResource PrimaryButton}" Padding="8,2" FontSize="{StaticResource FontSizeSmall}"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </controls:NPExpandableSection>
            </Border>
            
            <!-- ========== 6. ê³µë§¤ë¹„ìš© ì‚°ì • ë°ì´í„° (C-006) ========== -->
            <Border Grid.Row="5" Style="{StaticResource SettingCard}">
                <controls:NPExpandableSection Header="ðŸ·ï¸ ê³µë§¤ë¹„ìš© ì‚°ì • ë°ì´í„°" IsExpanded="True">
                    <DataGrid ItemsSource="{Binding PublicSaleCostStandards}"
                              SelectedItem="{Binding SelectedPublicSaleCostStandard}"
                              AutoGenerateColumns="False"
                              CanUserAddRows="True"
                              HorizontalAlignment="Stretch"
                              MinHeight="150"
                              MaxHeight="200">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="í•­ëª©ëª…" Binding="{Binding CostType}" Width="150"/>
                            <DataGridTextColumn Header="ê³„ì‚°ë°©ì‹" Binding="{Binding CalculationMethod}" Width="100"/>
                            <DataGridTextColumn Header="ê¸°ë³¸ê¸ˆì•¡" Binding="{Binding BaseAmount, StringFormat=N0}" Width="130"/>
                            <DataGridTextColumn Header="ìš”ìœ¨(%)" Binding="{Binding Rate}" Width="80"/>
                            <DataGridTextColumn Header="ì„¤ëª…" Binding="{Binding Description}" Width="*" MinWidth="200"/>
                            <DataGridTemplateColumn Header="ìž‘ì—…" Width="70">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Button Content="ì €ìž¥" Command="{Binding DataContext.SavePublicSaleCostStandardCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" Style="{StaticResource PrimaryButton}" Padding="8,2" FontSize="{StaticResource FontSizeSmall}"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </controls:NPExpandableSection>
            </Border>
        </Grid>
    </ScrollViewer>
</UserControl>
