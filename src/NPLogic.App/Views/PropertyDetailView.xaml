<UserControl x:Class="NPLogic.Views.PropertyDetailView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:NPLogic.Views"
             xmlns:vm="clr-namespace:NPLogic.ViewModels"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             mc:Ignorable="d" 
             d:DesignHeight="800" d:DesignWidth="1400"
             d:DataContext="{d:DesignInstance Type=vm:PropertyDetailViewModel}"
             Loaded="PropertyDetailView_Loaded">
    
    <Grid Margin="32">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- í—¤ë” ì˜ì—­ -->
        <Grid Grid.Row="0" Margin="0,0,0,24">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- ë’¤ë¡œê°€ê¸° ë²„íŠ¼ -->
            <Button Grid.Column="0"
                    Content="â† ëª©ë¡ìœ¼ë¡œ"
                    Command="{Binding GoBackCommand}"
                    Style="{StaticResource SecondaryButton}"
                    Padding="12,6"
                    FontSize="{StaticResource FontSizeBody}"
                    Margin="0,0,16,0"/>

            <!-- N-002: ë¬¼ê±´ íƒìƒ‰ UI -->
            <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,16,0">
                <Button Command="{Binding NavigatePreviousCommand}"
                        IsEnabled="{Binding CanNavigatePrevious}"
                        Style="{StaticResource SecondaryButton}"
                        Padding="8,4"
                        ToolTip="ì´ì „ ë¬¼ê±´ (Ctrl+â†)">
                    <TextBlock Text="â—€" FontSize="{StaticResource FontSizeTiny}"/>
                </Button>
                
                <Border Background="{StaticResource SurfaceColor}" 
                        CornerRadius="4" 
                        Padding="12,4" 
                        Margin="4,0"
                        ToolTip="í˜„ìž¬ ë¬¼ê±´ ìœ„ì¹˜ (Ctrl+â†‘: ì²«ë²ˆì§¸, Ctrl+â†“: ë§ˆì§€ë§‰)">
                    <TextBlock Text="{Binding NavigationInfo}" 
                               FontSize="{StaticResource FontSizeSmall}"
                               FontWeight="SemiBold"
                               Foreground="{StaticResource TextSecondaryBrush}"/>
                </Border>
                
                <Button Command="{Binding NavigateNextCommand}"
                        IsEnabled="{Binding CanNavigateNext}"
                        Style="{StaticResource SecondaryButton}"
                        Padding="8,4"
                        ToolTip="ë‹¤ìŒ ë¬¼ê±´ (Ctrl+â†’)">
                    <TextBlock Text="â–¶" FontSize="{StaticResource FontSizeTiny}"/>
                </Button>
            </StackPanel>

            <!-- ì œëª© -->
            <StackPanel Grid.Column="2" VerticalAlignment="Center">
                <TextBlock Text="ë¬¼ê±´ ìƒì„¸" 
                           Style="{StaticResource H2TextStyle}"
                           Margin="0,0,0,4"/>
                <TextBlock Style="{StaticResource BodyTextStyle}"
                           Opacity="0.7">
                    <Run Text="ë¬¼ê±´ë²ˆí˜¸:"/>
                    <Run Text="{Binding Property.PropertyNumber}" FontWeight="SemiBold"/>
                    <Run Text=" | "/>
                    <Run Text="{Binding Property.AddressFull}"/>
                </TextBlock>
            </StackPanel>

            <!-- ì•¡ì…˜ ë²„íŠ¼ë“¤ - í”¼ë“œë°± ë°˜ì˜: í¬ê¸° ì¶•ì†Œ, ë˜ëŒë¦¬ê¸° ì¶”ê°€ -->
            <StackPanel Grid.Column="3" Orientation="Horizontal">
                <Button Command="{Binding SaveCommand}"
                        Style="{StaticResource PrimaryButton}"
                        Padding="12,6"
                        Margin="0,0,8,0"
                        ToolTip="ë³€ê²½ì‚¬í•­ ì €ìž¥ (Ctrl+S)">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="ðŸ’¾" FontSize="{StaticResource FontSizeBody}" VerticalAlignment="Center" Margin="0,0,4,0"/>
                        <TextBlock Text="ì €ìž¥" VerticalAlignment="Center" FontSize="{StaticResource FontSizeBody}"/>
                    </StackPanel>
                </Button>
                <!-- ë˜ëŒë¦¬ê¸° ë²„íŠ¼ (í”¼ë“œë°± ë°˜ì˜: ìžë™ì €ìž¥ + ë˜ëŒë¦¬ê¸°) -->
                <Button Command="{Binding UndoCommand}"
                        Style="{StaticResource SecondaryButton}"
                        Padding="12,6"
                        Margin="0,0,8,0"
                        IsEnabled="{Binding CanUndo}"
                        ToolTip="ì´ì „ ìƒíƒœë¡œ ë˜ëŒë¦¬ê¸° (ìµœëŒ€ 3ë‹¨ê³„)">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="â†©" FontSize="{StaticResource FontSizeBody}" VerticalAlignment="Center" Margin="0,0,4,0"/>
                        <TextBlock Text="ë˜ëŒë¦¬ê¸°" VerticalAlignment="Center" FontSize="{StaticResource FontSizeBody}"/>
                        <TextBlock Text="{Binding UndoCount, StringFormat=({0})}" 
                                   VerticalAlignment="Center" 
                                   FontSize="{StaticResource FontSizeTiny}" 
                                   Margin="4,0,0,0"
                                   Opacity="0.7"/>
                    </StackPanel>
                </Button>
                <Button Command="{Binding RefreshCommand}"
                        Style="{StaticResource SecondaryButton}"
                        Padding="12,6"
                        ToolTip="ë°ì´í„°ë¥¼ ì„œë²„ì—ì„œ ë‹¤ì‹œ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤ (Ctrl+R)">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="ðŸ”„" FontSize="{StaticResource FontSizeBody}" VerticalAlignment="Center" Margin="0,0,4,0"/>
                        <TextBlock Text="ìƒˆë¡œê³ ì¹¨" VerticalAlignment="Center" FontSize="{StaticResource FontSizeBody}"/>
                    </StackPanel>
                </Button>
            </StackPanel>
        </Grid>

        <!-- íƒ­ ì»¨íŠ¸ë¡¤ -->
        <TabControl Grid.Row="1"
                    SelectedIndex="{Binding SelectedTabIndex}"
                    Background="Transparent"
                    BorderThickness="0"
                    ClipToBounds="True">
            
            <!-- íƒ­ ìŠ¤íƒ€ì¼ -->
            <TabControl.Resources>
                <Style TargetType="TabItem">
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="TabItem">
                                <Border Name="Border" 
                                        Background="Transparent"
                                        BorderThickness="0,0,0,2"
                                        BorderBrush="Transparent"
                                        Padding="20,12"
                                        Margin="0,0,4,0">
                                    <ContentPresenter ContentSource="Header"
                                                     VerticalAlignment="Center"
                                                     HorizontalAlignment="Center"/>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsSelected" Value="True">
                                        <Setter TargetName="Border" Property="BorderBrush" Value="{StaticResource PrimaryBrush}"/>
                                        <Setter Property="Foreground" Value="{StaticResource PrimaryBrush}"/>
                                    </Trigger>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter TargetName="Border" Property="Background" Value="{StaticResource BlueGray50Brush}"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                    <Setter Property="FontSize" Value="{StaticResource FontSizeH4}"/>
                    <Setter Property="FontWeight" Value="SemiBold"/>
                    <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
                </Style>
            </TabControl.Resources>

            <!-- í”¼ë“œë°± ë°˜ì˜: íƒ­ êµ¬ì¡° ë³€ê²½ (S-002) -->
            <!-- í•˜ë‹¨ íƒ­: ì°¨ì£¼ê°œìš”, ë¡ , ë‹´ë³´ë¬¼ê±´, ì„ ìˆœìœ„, í‰ê°€, ê²½ê³µë§¤ì¼ì • -->
            <!-- í˜„ê¸ˆíë¦„ì€ ìƒë‹¨ ë©”ë‰´ë¡œ ì´ë™ ì˜ˆì • -->
            
            <!-- 1. ì°¨ì£¼ê°œìš” íƒ­ -->
            <TabItem Header="ì°¨ì£¼ê°œìš”">
                <local:HomeTab DataContext="{Binding}"/>
            </TabItem>

            <!-- 2. ë¡  íƒ­ -->
            <TabItem Header="ë¡ ">
                <local:LoanDetailView DataContext="{Binding}"/>
            </TabItem>

            <!-- 3. ë‹´ë³´ë¬¼ê±´ íƒ­ -->
            <TabItem Header="ë‹´ë³´ë¬¼ê±´">
                <local:BasicDataTab DataContext="{Binding}"/>
            </TabItem>

            <!-- 4. ì„ ìˆœìœ„ íƒ­ -->
            <TabItem Header="ì„ ìˆœìœ„">
                <local:SeniorRightsView DataContext="{Binding}"/>
            </TabItem>

            <!-- 5. í‰ê°€ íƒ­ -->
            <TabItem Header="í‰ê°€">
                <local:EvaluationTab DataContext="{Binding EvaluationViewModel}"/>
            </TabItem>

            <!-- 6. ê²½ê³µë§¤ì¼ì • íƒ­ -->
            <TabItem Header="ê²½ê³µë§¤ì¼ì •">
                <local:AuctionScheduleDetailView DataContext="{Binding AuctionScheduleDetailViewModel}"/>
            </TabItem>
        </TabControl>
    </Grid>
</UserControl>

