<UserControl x:Class="NPLogic.Views.EvaluationTab"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:NPLogic.Views"
             xmlns:evalViews="clr-namespace:NPLogic.Views.Evaluation"
             xmlns:vm="clr-namespace:NPLogic.ViewModels"
             mc:Ignorable="d" 
             d:DesignHeight="900" d:DesignWidth="1400"
             d:DataContext="{d:DesignInstance Type=vm:EvaluationTabViewModel}">

    <UserControl.Resources>
        <!-- í”¼ë“œë°± ë°˜ì˜: ê³µí†µ ìŠ¤íƒ€ì¼ ì°¸ì¡°ë¡œ í†µì¼ -->
        <!-- SectionHeader, LabelText, ValueText, AmountText, CardBorder ìŠ¤íƒ€ì¼ì€ Typography.xamlì—ì„œ ì°¸ì¡° -->
        
        <!-- ë¡œì»¬ ë³„ì¹­ (í•˜ìœ„ í˜¸í™˜ì„±) -->
        <Style x:Key="SectionHeaderStyle" TargetType="TextBlock" BasedOn="{StaticResource SectionHeader}">
            <Setter Property="FontSize" Value="{StaticResource FontSizeH4}"/>
        </Style>
        <Style x:Key="LabelStyle" TargetType="TextBlock" BasedOn="{StaticResource LabelText}"/>
        <Style x:Key="ValueStyle" TargetType="TextBlock" BasedOn="{StaticResource ValueText}"/>
        <Style x:Key="AmountStyle" TargetType="TextBlock" BasedOn="{StaticResource AmountText}"/>
        <Style x:Key="CardStyle" TargetType="Border" BasedOn="{StaticResource CardBorder}">
            <Setter Property="Padding" Value="16"/>
        </Style>
    </UserControl.Resources>

    <ScrollViewer VerticalScrollBarVisibility="Auto"
                  HorizontalScrollBarVisibility="Disabled"
                  Padding="12,8,12,12">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- ë¡œë”© ì˜¤ë²„ë ˆì´ -->
            <Border Grid.RowSpan="2" 
                    Background="{StaticResource OverlaySemiLightBrush}" 
                    Visibility="{Binding IsLoading, Converter={StaticResource BoolToVisibilityConverter}}"
                    Panel.ZIndex="100">
                <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                    <ProgressBar IsIndeterminate="True" Width="200" Height="4"/>
                    <TextBlock Text="ë¡œë”© ì¤‘..." Margin="0,12,0,0" 
                               HorizontalAlignment="Center"
                               Style="{StaticResource BodyTextStyle}"/>
                </StackPanel>
            </Border>

            <!-- í—¤ë”: í‰ê°€ ìœ í˜• ì„ íƒ -->
            <Border Grid.Row="0" Style="{StaticResource CardStyle}">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Column="0" Orientation="Horizontal">
                        <TextBlock Text="ðŸ“Š í‰ê°€ ìœ í˜• ì„ íƒ" 
                                   Style="{StaticResource SectionHeaderStyle}"
                                   Margin="0"/>
                    </StackPanel>

                    <!-- í‰ê°€ ìœ í˜• ë¼ë””ì˜¤ ë²„íŠ¼ -->
                    <StackPanel Grid.Column="1" Orientation="Horizontal" 
                                Margin="32,0,0,0"
                                VerticalAlignment="Center">
                        <RadioButton Content="1. ì•„íŒŒíŠ¸" 
                                     IsChecked="{Binding IsApartmentType}"
                                     GroupName="EvaluationType"
                                     Margin="0,0,24,0"
                                     FontSize="{StaticResource FontSizeBody}"/>
                        <RadioButton Content="2. ì—°ë¦½ë‹¤ì„¸ëŒ€" 
                                     IsChecked="{Binding IsMultiFamilyType}"
                                     GroupName="EvaluationType"
                                     Margin="0,0,24,0"
                                     FontSize="{StaticResource FontSizeBody}"/>
                        <RadioButton Content="3. ê³µìž¥/ì°½ê³ " 
                                     IsChecked="{Binding IsFactoryType}"
                                     GroupName="EvaluationType"
                                     Margin="0,0,24,0"
                                     FontSize="{StaticResource FontSizeBody}"/>
                        <RadioButton Content="4. ìƒê°€/ì•„íŒŒíŠ¸í˜•ê³µìž¥" 
                                     IsChecked="{Binding IsCommercialType}"
                                     GroupName="EvaluationType"
                                     Margin="0,0,24,0"
                                     FontSize="{StaticResource FontSizeBody}"/>
                        <RadioButton Content="5. ì£¼íƒ/ê·¼ë¦°ì‹œì„¤/í† ì§€/ê¸°íƒ€" 
                                     IsChecked="{Binding IsHouseLandType}"
                                     GroupName="EvaluationType"
                                     FontSize="{StaticResource FontSizeBody}"/>
                    </StackPanel>

                    <!-- í”¼ë“œë°± ë°˜ì˜: íƒ­ ë‚´ë¶€ ì €ìž¥/ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼ ì œê±° â†’ ìƒë‹¨ í—¤ë”ì—ì„œë§Œ ì €ìž¥ -->
                    <!-- ì €ìž¥ì€ PropertyDetailView í—¤ë”ì˜ ë²„íŠ¼ ì‚¬ìš© -->
                </Grid>
            </Border>

            <!-- ë©”ì¸ ì½˜í…ì¸  (í”¼ë“œë°± ë°˜ì˜: 6:4 ë¹„ìœ¨) -->
            <Grid Grid.Row="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="6*"/>
                    <ColumnDefinition Width="16"/>
                    <ColumnDefinition Width="4*"/>
                </Grid.ColumnDefinitions>

                <!-- ì¢Œì¸¡: ì‚¬ë¡€ì§€ë„ + ì‚¬ë¡€í‰ê°€ -->
                <StackPanel Grid.Column="0">
                    
                    <!-- ì‚¬ë¡€ì§€ë„ ì˜ì—­ -->
                    <Border Style="{StaticResource CardStyle}">
                        <StackPanel>
                            <Grid Margin="0,0,0,12">
                                <TextBlock Text="ðŸ—ºï¸ ì‚¬ë¡€ì§€ë„" Style="{StaticResource SectionHeaderStyle}" Margin="0"/>
                                <Button Content="ê°€ì ¸ì˜¤ê¸°" 
                                        Command="{Binding LoadCaseMapCommand}"
                                        Style="{StaticResource SecondaryButton}"
                                        Padding="12,4"
                                        FontSize="{StaticResource FontSizeBody}"
                                        HorizontalAlignment="Right"/>
                            </Grid>
                            
                            <!-- ì§€ë„ í”Œë ˆì´ìŠ¤í™€ë” (E-001: í´ë¦­ ì‹œ íŒì—… í™•ëŒ€) -->
                            <Border Background="{StaticResource BlueGray50Brush}" 
                                    CornerRadius="4"
                                    Height="200"
                                    Cursor="Hand"
                                    MouseLeftButtonUp="MapPlaceholder_MouseLeftButtonUp"
                                    ToolTip="í´ë¦­í•˜ì—¬ í™•ëŒ€">
                                <Grid>
                                    <TextBlock Text="ì†Œìž¬ì§€ ê¸°ì¤€ìœ¼ë¡œ ìœ„ì¹˜, ë³¸ê±´ê¸°ì¤€ê±°ëž˜ ìžë™ ì‚°ì • ë° í‘œì‹œ"
                                               Style="{StaticResource BodyTextStyle}"
                                               Opacity="0.6"
                                               HorizontalAlignment="Center"
                                               VerticalAlignment="Center"/>
                                    <TextBlock Text="ðŸ” í´ë¦­í•˜ì—¬ í™•ëŒ€"
                                               Style="{StaticResource BodyTextStyle}"
                                               FontSize="{StaticResource FontSizeSmall}"
                                               Opacity="0.5"
                                               HorizontalAlignment="Right"
                                               VerticalAlignment="Bottom"
                                               Margin="0,0,8,8"/>
                                </Grid>
                            </Border>
                        </StackPanel>
                    </Border>

                    <!-- ìœ ì‚¬ë¬¼ê±´ ì¶”ì²œ ì˜ì—­ -->
                    <Border Style="{StaticResource CardStyle}">
                        <StackPanel>
                            <!-- ì œëª© -->
                            <TextBlock Text="ðŸŽ¯ ìœ ì‚¬ë¬¼ê±´ ì¶”ì²œ" Style="{StaticResource SectionHeaderStyle}" Margin="0,0,0,12"/>
                            
                            <!-- ë²„íŠ¼ í–‰ (í”¼ë“œë°± ë°˜ì˜: ê·œì¹™/ë²”ìœ„ ì„ íƒ ì‚­ì œ, ì „ì²´ë§Œ ì‚¬ìš©) -->
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                <Button Content="ì¶”ì²œ ê²€ìƒ‰" 
                                        Command="{Binding RecommendSimilarCasesCommand}"
                                        Style="{StaticResource PrimaryButton}"
                                        Padding="12,4"
                                        FontSize="{StaticResource FontSizeBody}"
                                        Margin="0,0,8,0"/>
                                <Button Content="ì‚¬ë¡€ ì ìš©" 
                                        Command="{Binding ApplyRecommendedCaseCommand}"
                                        Style="{StaticResource SecondaryButton}"
                                        Padding="12,4"
                                        FontSize="{StaticResource FontSizeBody}"
                                        Margin="0,0,16,0"/>
                                <!-- ë¡œë”© í‘œì‹œ -->
                                <ProgressBar IsIndeterminate="True" 
                                             Width="80" Height="4" 
                                             VerticalAlignment="Center"
                                             Visibility="{Binding IsRecommendLoading, Converter={StaticResource BoolToVisibilityConverter}, FallbackValue=Collapsed}"/>
                            </StackPanel>
                            
                            <!-- ìƒíƒœ ë©”ì‹œì§€ -->
                            <TextBlock Text="{Binding RecommendStatusMessage}" 
                                       Style="{StaticResource LabelStyle}"
                                       Margin="0,0,0,8"
                                       Visibility="{Binding RecommendStatusMessage, Converter={StaticResource NullToVisibilityConverter}}"/>
                            
                            <!-- ì¶”ì²œ ê²°ê³¼ í…Œì´ë¸” -->
                            <DataGrid ItemsSource="{Binding RecommendedCases}"
                                      SelectedItem="{Binding SelectedRecommendCase, Mode=TwoWay}"
                                      AutoGenerateColumns="False"
                                      CanUserAddRows="False"
                                      CanUserDeleteRows="False"
                                      HeadersVisibility="Column"
                                      GridLinesVisibility="All"
                                      BorderThickness="1"
                                      BorderBrush="{StaticResource BlueGray200Brush}"
                                      MaxHeight="350"
                                      MinHeight="200"
                                      FontSize="{StaticResource FontSizeSmall}"
                                      SelectionMode="Single">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="ì‚¬ê±´ë²ˆí˜¸" Binding="{Binding CaseNo}" Width="110" IsReadOnly="True"/>
                                    <DataGridTextColumn Header="ë‚™ì°°ì¼" Binding="{Binding AuctionDate, StringFormat=yyyy-MM-dd}" Width="85" IsReadOnly="True"/>
                                    <DataGridTextColumn Header="ìš©ë„" Binding="{Binding Usage}" Width="70" IsReadOnly="True"/>
                                    <DataGridTextColumn Header="ê°ì •ê°€" Binding="{Binding AppraisalPrice, StringFormat=N0}" Width="100" IsReadOnly="True"/>
                                    <DataGridTextColumn Header="ë‚™ì°°ê°€" Binding="{Binding WinningPrice, StringFormat=N0}" Width="100" IsReadOnly="True"/>
                                    <DataGridTextColumn Header="ë‚™ì°°ìœ¨" Binding="{Binding WinningRateDisplay}" Width="60" IsReadOnly="True">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="FontWeight" Value="SemiBold"/>
                                                <Setter Property="Foreground" Value="{StaticResource PrimaryBrush}"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Header="ê±´ë¬¼ë©´ì " Binding="{Binding BuildingArea, StringFormat=N1}" Width="70" IsReadOnly="True"/>
                                    <DataGridTextColumn Header="ê·œì¹™" Binding="{Binding RuleName}" Width="55" IsReadOnly="True"/>
                                    <!-- E-005: ê±°ë¦¬ ì»¬ëŸ¼ ì¶”ê°€ -->
                                    <DataGridTextColumn Header="ê±°ë¦¬" Binding="{Binding DistanceDisplay}" Width="60" IsReadOnly="True">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <!-- ìƒì„¸ë³´ê¸° ë²„íŠ¼ -->
                                    <DataGridTemplateColumn Header="ìƒì„¸" Width="50">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <Button Content="ðŸ“‹"
                                                        Command="{Binding DataContext.ShowCaseDetailCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                        CommandParameter="{Binding}"
                                                        Style="{StaticResource SecondaryButton}"
                                                        Padding="4,2"
                                                        FontSize="{StaticResource FontSizeBody}"
                                                        ToolTip="ìƒì„¸ë³´ê¸°"
                                                        Cursor="Hand"/>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                            
                            <!-- íŽ˜ì´ì§€ë„¤ì´ì…˜ (í”¼ë“œë°± ë°˜ì˜: 5ê°œì”© ë³´ì—¬ì£¼ê¸°) -->
                            <Grid Margin="0,8,0,0">
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                                    <TextBlock Text="í‘œì‹œ: " Style="{StaticResource LabelStyle}" VerticalAlignment="Center"/>
                                    <TextBlock Text="{Binding DisplayedCasesCount}" Style="{StaticResource ValueStyle}" VerticalAlignment="Center"/>
                                    <TextBlock Text=" / " Style="{StaticResource LabelStyle}" VerticalAlignment="Center"/>
                                    <TextBlock Text="{Binding TotalCasesCount}" Style="{StaticResource ValueStyle}" VerticalAlignment="Center"/>
                                    <TextBlock Text=" ê±´" Style="{StaticResource LabelStyle}" VerticalAlignment="Center"/>
                                </StackPanel>
                                <Button Content="ë”ë³´ê¸° (+5)" 
                                        Command="{Binding LoadMoreCasesCommand}"
                                        Style="{StaticResource SecondaryButton}"
                                        Padding="12,4"
                                        FontSize="{StaticResource FontSizeBody}"
                                        HorizontalAlignment="Right"
                                        Visibility="{Binding HasMoreCases, Converter={StaticResource BoolToVisibilityConverter}, FallbackValue=Collapsed}"/>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- ì‚¬ë¡€í‰ê°€ ê·¸ë¦¬ë“œ -->
                    <Border Style="{StaticResource CardStyle}">
                        <StackPanel>
                            <Grid Margin="0,0,0,12">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="ðŸ“‹ ì‚¬ë¡€í‰ê°€" Style="{StaticResource SectionHeaderStyle}" Margin="0"/>
                                    <TextBlock Text="(ì§ì ‘ ìž…ë ¥ ê°€ëŠ¥)" 
                                               Style="{StaticResource LabelStyle}"
                                               FontSize="{StaticResource FontSizeSmall}"
                                               Opacity="0.7"
                                               Margin="8,0,0,0"
                                               VerticalAlignment="Center"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                    <Button Content="ì´ˆê¸°í™”" 
                                            Command="{Binding ClearCaseEvaluationCommand}"
                                            Style="{StaticResource SecondaryButton}"
                                            Padding="12,4"
                                            FontSize="{StaticResource FontSizeBody}"
                                            Margin="0,0,8,0"/>
                                    <Button Content="ê²½ë§¤ì‚¬ê±´ê²€ìƒ‰" 
                                            Command="{Binding SearchAuctionCaseCommand}"
                                            Style="{StaticResource SecondaryButton}"
                                            Padding="12,4"
                                            FontSize="{StaticResource FontSizeBody}"/>
                                </StackPanel>
                            </Grid>
                            
                            <!-- ì‚¬ë¡€í‰ê°€ í…Œì´ë¸” (í”¼ë“œë°± ë°˜ì˜: ì—‘ì…€ ê¸°ì¤€ êµ¬ì¡°, ì •ë ¬ ë§žì¶”ê¸°) -->
                            <DataGrid ItemsSource="{Binding CaseItems}"
                                      AutoGenerateColumns="False"
                                      CanUserAddRows="False"
                                      CanUserDeleteRows="False"
                                      HeadersVisibility="Column"
                                      GridLinesVisibility="All"
                                      BorderThickness="1"
                                      BorderBrush="{StaticResource BlueGray200Brush}"
                                      MaxHeight="500"
                                      FontSize="{StaticResource FontSizeSmall}"
                                      SelectionUnit="Cell"
                                      HorizontalScrollBarVisibility="Auto">
                                <DataGrid.ColumnHeaderStyle>
                                    <Style TargetType="DataGridColumnHeader">
                                        <Setter Property="Background" Value="{StaticResource BlueGray100Brush}"/>
                                        <Setter Property="Padding" Value="8,6"/>
                                        <Setter Property="FontWeight" Value="SemiBold"/>
                                        <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                        <Setter Property="BorderBrush" Value="{StaticResource BlueGray200Brush}"/>
                                        <Setter Property="BorderThickness" Value="0,0,1,1"/>
                                    </Style>
                                </DataGrid.ColumnHeaderStyle>
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="êµ¬ë¶„" Binding="{Binding Label}" Width="120" IsReadOnly="True">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Background" Value="{StaticResource BlueGray50Brush}"/>
                                                <Setter Property="Padding" Value="8,4"/>
                                                <Setter Property="FontWeight" Value="SemiBold"/>
                                                <Setter Property="VerticalAlignment" Value="Center"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Header="ë³¸ê±´ ê°ì •ê°€" Binding="{Binding BaseValue, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="100">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Padding" Value="6,4"/>
                                                <Setter Property="TextAlignment" Value="Right"/>
                                                <Setter Property="VerticalAlignment" Value="Center"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                        <DataGridTextColumn.EditingElementStyle>
                                            <Style TargetType="TextBox">
                                                <Setter Property="Padding" Value="4,2"/>
                                                <Setter Property="TextAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.EditingElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Header="ì‚¬ë¡€1" Binding="{Binding Case1Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="100">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Padding" Value="6,4"/>
                                                <Setter Property="TextAlignment" Value="Right"/>
                                                <Setter Property="VerticalAlignment" Value="Center"/>
                                                <Setter Property="Background" Value="#F3E8FF"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                        <DataGridTextColumn.EditingElementStyle>
                                            <Style TargetType="TextBox">
                                                <Setter Property="Padding" Value="4,2"/>
                                                <Setter Property="TextAlignment" Value="Right"/>
                                                <Setter Property="Background" Value="#F3E8FF"/>
                                            </Style>
                                        </DataGridTextColumn.EditingElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Header="ì‚¬ë¡€2" Binding="{Binding Case2Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="100">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Padding" Value="6,4"/>
                                                <Setter Property="TextAlignment" Value="Right"/>
                                                <Setter Property="VerticalAlignment" Value="Center"/>
                                                <Setter Property="Background" Value="#F3E8FF"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                        <DataGridTextColumn.EditingElementStyle>
                                            <Style TargetType="TextBox">
                                                <Setter Property="Padding" Value="4,2"/>
                                                <Setter Property="TextAlignment" Value="Right"/>
                                                <Setter Property="Background" Value="#F3E8FF"/>
                                            </Style>
                                        </DataGridTextColumn.EditingElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Header="ì‚¬ë¡€3" Binding="{Binding Case3Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="100">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Padding" Value="6,4"/>
                                                <Setter Property="TextAlignment" Value="Right"/>
                                                <Setter Property="VerticalAlignment" Value="Center"/>
                                                <Setter Property="Background" Value="#F3E8FF"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                        <DataGridTextColumn.EditingElementStyle>
                                            <Style TargetType="TextBox">
                                                <Setter Property="Padding" Value="4,2"/>
                                                <Setter Property="TextAlignment" Value="Right"/>
                                                <Setter Property="Background" Value="#F3E8FF"/>
                                            </Style>
                                        </DataGridTextColumn.EditingElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Header="ì‚¬ë¡€4" Binding="{Binding Case4Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="100">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Padding" Value="6,4"/>
                                                <Setter Property="TextAlignment" Value="Right"/>
                                                <Setter Property="VerticalAlignment" Value="Center"/>
                                                <Setter Property="Background" Value="#F3E8FF"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                        <DataGridTextColumn.EditingElementStyle>
                                            <Style TargetType="TextBox">
                                                <Setter Property="Padding" Value="4,2"/>
                                                <Setter Property="TextAlignment" Value="Right"/>
                                                <Setter Property="Background" Value="#F3E8FF"/>
                                            </Style>
                                        </DataGridTextColumn.EditingElementStyle>
                                    </DataGridTextColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </StackPanel>
                    </Border>
                </StackPanel>

                <!-- ìš°ì¸¡: ì‹¤ê±°ëž˜ê°€ + ë‚™ì°°í†µê³„ + í‰ê°€ê²°ê³¼ -->
                <StackPanel Grid.Column="2">
                    
                    <!-- ì‹¤ê±°ëž˜ê°€ ì˜ì—­ -->
                    <Border Style="{StaticResource CardStyle}">
                        <StackPanel>
                            <Grid Margin="0,0,0,12">
                                <TextBlock Text="ðŸ’° ì‹¤ê±°ëž˜ê°€" Style="{StaticResource SectionHeaderStyle}" Margin="0"/>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                    <Button Content="ì¡°íšŒ" 
                                            Command="{Binding FetchRealTransactionCommand}"
                                            Style="{StaticResource SecondaryButton}"
                                            Padding="12,4"
                                            FontSize="{StaticResource FontSizeBody}"
                                            Margin="0,0,8,0"/>
                                    <!-- E-004: ì‹œì„¸ ì°¨íŠ¸ ëŒ€ì•ˆ - ì™¸ë¶€ ë§í¬ -->
                                    <Button Content="ðŸ“ˆ ì‹œì„¸ë³´ê¸°" 
                                            Command="{Binding OpenPriceTrendSiteCommand}"
                                            Style="{StaticResource SecondaryButton}"
                                            Padding="12,4"
                                            FontSize="{StaticResource FontSizeBody}"
                                            ToolTip="KBë¶€ë™ì‚° ì‹œì„¸ ì¡°íšŒ"
                                            Margin="0,0,8,0"/>
                                    <Button Content="ðŸ”— rt.molit.go.kr" 
                                            Command="{Binding OpenRealTransactionSiteCommand}"
                                            Style="{StaticResource SecondaryButton}"
                                            Padding="12,4"
                                            FontSize="{StaticResource FontSizeBody}"/>
                                </StackPanel>
                            </Grid>
                            
                            <!-- ì‹¤ê±°ëž˜ê°€ í…Œì´ë¸” (E-003: í…Œì´ë¸” í¬ê¸° ì¶•ì†Œ 150â†’120) -->
                            <DataGrid ItemsSource="{Binding RealTransactions}"
                                      AutoGenerateColumns="False"
                                      CanUserAddRows="False"
                                      CanUserDeleteRows="False"
                                      HeadersVisibility="Column"
                                      GridLinesVisibility="All"
                                      BorderThickness="1"
                                      BorderBrush="{StaticResource BlueGray200Brush}"
                                      MaxHeight="120"
                                      FontSize="{StaticResource FontSizeBody}">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="ê±°ëž˜ë©´ì " Binding="{Binding Area, StringFormat=N2}" Width="80"/>
                                    <DataGridTextColumn Header="ê±°ëž˜ì¼ìž" Binding="{Binding TransactionDate, StringFormat=yyyy-MM-dd}" Width="90"/>
                                    <DataGridTextColumn Header="ê±°ëž˜ê¸ˆì•¡" Binding="{Binding Amount, StringFormat=N0}" Width="100"/>
                                    <DataGridTextColumn Header="ì¸µìˆ˜" Binding="{Binding Floor}" Width="50"/>
                                    <DataGridTextColumn Header="ë“±ê¸°ì—¬ë¶€" Binding="{Binding IsRegistered}" Width="60"/>
                                    <DataGridCheckBoxColumn Header="ì ìš©" Binding="{Binding IsApplied}" Width="50"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </StackPanel>
                    </Border>

                    <!-- ë‚™ì°°í†µê³„ ì˜ì—­ - í”¼ë“œë°± ë°˜ì˜: ì‹œ/êµ°êµ¬/ë™ 3Ã—3 ë§¤íŠ¸ë¦­ìŠ¤ -->
                    <Border Style="{StaticResource CardStyle}">
                        <StackPanel>
                            <Grid Margin="0,0,0,12">
                                <TextBlock Text="ðŸ“ˆ ë‚™ì°°í†µê³„" Style="{StaticResource SectionHeaderStyle}" Margin="0"/>
                                <!-- ì ìš©ë‚™ì°°ê°€ìœ¨ í—¤ë” - í”¼ë“œë°± ë°˜ì˜: ê°€ì‹œì„± ê°œì„  -->
                                <TextBlock Text="ì ìš©ë‚™ì°°ê°€ìœ¨" 
                                           HorizontalAlignment="Right"
                                           FontSize="{StaticResource FontSizeH4}"
                                           FontWeight="Bold"
                                           Foreground="{StaticResource PrimaryBrush}"/>
                            </Grid>
                            
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="80"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <!-- í—¤ë” í–‰ -->
                                <Border Grid.Row="0" Grid.Column="0" Background="{StaticResource BlueGray100Brush}" Padding="8,6" Margin="0,0,1,1">
                                    <TextBlock Text="ì§€ì—­í†µê³„" Style="{StaticResource LabelStyle}" FontWeight="SemiBold"/>
                                </Border>
                                <Border Grid.Row="0" Grid.Column="1" Background="{StaticResource BlueGray100Brush}" Padding="8,6" Margin="0,0,1,1">
                                    <TextBlock Text="{Binding RegionName1}" Style="{StaticResource ValueStyle}" FontWeight="SemiBold" HorizontalAlignment="Center"/>
                                </Border>
                                <Border Grid.Row="0" Grid.Column="2" Background="{StaticResource BlueGray100Brush}" Padding="8,6" Margin="0,0,1,1">
                                    <TextBlock Text="{Binding RegionName2}" Style="{StaticResource ValueStyle}" FontWeight="SemiBold" HorizontalAlignment="Center"/>
                                </Border>
                                <Border Grid.Row="0" Grid.Column="3" Background="{StaticResource BlueGray100Brush}" Padding="8,6" Margin="0,0,0,1">
                                    <TextBlock Text="{Binding RegionName3}" Style="{StaticResource ValueStyle}" FontWeight="SemiBold" HorizontalAlignment="Center"/>
                                </Border>

                                <!-- 1ë…„ í‰ê·  -->
                                <Border Grid.Row="1" Grid.Column="0" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="1,0,1,1" Padding="8,6">
                                    <TextBlock Text="1ë…„ í‰ê· " Style="{StaticResource LabelStyle}"/>
                                </Border>
                                <Border Grid.Row="1" Grid.Column="1" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="0,0,1,1" Padding="8,6">
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                        <TextBlock Text="{Binding Stats1Year_Rate1, StringFormat={}{0:P1}}" Style="{StaticResource ValueStyle}"/>
                                        <TextBlock Text=" / " Style="{StaticResource LabelStyle}" FontSize="{StaticResource FontSizeSmall}"/>
                                        <TextBlock Text="{Binding Stats1Year_Count1, StringFormat={}{0}ê±´}" Style="{StaticResource LabelStyle}" FontSize="{StaticResource FontSizeSmall}"/>
                                    </StackPanel>
                                </Border>
                                <Border Grid.Row="1" Grid.Column="2" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="0,0,1,1" Padding="8,6">
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                        <TextBlock Text="{Binding Stats1Year_Rate2, StringFormat={}{0:P1}}" Style="{StaticResource ValueStyle}"/>
                                        <TextBlock Text=" / " Style="{StaticResource LabelStyle}" FontSize="{StaticResource FontSizeSmall}"/>
                                        <TextBlock Text="{Binding Stats1Year_Count2, StringFormat={}{0}ê±´}" Style="{StaticResource LabelStyle}" FontSize="{StaticResource FontSizeSmall}"/>
                                    </StackPanel>
                                </Border>
                                <Border Grid.Row="1" Grid.Column="3" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="0,0,1,1" Padding="8,6">
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                        <TextBlock Text="{Binding Stats1Year_Rate3, StringFormat={}{0:P1}}" Style="{StaticResource ValueStyle}"/>
                                        <TextBlock Text=" / " Style="{StaticResource LabelStyle}" FontSize="{StaticResource FontSizeSmall}"/>
                                        <TextBlock Text="{Binding Stats1Year_Count3, StringFormat={}{0}ê±´}" Style="{StaticResource LabelStyle}" FontSize="{StaticResource FontSizeSmall}"/>
                                    </StackPanel>
                                </Border>

                                <!-- 6ê°œì›” í‰ê·  -->
                                <Border Grid.Row="2" Grid.Column="0" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="1,0,1,1" Padding="8,6">
                                    <TextBlock Text="6ê°œì›” í‰ê· " Style="{StaticResource LabelStyle}"/>
                                </Border>
                                <Border Grid.Row="2" Grid.Column="1" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="0,0,1,1" Padding="8,6">
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                        <TextBlock Text="{Binding Stats6Month_Rate1, StringFormat={}{0:P1}}" Style="{StaticResource ValueStyle}"/>
                                        <TextBlock Text=" / " Style="{StaticResource LabelStyle}" FontSize="{StaticResource FontSizeSmall}"/>
                                        <TextBlock Text="{Binding Stats6Month_Count1, StringFormat={}{0}ê±´}" Style="{StaticResource LabelStyle}" FontSize="{StaticResource FontSizeSmall}"/>
                                    </StackPanel>
                                </Border>
                                <Border Grid.Row="2" Grid.Column="2" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="0,0,1,1" Padding="8,6">
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                        <TextBlock Text="{Binding Stats6Month_Rate2, StringFormat={}{0:P1}}" Style="{StaticResource ValueStyle}"/>
                                        <TextBlock Text=" / " Style="{StaticResource LabelStyle}" FontSize="{StaticResource FontSizeSmall}"/>
                                        <TextBlock Text="{Binding Stats6Month_Count2, StringFormat={}{0}ê±´}" Style="{StaticResource LabelStyle}" FontSize="{StaticResource FontSizeSmall}"/>
                                    </StackPanel>
                                </Border>
                                <Border Grid.Row="2" Grid.Column="3" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="0,0,1,1" Padding="8,6">
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                        <TextBlock Text="{Binding Stats6Month_Rate3, StringFormat={}{0:P1}}" Style="{StaticResource ValueStyle}"/>
                                        <TextBlock Text=" / " Style="{StaticResource LabelStyle}" FontSize="{StaticResource FontSizeSmall}"/>
                                        <TextBlock Text="{Binding Stats6Month_Count3, StringFormat={}{0}ê±´}" Style="{StaticResource LabelStyle}" FontSize="{StaticResource FontSizeSmall}"/>
                                    </StackPanel>
                                </Border>

                                <!-- 3ê°œì›” í‰ê·  -->
                                <Border Grid.Row="3" Grid.Column="0" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="1,0,1,1" Padding="8,6">
                                    <TextBlock Text="3ê°œì›” í‰ê· " Style="{StaticResource LabelStyle}"/>
                                </Border>
                                <Border Grid.Row="3" Grid.Column="1" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="0,0,1,1" Padding="8,6">
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                        <TextBlock Text="{Binding Stats3Month_Rate1, StringFormat={}{0:P1}}" Style="{StaticResource ValueStyle}"/>
                                        <TextBlock Text=" / " Style="{StaticResource LabelStyle}" FontSize="{StaticResource FontSizeSmall}"/>
                                        <TextBlock Text="{Binding Stats3Month_Count1, StringFormat={}{0}ê±´}" Style="{StaticResource LabelStyle}" FontSize="{StaticResource FontSizeSmall}"/>
                                    </StackPanel>
                                </Border>
                                <Border Grid.Row="3" Grid.Column="2" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="0,0,1,1" Padding="8,6">
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                        <TextBlock Text="{Binding Stats3Month_Rate2, StringFormat={}{0:P1}}" Style="{StaticResource ValueStyle}"/>
                                        <TextBlock Text=" / " Style="{StaticResource LabelStyle}" FontSize="{StaticResource FontSizeSmall}"/>
                                        <TextBlock Text="{Binding Stats3Month_Count2, StringFormat={}{0}ê±´}" Style="{StaticResource LabelStyle}" FontSize="{StaticResource FontSizeSmall}"/>
                                    </StackPanel>
                                </Border>
                                <Border Grid.Row="3" Grid.Column="3" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="0,0,1,1" Padding="8,6">
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                        <TextBlock Text="{Binding Stats3Month_Rate3, StringFormat={}{0:P1}}" Style="{StaticResource ValueStyle}"/>
                                        <TextBlock Text=" / " Style="{StaticResource LabelStyle}" FontSize="{StaticResource FontSizeSmall}"/>
                                        <TextBlock Text="{Binding Stats3Month_Count3, StringFormat={}{0}ê±´}" Style="{StaticResource LabelStyle}" FontSize="{StaticResource FontSizeSmall}"/>
                                    </StackPanel>
                                </Border>

                                <!-- ì ìš© ë‚™ì°°ê°€ìœ¨ - í”¼ë“œë°± ë°˜ì˜: ê°€ì‹œì„± ëŒ€í­ ê°œì„  -->
                                <Border Grid.Row="0" Grid.RowSpan="4" Grid.Column="4"
                                        Background="{StaticResource PrimaryBrush}"
                                        CornerRadius="8"
                                        Padding="20,12"
                                        Margin="12,0,0,0"
                                        VerticalAlignment="Center">
                                    <StackPanel>
                                        <TextBlock Text="{Binding AppliedBidRate, StringFormat={}{0:P1}}" 
                                                   FontSize="{StaticResource FontSizeXLarge}"
                                                   FontWeight="Bold"
                                                   Foreground="White"
                                                   HorizontalAlignment="Center"/>
                                        <TextBlock Text="{Binding AppliedBidRateDescription}" 
                                                   FontSize="{StaticResource FontSizeSmall}"
                                                   Foreground="White"
                                                   Opacity="0.9"
                                                   HorizontalAlignment="Center"
                                                   TextWrapping="Wrap"
                                                   MaxWidth="100"
                                                   TextAlignment="Center"
                                                   Margin="0,6,0,0"/>
                                    </StackPanel>
                                </Border>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- í‰ê°€ê²°ê³¼ ì˜ì—­ (í”¼ë“œë°± ë°˜ì˜: ì—‘ì…€ êµ¬ì¡°, í† ì§€/ê±´ë¬¼í‰ë‹¹ë‚™ì°°ê°€ ì¶”ê°€) -->
                    <Border Style="{StaticResource CardStyle}">
                        <StackPanel>
                            <TextBlock Text="âœ… í‰ê°€ê²°ê³¼" Style="{StaticResource SectionHeaderStyle}" Margin="0,0,0,12"/>
                            
                            <!-- í‰ê°€ê²°ê³¼ í…Œì´ë¸” (ì—‘ì…€ ìŠ¤íƒ€ì¼) -->
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="80"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="70"/>
                                    <ColumnDefinition Width="90"/>
                                    <ColumnDefinition Width="90"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <!-- í—¤ë” í–‰ -->
                                <Border Grid.Row="0" Grid.Column="0" Background="{StaticResource BlueGray100Brush}" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="1,1,0,1" Padding="6,4">
                                    <TextBlock Text="êµ¬ë¶„" Style="{StaticResource LabelStyle}" FontWeight="SemiBold" HorizontalAlignment="Center"/>
                                </Border>
                                <Border Grid.Row="0" Grid.Column="1" Background="{StaticResource BlueGray100Brush}" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="1,1,0,1" Padding="6,4">
                                    <TextBlock Text="ë‚™ì°°ê°€ì•¡" Style="{StaticResource LabelStyle}" FontWeight="SemiBold" HorizontalAlignment="Center"/>
                                </Border>
                                <Border Grid.Row="0" Grid.Column="2" Background="{StaticResource BlueGray100Brush}" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="1,1,0,1" Padding="6,4">
                                    <TextBlock Text="ë‚™ì°°ê°€ìœ¨" Style="{StaticResource LabelStyle}" FontWeight="SemiBold" HorizontalAlignment="Center"/>
                                </Border>
                                <Border Grid.Row="0" Grid.Column="3" Background="{StaticResource BlueGray100Brush}" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="1,1,0,1" Padding="6,4">
                                    <TextBlock Text="í† ì§€í‰ë‹¹" Style="{StaticResource LabelStyle}" FontWeight="SemiBold" HorizontalAlignment="Center"/>
                                </Border>
                                <Border Grid.Row="0" Grid.Column="4" Background="{StaticResource BlueGray100Brush}" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="1,1,0,1" Padding="6,4">
                                    <TextBlock Text="ê±´ë¬¼í‰ë‹¹" Style="{StaticResource LabelStyle}" FontWeight="SemiBold" HorizontalAlignment="Center"/>
                                </Border>
                                <Border Grid.Row="0" Grid.Column="5" Background="{StaticResource BlueGray100Brush}" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="1,1,1,1" Padding="6,4">
                                    <TextBlock Text="í‰ê°€ ì‚¬ìœ " Style="{StaticResource LabelStyle}" FontWeight="SemiBold" HorizontalAlignment="Center"/>
                                </Border>

                                <!-- ì‹œë‚˜ë¦¬ì˜¤ 1 í–‰ -->
                                <Border Grid.Row="1" Grid.Column="0" Background="{StaticResource BlueGray50Brush}" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="1,0,0,1" Padding="6,6">
                                    <TextBlock Text="ì‹œë‚˜ë¦¬ì˜¤ 1" Style="{StaticResource LabelStyle}" FontWeight="SemiBold" Foreground="{StaticResource PrimaryBrush}" HorizontalAlignment="Center"/>
                                </Border>
                                <Border Grid.Row="1" Grid.Column="1" Background="#FFFDE7" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="1,0,0,1" Padding="6,6">
                                    <TextBlock Text="{Binding Scenario1_Amount, StringFormat={}{0:N0}}" Style="{StaticResource AmountStyle}" Foreground="#D50000" HorizontalAlignment="Right"/>
                                </Border>
                                <Border Grid.Row="1" Grid.Column="2" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="1,0,0,1" Padding="6,6">
                                    <TextBlock Text="{Binding Scenario1_Rate, StringFormat={}{0:P1}}" Style="{StaticResource ValueStyle}" HorizontalAlignment="Center"/>
                                </Border>
                                <Border Grid.Row="1" Grid.Column="3" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="1,0,0,1" Padding="6,6">
                                    <TextBlock Text="{Binding Scenario1_LandPerPyung, StringFormat={}{0:N0}}" Style="{StaticResource ValueStyle}" HorizontalAlignment="Right"/>
                                </Border>
                                <Border Grid.Row="1" Grid.Column="4" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="1,0,0,1" Padding="6,6">
                                    <TextBlock Text="{Binding Scenario1_BuildingPerPyung, StringFormat={}{0:N0}}" Style="{StaticResource ValueStyle}" HorizontalAlignment="Right"/>
                                </Border>
                                <Border Grid.Row="1" Grid.Column="5" Background="#FFFDE7" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="1,0,1,1" Padding="4,4">
                                    <TextBox Text="{Binding Scenario1_Reason, UpdateSourceTrigger=PropertyChanged}" 
                                             BorderThickness="0" Background="Transparent" 
                                             FontSize="{StaticResource FontSizeSmall}"
                                             Foreground="#D50000" FontWeight="Bold"/>
                                </Border>

                                <!-- ì‹œë‚˜ë¦¬ì˜¤ 2 í–‰ -->
                                <Border Grid.Row="2" Grid.Column="0" Background="{StaticResource BlueGray50Brush}" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="1,0,0,1" Padding="6,6">
                                    <TextBlock Text="ì‹œë‚˜ë¦¬ì˜¤ 2" Style="{StaticResource LabelStyle}" FontWeight="SemiBold" Foreground="{StaticResource SecondaryBrush}" HorizontalAlignment="Center"/>
                                </Border>
                                <Border Grid.Row="2" Grid.Column="1" Background="#FFFDE7" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="1,0,0,1" Padding="6,6">
                                    <TextBlock Text="{Binding Scenario2_Amount, StringFormat={}{0:N0}}" Style="{StaticResource AmountStyle}" Foreground="#D50000" HorizontalAlignment="Right"/>
                                </Border>
                                <Border Grid.Row="2" Grid.Column="2" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="1,0,0,1" Padding="6,6">
                                    <TextBlock Text="{Binding Scenario2_Rate, StringFormat={}{0:P1}}" Style="{StaticResource ValueStyle}" HorizontalAlignment="Center"/>
                                </Border>
                                <Border Grid.Row="2" Grid.Column="3" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="1,0,0,1" Padding="6,6">
                                    <TextBlock Text="{Binding Scenario2_LandPerPyung, StringFormat={}{0:N0}}" Style="{StaticResource ValueStyle}" HorizontalAlignment="Right"/>
                                </Border>
                                <Border Grid.Row="2" Grid.Column="4" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="1,0,0,1" Padding="6,6">
                                    <TextBlock Text="{Binding Scenario2_BuildingPerPyung, StringFormat={}{0:N0}}" Style="{StaticResource ValueStyle}" HorizontalAlignment="Right"/>
                                </Border>
                                <Border Grid.Row="2" Grid.Column="5" Background="#FFFDE7" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="1,0,1,1" Padding="4,4">
                                    <TextBox Text="{Binding Scenario2_Reason, UpdateSourceTrigger=PropertyChanged}" 
                                             BorderThickness="0" Background="Transparent" 
                                             FontSize="{StaticResource FontSizeSmall}"
                                             Foreground="#D50000" FontWeight="Bold"/>
                                </Border>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- íšŒìˆ˜ ì „ëžµ ìš”ì•½ (ì‹ ê·œ ì¶”ê°€) -->
                    <Border Style="{StaticResource CardStyle}">
                        <StackPanel>
                            <TextBlock Text="ðŸ’° íšŒìˆ˜ ì „ëžµ ìš”ì•½" Style="{StaticResource SectionHeaderStyle}" Margin="0,0,0,12"/>
                            
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="16"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                
                                <!-- ì‹œë‚˜ë¦¬ì˜¤ 1 íšŒìˆ˜ ì „ëžµ -->
                                <Border Grid.Column="0" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="1" CornerRadius="4">
                                    <StackPanel>
                                        <Border Background="{StaticResource PrimaryBrush}" Padding="8,6">
                                            <TextBlock Text="ì‹œë‚˜ë¦¬ì˜¤ 1 íšŒìˆ˜ ì „ëžµ" FontWeight="Bold" Foreground="White" HorizontalAlignment="Center"/>
                                        </Border>
                                        <Grid Margin="8">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            
                                            <TextBlock Grid.Row="0" Grid.Column="0" Text="CF in date" Style="{StaticResource LabelStyle}" Margin="0,0,8,4"/>
                                            <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding Recovery1_CFDate, StringFormat=yyyy-MM-dd, TargetNullValue=-}" Style="{StaticResource ValueStyle}" HorizontalAlignment="Right" Margin="0,0,0,4"/>
                                            
                                            <TextBlock Grid.Row="1" Grid.Column="0" Text="ë‹´ë³´ ë°°ë‹¹ íšŒìˆ˜" Style="{StaticResource LabelStyle}" Margin="0,0,8,4"/>
                                            <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding Recovery1_CollateralAmount, StringFormat={}{0:N0}ì›, TargetNullValue=-}" Style="{StaticResource AmountStyle}" HorizontalAlignment="Right" Margin="0,0,0,4"/>
                                            
                                            <TextBlock Grid.Row="2" Grid.Column="0" Text="ê²½ë§¤ë¹„ìš©" Style="{StaticResource LabelStyle}" Margin="0,0,8,4"/>
                                            <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding Recovery1_AuctionCost, StringFormat={}{0:N0}ì›, TargetNullValue=-}" Style="{StaticResource ValueStyle}" Foreground="#D50000" HorizontalAlignment="Right" Margin="0,0,0,4"/>
                                            
                                            <TextBlock Grid.Row="3" Grid.Column="0" Text="ì‹ ìš©ë³´ì¦ì„œ íšŒìˆ˜" Style="{StaticResource LabelStyle}" Margin="0,0,8,4"/>
                                            <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding Recovery1_GuaranteeAmount, StringFormat={}{0:N0}ì›, TargetNullValue=-}" Style="{StaticResource ValueStyle}" HorizontalAlignment="Right" Margin="0,0,0,4"/>
                                            
                                            <TextBlock Grid.Row="4" Grid.Column="0" Text="íšŒìˆ˜ìœ¨ (Ratio)" Style="{StaticResource LabelStyle}" FontWeight="SemiBold" Margin="0,4,8,0"/>
                                            <TextBlock Grid.Row="4" Grid.Column="1" Text="{Binding Recovery1_Ratio, StringFormat={}{0:P1}, TargetNullValue=-}" Style="{StaticResource AmountStyle}" Foreground="{StaticResource PrimaryBrush}" HorizontalAlignment="Right" Margin="0,4,0,0"/>
                                        </Grid>
                                    </StackPanel>
                                </Border>
                                
                                <!-- ì‹œë‚˜ë¦¬ì˜¤ 2 íšŒìˆ˜ ì „ëžµ -->
                                <Border Grid.Column="2" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="1" CornerRadius="4">
                                    <StackPanel>
                                        <Border Background="{StaticResource SecondaryBrush}" Padding="8,6">
                                            <TextBlock Text="ì‹œë‚˜ë¦¬ì˜¤ 2 íšŒìˆ˜ ì „ëžµ" FontWeight="Bold" Foreground="White" HorizontalAlignment="Center"/>
                                        </Border>
                                        <Grid Margin="8">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            
                                            <TextBlock Grid.Row="0" Grid.Column="0" Text="CF in date" Style="{StaticResource LabelStyle}" Margin="0,0,8,4"/>
                                            <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding Recovery2_CFDate, StringFormat=yyyy-MM-dd, TargetNullValue=-}" Style="{StaticResource ValueStyle}" HorizontalAlignment="Right" Margin="0,0,0,4"/>
                                            
                                            <TextBlock Grid.Row="1" Grid.Column="0" Text="ë‹´ë³´ ë°°ë‹¹ íšŒìˆ˜" Style="{StaticResource LabelStyle}" Margin="0,0,8,4"/>
                                            <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding Recovery2_CollateralAmount, StringFormat={}{0:N0}ì›, TargetNullValue=-}" Style="{StaticResource AmountStyle}" HorizontalAlignment="Right" Margin="0,0,0,4"/>
                                            
                                            <TextBlock Grid.Row="2" Grid.Column="0" Text="ê²½ë§¤ë¹„ìš©" Style="{StaticResource LabelStyle}" Margin="0,0,8,4"/>
                                            <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding Recovery2_AuctionCost, StringFormat={}{0:N0}ì›, TargetNullValue=-}" Style="{StaticResource ValueStyle}" Foreground="#D50000" HorizontalAlignment="Right" Margin="0,0,0,4"/>
                                            
                                            <TextBlock Grid.Row="3" Grid.Column="0" Text="ì‹ ìš©ë³´ì¦ì„œ íšŒìˆ˜" Style="{StaticResource LabelStyle}" Margin="0,0,8,4"/>
                                            <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding Recovery2_GuaranteeAmount, StringFormat={}{0:N0}ì›, TargetNullValue=-}" Style="{StaticResource ValueStyle}" HorizontalAlignment="Right" Margin="0,0,0,4"/>
                                            
                                            <TextBlock Grid.Row="4" Grid.Column="0" Text="íšŒìˆ˜ìœ¨ (Ratio)" Style="{StaticResource LabelStyle}" FontWeight="SemiBold" Margin="0,4,8,0"/>
                                            <TextBlock Grid.Row="4" Grid.Column="1" Text="{Binding Recovery2_Ratio, StringFormat={}{0:P1}, TargetNullValue=-}" Style="{StaticResource AmountStyle}" Foreground="{StaticResource SecondaryBrush}" HorizontalAlignment="Right" Margin="0,4,0,0"/>
                                        </Grid>
                                    </StackPanel>
                                </Border>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- ì°¨ì£¼ë³„ ë°°ë‹¹ ìš”ì•½ (í”¼ë“œë°± ë°˜ì˜: ì‹œë‚˜ë¦¬ì˜¤ 3 ì»¬ëŸ¼ ì œê±°) -->
                    <Border Style="{StaticResource CardStyle}">
                        <StackPanel>
                            <TextBlock Text="ðŸ“Š ì‹œë‚˜ë¦¬ì˜¤ë³„ ë°°ë‹¹ ìš”ì•½" Style="{StaticResource SectionHeaderStyle}" Margin="0,0,0,12"/>
                            
                            <DataGrid ItemsSource="{Binding ScenarioSummaryItems}"
                                      AutoGenerateColumns="False"
                                      CanUserAddRows="False"
                                      CanUserDeleteRows="False"
                                      HeadersVisibility="Column"
                                      GridLinesVisibility="All"
                                      BorderThickness="1"
                                      BorderBrush="{StaticResource BlueGray200Brush}"
                                      FontSize="{StaticResource FontSizeBody}"
                                      IsReadOnly="True">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="êµ¬ë¶„" Binding="{Binding Label}" Width="80">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Background" Value="{StaticResource BlueGray50Brush}"/>
                                                <Setter Property="Padding" Value="8,4"/>
                                                <Setter Property="FontWeight" Value="SemiBold"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Header="ì‹œë‚˜ë¦¬ì˜¤ 1" Binding="{Binding Scenario1Display}" Width="120">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Padding" Value="8,4"/>
                                                <Setter Property="TextAlignment" Value="Right"/>
                                                <Setter Property="Foreground" Value="{StaticResource PrimaryBrush}"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Header="ì‹œë‚˜ë¦¬ì˜¤ 2" Binding="{Binding Scenario2Display}" Width="120">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Padding" Value="8,4"/>
                                                <Setter Property="TextAlignment" Value="Right"/>
                                                <Setter Property="Foreground" Value="{StaticResource SecondaryBrush}"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Header="í•©ê³„" Binding="{Binding TotalDisplay}" Width="*">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Padding" Value="8,4"/>
                                                <Setter Property="TextAlignment" Value="Right"/>
                                                <Setter Property="FontWeight" Value="Bold"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </StackPanel>
                    </Border>

                    <!-- ì¸í„°ë¦¼ ìƒê³„/íšŒìˆ˜ (ì°¨ì£¼ë‹¹ ì²« ë²ˆì§¸ ë¬¼ê±´ì—ë§Œ í‘œì‹œ) -->
                    <Border Style="{StaticResource CardStyle}" 
                            Visibility="{Binding IsFirstPropertyInBorrower, Converter={StaticResource BoolToVisibilityConverter}}">
                        <StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                <TextBlock Text="ðŸ’° ì¸í„°ë¦¼ ìƒê³„/íšŒìˆ˜" Style="{StaticResource SectionHeaderStyle}"/>
                                <TextBlock Text="(ì°¨ì£¼ë³„ í•©ì‚°)" 
                                           Style="{StaticResource LabelStyle}" 
                                           FontSize="{StaticResource FontSizeSmall}" 
                                           Opacity="0.6" 
                                           VerticalAlignment="Center"
                                           Margin="8,0,0,0"/>
                            </StackPanel>
                            
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                
                                <!-- íšŒìˆ˜ ì •ë³´ -->
                                <Border Grid.Column="0" Background="{StaticResource SuccessLightBrush}" CornerRadius="4" Padding="12" Margin="0,0,8,0">
                                    <StackPanel>
                                        <TextBlock Text="íšŒìˆ˜ ì´ì•¡" Style="{StaticResource LabelStyle}" FontSize="{StaticResource FontSizeSmall}" Margin="0,0,0,4"/>
                                        <TextBlock Text="{Binding InterimTotalRecovery, StringFormat=N0}" 
                                                   Style="{StaticResource AmountStyle}" 
                                                   FontSize="{StaticResource FontSizeH2}"
                                                   Foreground="{StaticResource SuccessBrush}"/>
                                        <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                                            <StackPanel Margin="0,0,16,0">
                                                <TextBlock Text="ì›ê¸ˆíšŒìˆ˜" Style="{StaticResource LabelStyle}" FontSize="{StaticResource FontSizeTiny}"/>
                                                <TextBlock Text="{Binding InterimPrincipalRecovery, StringFormat=N0}" Style="{StaticResource ValueStyle}" FontSize="{StaticResource FontSizeBody}"/>
                                            </StackPanel>
                                            <StackPanel>
                                                <TextBlock Text="ì´ìžíšŒìˆ˜" Style="{StaticResource LabelStyle}" FontSize="{StaticResource FontSizeTiny}"/>
                                                <TextBlock Text="{Binding InterimInterestRecovery, StringFormat=N0}" Style="{StaticResource ValueStyle}" FontSize="{StaticResource FontSizeBody}"/>
                                            </StackPanel>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                                
                                <!-- ì§€ì¶œ ì •ë³´ -->
                                <Border Grid.Column="1" Background="{StaticResource WarningLightBrush}" CornerRadius="4" Padding="12" Margin="0,0,8,0">
                                    <StackPanel>
                                        <TextBlock Text="ì§€ì¶œ ì´ì•¡" Style="{StaticResource LabelStyle}" FontSize="{StaticResource FontSizeSmall}" Margin="0,0,0,4"/>
                                        <TextBlock Text="{Binding InterimTotalAdvance, StringFormat=N0}" 
                                                   Style="{StaticResource AmountStyle}" 
                                                   FontSize="{StaticResource FontSizeH2}"
                                                   Foreground="{StaticResource WarningBrush}"/>
                                        <StackPanel Margin="0,8,0,0">
                                            <TextBlock Text="ê²½ë§¤ë¹„ìš©" Style="{StaticResource LabelStyle}" FontSize="{StaticResource FontSizeTiny}"/>
                                            <TextBlock Text="{Binding InterimAuctionCost, StringFormat=N0}" Style="{StaticResource ValueStyle}" FontSize="{StaticResource FontSizeBody}"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                                
                                <!-- ìˆœìˆ˜ìµ -->
                                <Border Grid.Column="2" Background="{StaticResource PrimaryLightBrush}" CornerRadius="4" Padding="12">
                                    <StackPanel>
                                        <TextBlock Text="ìˆœìˆ˜ìµ" Style="{StaticResource LabelStyle}" FontSize="{StaticResource FontSizeSmall}" Margin="0,0,0,4"/>
                                        <TextBlock Text="{Binding InterimNetAmount, StringFormat=N0}" 
                                                   Style="{StaticResource AmountStyle}" 
                                                   FontSize="{StaticResource FontSizeH2}"
                                                   FontWeight="Bold"
                                                   Foreground="{StaticResource PrimaryBrush}"/>
                                        <TextBlock Text="íšŒìˆ˜ - ì§€ì¶œ" 
                                                   Style="{StaticResource LabelStyle}" 
                                                   FontSize="{StaticResource FontSizeTiny}" 
                                                   Opacity="0.6"
                                                   Margin="0,8,0,0"/>
                                    </StackPanel>
                                </Border>
                            </Grid>
                        </StackPanel>
                    </Border>

                </StackPanel>
            </Grid>

            <!-- ë©”ì‹œì§€ í‘œì‹œ -->
            <Border Grid.Row="1" 
                    Background="{StaticResource MaterialGreenBgBrush}" 
                    CornerRadius="4" 
                    Padding="12"
                    Margin="0,16,0,0"
                    VerticalAlignment="Bottom"
                    Visibility="{Binding SuccessMessage, Converter={StaticResource NullToVisibilityConverter}}">
                <TextBlock Text="{Binding SuccessMessage}" 
                           Foreground="{StaticResource MaterialGreenDarkBrush}"
                           FontSize="{StaticResource FontSizeBody}"/>
            </Border>

            <Border Grid.Row="1" 
                    Background="{StaticResource MaterialRedBgBrush}" 
                    CornerRadius="4" 
                    Padding="12"
                    Margin="0,16,0,0"
                    VerticalAlignment="Bottom"
                    Visibility="{Binding ErrorMessage, Converter={StaticResource NullToVisibilityConverter}}">
                <TextBlock Text="{Binding ErrorMessage}" 
                           Foreground="{StaticResource MaterialRedDarkBrush}"
                           FontSize="{StaticResource FontSizeBody}"/>
            </Border>
        </Grid>
    </ScrollViewer>
</UserControl>

