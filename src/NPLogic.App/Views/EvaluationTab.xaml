<UserControl x:Class="NPLogic.Views.EvaluationTab"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:NPLogic.Views"
             xmlns:vm="clr-namespace:NPLogic.ViewModels"
             mc:Ignorable="d" 
             d:DesignHeight="900" d:DesignWidth="1400"
             d:DataContext="{d:DesignInstance Type=vm:EvaluationTabViewModel}">

    <UserControl.Resources>
        <!-- í”¼ë“œë°± ë°˜ì˜: ê³µí†µ ìŠ¤íƒ€ì¼ ì°¸ì¡°ë¡œ í†µì¼ -->
        <!-- SectionHeader, LabelText, ValueText, AmountText, CardBorder ìŠ¤íƒ€ì¼ì€ Typography.xamlì—ì„œ ì°¸ì¡° -->
        
        <!-- ë¡œì»¬ ë³„ì¹­ (í•˜ìœ„ í˜¸í™˜ì„±) -->
        <Style x:Key="SectionHeaderStyle" TargetType="TextBlock" BasedOn="{StaticResource SectionHeader}">
            <Setter Property="FontSize" Value="14"/>
        </Style>
        <Style x:Key="LabelStyle" TargetType="TextBlock" BasedOn="{StaticResource LabelText}"/>
        <Style x:Key="ValueStyle" TargetType="TextBlock" BasedOn="{StaticResource ValueText}"/>
        <Style x:Key="AmountStyle" TargetType="TextBlock" BasedOn="{StaticResource AmountText}"/>
        <Style x:Key="CardStyle" TargetType="Border" BasedOn="{StaticResource CardBorder}">
            <Setter Property="Padding" Value="16"/>
        </Style>
    </UserControl.Resources>

    <ScrollViewer VerticalScrollBarVisibility="Auto" 
                  HorizontalScrollBarVisibility="Disabled"
                  Padding="24">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- ë¡œë”© ì˜¤ë²„ë ˆì´ -->
            <Border Grid.RowSpan="2" 
                    Background="#80FFFFFF" 
                    Visibility="{Binding IsLoading, Converter={StaticResource BoolToVisibilityConverter}}"
                    Panel.ZIndex="100">
                <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                    <ProgressBar IsIndeterminate="True" Width="200" Height="4"/>
                    <TextBlock Text="ë¡œë”© ì¤‘..." Margin="0,12,0,0" 
                               HorizontalAlignment="Center"
                               Style="{StaticResource BodyTextStyle}"/>
                </StackPanel>
            </Border>

            <!-- í—¤ë”: í‰ê°€ ìœ í˜• ì„ íƒ -->
            <Border Grid.Row="0" Style="{StaticResource CardStyle}">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Column="0" Orientation="Horizontal">
                        <TextBlock Text="ðŸ“Š í‰ê°€ ìœ í˜• ì„ íƒ" 
                                   Style="{StaticResource SectionHeaderStyle}"
                                   Margin="0"/>
                    </StackPanel>

                    <!-- í‰ê°€ ìœ í˜• ë¼ë””ì˜¤ ë²„íŠ¼ -->
                    <StackPanel Grid.Column="1" Orientation="Horizontal" 
                                Margin="32,0,0,0"
                                VerticalAlignment="Center">
                        <RadioButton Content="1. ì•„íŒŒíŠ¸" 
                                     IsChecked="{Binding IsApartmentType}"
                                     GroupName="EvaluationType"
                                     Margin="0,0,24,0"
                                     FontSize="13"/>
                        <RadioButton Content="2. ì—°ë¦½ë‹¤ì„¸ëŒ€" 
                                     IsChecked="{Binding IsMultiFamilyType}"
                                     GroupName="EvaluationType"
                                     Margin="0,0,24,0"
                                     FontSize="13"/>
                        <RadioButton Content="3. ê³µìž¥/ì°½ê³ " 
                                     IsChecked="{Binding IsFactoryType}"
                                     GroupName="EvaluationType"
                                     Margin="0,0,24,0"
                                     FontSize="13"/>
                        <RadioButton Content="4. ìƒê°€/ì•„íŒŒíŠ¸í˜•ê³µìž¥" 
                                     IsChecked="{Binding IsCommercialType}"
                                     GroupName="EvaluationType"
                                     Margin="0,0,24,0"
                                     FontSize="13"/>
                        <RadioButton Content="5. ì£¼íƒ/ê·¼ë¦°ì‹œì„¤/í† ì§€/ê¸°íƒ€" 
                                     IsChecked="{Binding IsHouseLandType}"
                                     GroupName="EvaluationType"
                                     FontSize="13"/>
                    </StackPanel>

                    <!-- í”¼ë“œë°± ë°˜ì˜: íƒ­ ë‚´ë¶€ ì €ìž¥/ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼ ì œê±° â†’ ìƒë‹¨ í—¤ë”ì—ì„œë§Œ ì €ìž¥ -->
                    <!-- ì €ìž¥ì€ PropertyDetailView í—¤ë”ì˜ ë²„íŠ¼ ì‚¬ìš© -->
                </Grid>
            </Border>

            <!-- ë©”ì¸ ì½˜í…ì¸  -->
            <Grid Grid.Row="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="16"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- ì¢Œì¸¡: ì‚¬ë¡€ì§€ë„ + ì‚¬ë¡€í‰ê°€ -->
                <StackPanel Grid.Column="0">
                    
                    <!-- ì‚¬ë¡€ì§€ë„ ì˜ì—­ -->
                    <Border Style="{StaticResource CardStyle}">
                        <StackPanel>
                            <Grid Margin="0,0,0,12">
                                <TextBlock Text="ðŸ—ºï¸ ì‚¬ë¡€ì§€ë„" Style="{StaticResource SectionHeaderStyle}" Margin="0"/>
                                <Button Content="ê°€ì ¸ì˜¤ê¸°" 
                                        Command="{Binding LoadCaseMapCommand}"
                                        Style="{StaticResource SecondaryButton}"
                                        Padding="12,4"
                                        FontSize="12"
                                        HorizontalAlignment="Right"/>
                            </Grid>
                            
                            <!-- ì§€ë„ í”Œë ˆì´ìŠ¤í™€ë” -->
                            <Border Background="{StaticResource BlueGray50Brush}" 
                                    CornerRadius="4"
                                    Height="200">
                                <TextBlock Text="ì†Œìž¬ì§€ ê¸°ì¤€ìœ¼ë¡œ ìœ„ì¹˜, ë³¸ê±´ê¸°ì¤€ê±°ëž˜ ìžë™ ì‚°ì • ë° í‘œì‹œ"
                                           Style="{StaticResource BodyTextStyle}"
                                           Opacity="0.6"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"/>
                            </Border>
                        </StackPanel>
                    </Border>

                    <!-- ìœ ì‚¬ë¬¼ê±´ ì¶”ì²œ ì˜ì—­ -->
                    <Border Style="{StaticResource CardStyle}">
                        <StackPanel>
                            <Grid Margin="0,0,0,12">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="ðŸŽ¯ ìœ ì‚¬ë¬¼ê±´ ì¶”ì²œ" Style="{StaticResource SectionHeaderStyle}" Margin="0"/>
                                    <!-- ë¡œë”© í‘œì‹œ -->
                                    <ProgressBar IsIndeterminate="True" 
                                                 Width="80" Height="4" 
                                                 Margin="12,0,0,0"
                                                 VerticalAlignment="Center"
                                                 Visibility="{Binding IsRecommendLoading, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                    <!-- ê·œì¹™ ìˆœìœ„ ì„ íƒ -->
                                    <TextBlock Text="ê·œì¹™:" Style="{StaticResource LabelStyle}" Margin="0,0,4,0"/>
                                    <ComboBox SelectedIndex="{Binding SelectedRuleIndex, Mode=TwoWay}"
                                              Width="70" FontSize="12" Padding="4,2" Margin="0,0,8,0">
                                        <ComboBoxItem Content="1ìˆœìœ„" Tag="1"/>
                                        <ComboBoxItem Content="2ìˆœìœ„" Tag="2"/>
                                        <ComboBoxItem Content="3ìˆœìœ„" Tag="3"/>
                                        <ComboBoxItem Content="ì „ì²´"/>
                                    </ComboBox>
                                    <!-- ì§€ì—­ ë²”ìœ„ ì„ íƒ -->
                                    <TextBlock Text="ë²”ìœ„:" Style="{StaticResource LabelStyle}" Margin="0,0,4,0"/>
                                    <ComboBox Width="70" FontSize="12" Padding="4,2" Margin="0,0,8,0"
                                              SelectedValue="{Binding SelectedRegionScope, Mode=TwoWay}"
                                              SelectedValuePath="Tag">
                                        <ComboBoxItem Content="ì‹œ/ë„" Tag="big"/>
                                        <ComboBoxItem Content="ì‹œ/êµ°/êµ¬" Tag="mid"/>
                                    </ComboBox>
                                    <Button Content="ì¶”ì²œ ê²€ìƒ‰" 
                                            Command="{Binding RecommendSimilarCasesCommand}"
                                            Style="{StaticResource PrimaryButton}"
                                            Padding="12,4"
                                            FontSize="12"
                                            Margin="0,0,8,0"/>
                                    <Button Content="ì‚¬ë¡€ ì ìš©" 
                                            Command="{Binding ApplyRecommendedCaseCommand}"
                                            Style="{StaticResource SecondaryButton}"
                                            Padding="12,4"
                                            FontSize="12"/>
                                </StackPanel>
                            </Grid>
                            
                            <!-- ìƒíƒœ ë©”ì‹œì§€ -->
                            <TextBlock Text="{Binding RecommendStatusMessage}" 
                                       Style="{StaticResource LabelStyle}"
                                       Margin="0,0,0,8"
                                       Visibility="{Binding RecommendStatusMessage, Converter={StaticResource NullToVisibilityConverter}}"/>
                            
                            <!-- ì¶”ì²œ ê²°ê³¼ í…Œì´ë¸” -->
                            <DataGrid ItemsSource="{Binding RecommendedCases}"
                                      SelectedItem="{Binding SelectedRecommendCase, Mode=TwoWay}"
                                      AutoGenerateColumns="False"
                                      CanUserAddRows="False"
                                      CanUserDeleteRows="False"
                                      HeadersVisibility="Column"
                                      GridLinesVisibility="All"
                                      BorderThickness="1"
                                      BorderBrush="{StaticResource BlueGray200Brush}"
                                      MaxHeight="350"
                                      MinHeight="200"
                                      FontSize="11"
                                      SelectionMode="Single">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="ì‚¬ê±´ë²ˆí˜¸" Binding="{Binding CaseNo}" Width="110" IsReadOnly="True"/>
                                    <DataGridTextColumn Header="ë‚™ì°°ì¼" Binding="{Binding AuctionDate, StringFormat=yyyy-MM-dd}" Width="85" IsReadOnly="True"/>
                                    <DataGridTextColumn Header="ìš©ë„" Binding="{Binding Usage}" Width="70" IsReadOnly="True"/>
                                    <DataGridTextColumn Header="ê°ì •ê°€" Binding="{Binding AppraisalPrice, StringFormat=N0}" Width="100" IsReadOnly="True"/>
                                    <DataGridTextColumn Header="ë‚™ì°°ê°€" Binding="{Binding WinningPrice, StringFormat=N0}" Width="100" IsReadOnly="True"/>
                                    <DataGridTextColumn Header="ë‚™ì°°ìœ¨" Binding="{Binding WinningRateDisplay}" Width="60" IsReadOnly="True">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="FontWeight" Value="SemiBold"/>
                                                <Setter Property="Foreground" Value="{StaticResource PrimaryBrush}"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Header="ê±´ë¬¼ë©´ì " Binding="{Binding BuildingArea, StringFormat=N1}" Width="70" IsReadOnly="True"/>
                                    <DataGridTextColumn Header="ê·œì¹™" Binding="{Binding RuleName}" Width="55" IsReadOnly="True"/>
                                    <!-- ìƒì„¸ë³´ê¸° ë²„íŠ¼ -->
                                    <DataGridTemplateColumn Header="ìƒì„¸" Width="50">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <Button Content="ðŸ“‹"
                                                        Command="{Binding DataContext.ShowCaseDetailCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                        CommandParameter="{Binding}"
                                                        Style="{StaticResource SecondaryButton}"
                                                        Padding="4,2"
                                                        FontSize="12"
                                                        ToolTip="ìƒì„¸ë³´ê¸°"
                                                        Cursor="Hand"/>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </StackPanel>
                    </Border>

                    <!-- ì‚¬ë¡€í‰ê°€ ê·¸ë¦¬ë“œ -->
                    <Border Style="{StaticResource CardStyle}">
                        <StackPanel>
                            <Grid Margin="0,0,0,12">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="ðŸ“‹ ì‚¬ë¡€í‰ê°€" Style="{StaticResource SectionHeaderStyle}" Margin="0"/>
                                    <TextBlock Text="(ì§ì ‘ ìž…ë ¥ ê°€ëŠ¥)" 
                                               Style="{StaticResource LabelStyle}"
                                               FontSize="11"
                                               Opacity="0.7"
                                               Margin="8,0,0,0"
                                               VerticalAlignment="Center"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                    <Button Content="ì´ˆê¸°í™”" 
                                            Command="{Binding ClearCaseEvaluationCommand}"
                                            Style="{StaticResource SecondaryButton}"
                                            Padding="12,4"
                                            FontSize="12"
                                            Margin="0,0,8,0"/>
                                    <Button Content="ê²½ë§¤ì‚¬ê±´ê²€ìƒ‰" 
                                            Command="{Binding SearchAuctionCaseCommand}"
                                            Style="{StaticResource SecondaryButton}"
                                            Padding="12,4"
                                            FontSize="12"/>
                                </StackPanel>
                            </Grid>
                            
                            <!-- ì‚¬ë¡€í‰ê°€ í…Œì´ë¸” (ì‚¬ìš©ìž íŽ¸ì§‘ ê°€ëŠ¥) -->
                            <DataGrid ItemsSource="{Binding CaseItems}"
                                      AutoGenerateColumns="False"
                                      CanUserAddRows="False"
                                      CanUserDeleteRows="False"
                                      HeadersVisibility="Column"
                                      GridLinesVisibility="All"
                                      BorderThickness="1"
                                      BorderBrush="{StaticResource BlueGray200Brush}"
                                      MaxHeight="400"
                                      FontSize="12"
                                      SelectionUnit="Cell">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="êµ¬ë¶„" Binding="{Binding Label}" Width="100" IsReadOnly="True">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Background" Value="{StaticResource BlueGray50Brush}"/>
                                                <Setter Property="Padding" Value="8,4"/>
                                                <Setter Property="FontWeight" Value="SemiBold"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Header="ë³¸ê±´ ê°ì •ê°€" Binding="{Binding BaseValue, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="110">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Padding" Value="8,4"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                        <DataGridTextColumn.EditingElementStyle>
                                            <Style TargetType="TextBox">
                                                <Setter Property="Padding" Value="4,2"/>
                                            </Style>
                                        </DataGridTextColumn.EditingElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Header="ì‚¬ë¡€1" Binding="{Binding Case1Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="110">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Padding" Value="8,4"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                        <DataGridTextColumn.EditingElementStyle>
                                            <Style TargetType="TextBox">
                                                <Setter Property="Padding" Value="4,2"/>
                                            </Style>
                                        </DataGridTextColumn.EditingElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Header="ì‚¬ë¡€2" Binding="{Binding Case2Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="110">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Padding" Value="8,4"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                        <DataGridTextColumn.EditingElementStyle>
                                            <Style TargetType="TextBox">
                                                <Setter Property="Padding" Value="4,2"/>
                                            </Style>
                                        </DataGridTextColumn.EditingElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Header="ì‚¬ë¡€3" Binding="{Binding Case3Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="110">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Padding" Value="8,4"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                        <DataGridTextColumn.EditingElementStyle>
                                            <Style TargetType="TextBox">
                                                <Setter Property="Padding" Value="4,2"/>
                                            </Style>
                                        </DataGridTextColumn.EditingElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Header="ì‚¬ë¡€4" Binding="{Binding Case4Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="110">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Padding" Value="8,4"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                        <DataGridTextColumn.EditingElementStyle>
                                            <Style TargetType="TextBox">
                                                <Setter Property="Padding" Value="4,2"/>
                                            </Style>
                                        </DataGridTextColumn.EditingElementStyle>
                                    </DataGridTextColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </StackPanel>
                    </Border>
                </StackPanel>

                <!-- ìš°ì¸¡: ì‹¤ê±°ëž˜ê°€ + ë‚™ì°°í†µê³„ + í‰ê°€ê²°ê³¼ -->
                <StackPanel Grid.Column="2">
                    
                    <!-- ì‹¤ê±°ëž˜ê°€ ì˜ì—­ -->
                    <Border Style="{StaticResource CardStyle}">
                        <StackPanel>
                            <Grid Margin="0,0,0,12">
                                <TextBlock Text="ðŸ’° ì‹¤ê±°ëž˜ê°€" Style="{StaticResource SectionHeaderStyle}" Margin="0"/>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                    <Button Content="ì¡°íšŒ" 
                                            Command="{Binding FetchRealTransactionCommand}"
                                            Style="{StaticResource SecondaryButton}"
                                            Padding="12,4"
                                            FontSize="12"
                                            Margin="0,0,8,0"/>
                                    <Button Content="ðŸ”— rt.molit.go.kr" 
                                            Command="{Binding OpenRealTransactionSiteCommand}"
                                            Style="{StaticResource SecondaryButton}"
                                            Padding="12,4"
                                            FontSize="12"/>
                                </StackPanel>
                            </Grid>
                            
                            <!-- ì‹¤ê±°ëž˜ê°€ í…Œì´ë¸” -->
                            <DataGrid ItemsSource="{Binding RealTransactions}"
                                      AutoGenerateColumns="False"
                                      CanUserAddRows="False"
                                      CanUserDeleteRows="False"
                                      HeadersVisibility="Column"
                                      GridLinesVisibility="All"
                                      BorderThickness="1"
                                      BorderBrush="{StaticResource BlueGray200Brush}"
                                      MaxHeight="150"
                                      FontSize="12">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="ê±°ëž˜ë©´ì " Binding="{Binding Area, StringFormat=N2}" Width="80"/>
                                    <DataGridTextColumn Header="ê±°ëž˜ì¼ìž" Binding="{Binding TransactionDate, StringFormat=yyyy-MM-dd}" Width="90"/>
                                    <DataGridTextColumn Header="ê±°ëž˜ê¸ˆì•¡" Binding="{Binding Amount, StringFormat=N0}" Width="100"/>
                                    <DataGridTextColumn Header="ì¸µìˆ˜" Binding="{Binding Floor}" Width="50"/>
                                    <DataGridTextColumn Header="ë“±ê¸°ì—¬ë¶€" Binding="{Binding IsRegistered}" Width="60"/>
                                    <DataGridCheckBoxColumn Header="ì ìš©" Binding="{Binding IsApplied}" Width="50"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </StackPanel>
                    </Border>

                    <!-- ë‚™ì°°í†µê³„ ì˜ì—­ - í”¼ë“œë°± ë°˜ì˜: ì‹œ/êµ°êµ¬/ë™ 3Ã—3 ë§¤íŠ¸ë¦­ìŠ¤ -->
                    <Border Style="{StaticResource CardStyle}">
                        <StackPanel>
                            <Grid Margin="0,0,0,12">
                                <TextBlock Text="ðŸ“ˆ ë‚™ì°°í†µê³„" Style="{StaticResource SectionHeaderStyle}" Margin="0"/>
                                <!-- ì ìš©ë‚™ì°°ê°€ìœ¨ í—¤ë” - í”¼ë“œë°± ë°˜ì˜: ê°€ì‹œì„± ê°œì„  -->
                                <TextBlock Text="ì ìš©ë‚™ì°°ê°€ìœ¨" 
                                           HorizontalAlignment="Right"
                                           FontSize="14"
                                           FontWeight="Bold"
                                           Foreground="{StaticResource PrimaryBrush}"/>
                            </Grid>
                            
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="80"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <!-- í—¤ë” í–‰ -->
                                <Border Grid.Row="0" Grid.Column="0" Background="{StaticResource BlueGray100Brush}" Padding="8,6" Margin="0,0,1,1">
                                    <TextBlock Text="ì§€ì—­í†µê³„" Style="{StaticResource LabelStyle}" FontWeight="SemiBold"/>
                                </Border>
                                <Border Grid.Row="0" Grid.Column="1" Background="{StaticResource BlueGray100Brush}" Padding="8,6" Margin="0,0,1,1">
                                    <TextBlock Text="{Binding RegionName1}" Style="{StaticResource ValueStyle}" FontWeight="SemiBold" HorizontalAlignment="Center"/>
                                </Border>
                                <Border Grid.Row="0" Grid.Column="2" Background="{StaticResource BlueGray100Brush}" Padding="8,6" Margin="0,0,1,1">
                                    <TextBlock Text="{Binding RegionName2}" Style="{StaticResource ValueStyle}" FontWeight="SemiBold" HorizontalAlignment="Center"/>
                                </Border>
                                <Border Grid.Row="0" Grid.Column="3" Background="{StaticResource BlueGray100Brush}" Padding="8,6" Margin="0,0,0,1">
                                    <TextBlock Text="{Binding RegionName3}" Style="{StaticResource ValueStyle}" FontWeight="SemiBold" HorizontalAlignment="Center"/>
                                </Border>

                                <!-- 1ë…„ í‰ê·  -->
                                <Border Grid.Row="1" Grid.Column="0" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="1,0,1,1" Padding="8,6">
                                    <TextBlock Text="1ë…„ í‰ê· " Style="{StaticResource LabelStyle}"/>
                                </Border>
                                <Border Grid.Row="1" Grid.Column="1" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="0,0,1,1" Padding="8,6">
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                        <TextBlock Text="{Binding Stats1Year_Rate1, StringFormat={}{0:P1}}" Style="{StaticResource ValueStyle}"/>
                                        <TextBlock Text=" / " Style="{StaticResource LabelStyle}" FontSize="11"/>
                                        <TextBlock Text="{Binding Stats1Year_Count1, StringFormat={}{0}ê±´}" Style="{StaticResource LabelStyle}" FontSize="11"/>
                                    </StackPanel>
                                </Border>
                                <Border Grid.Row="1" Grid.Column="2" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="0,0,1,1" Padding="8,6">
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                        <TextBlock Text="{Binding Stats1Year_Rate2, StringFormat={}{0:P1}}" Style="{StaticResource ValueStyle}"/>
                                        <TextBlock Text=" / " Style="{StaticResource LabelStyle}" FontSize="11"/>
                                        <TextBlock Text="{Binding Stats1Year_Count2, StringFormat={}{0}ê±´}" Style="{StaticResource LabelStyle}" FontSize="11"/>
                                    </StackPanel>
                                </Border>
                                <Border Grid.Row="1" Grid.Column="3" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="0,0,1,1" Padding="8,6">
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                        <TextBlock Text="{Binding Stats1Year_Rate3, StringFormat={}{0:P1}}" Style="{StaticResource ValueStyle}"/>
                                        <TextBlock Text=" / " Style="{StaticResource LabelStyle}" FontSize="11"/>
                                        <TextBlock Text="{Binding Stats1Year_Count3, StringFormat={}{0}ê±´}" Style="{StaticResource LabelStyle}" FontSize="11"/>
                                    </StackPanel>
                                </Border>

                                <!-- 6ê°œì›” í‰ê·  -->
                                <Border Grid.Row="2" Grid.Column="0" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="1,0,1,1" Padding="8,6">
                                    <TextBlock Text="6ê°œì›” í‰ê· " Style="{StaticResource LabelStyle}"/>
                                </Border>
                                <Border Grid.Row="2" Grid.Column="1" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="0,0,1,1" Padding="8,6">
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                        <TextBlock Text="{Binding Stats6Month_Rate1, StringFormat={}{0:P1}}" Style="{StaticResource ValueStyle}"/>
                                        <TextBlock Text=" / " Style="{StaticResource LabelStyle}" FontSize="11"/>
                                        <TextBlock Text="{Binding Stats6Month_Count1, StringFormat={}{0}ê±´}" Style="{StaticResource LabelStyle}" FontSize="11"/>
                                    </StackPanel>
                                </Border>
                                <Border Grid.Row="2" Grid.Column="2" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="0,0,1,1" Padding="8,6">
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                        <TextBlock Text="{Binding Stats6Month_Rate2, StringFormat={}{0:P1}}" Style="{StaticResource ValueStyle}"/>
                                        <TextBlock Text=" / " Style="{StaticResource LabelStyle}" FontSize="11"/>
                                        <TextBlock Text="{Binding Stats6Month_Count2, StringFormat={}{0}ê±´}" Style="{StaticResource LabelStyle}" FontSize="11"/>
                                    </StackPanel>
                                </Border>
                                <Border Grid.Row="2" Grid.Column="3" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="0,0,1,1" Padding="8,6">
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                        <TextBlock Text="{Binding Stats6Month_Rate3, StringFormat={}{0:P1}}" Style="{StaticResource ValueStyle}"/>
                                        <TextBlock Text=" / " Style="{StaticResource LabelStyle}" FontSize="11"/>
                                        <TextBlock Text="{Binding Stats6Month_Count3, StringFormat={}{0}ê±´}" Style="{StaticResource LabelStyle}" FontSize="11"/>
                                    </StackPanel>
                                </Border>

                                <!-- 3ê°œì›” í‰ê·  -->
                                <Border Grid.Row="3" Grid.Column="0" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="1,0,1,1" Padding="8,6">
                                    <TextBlock Text="3ê°œì›” í‰ê· " Style="{StaticResource LabelStyle}"/>
                                </Border>
                                <Border Grid.Row="3" Grid.Column="1" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="0,0,1,1" Padding="8,6">
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                        <TextBlock Text="{Binding Stats3Month_Rate1, StringFormat={}{0:P1}}" Style="{StaticResource ValueStyle}"/>
                                        <TextBlock Text=" / " Style="{StaticResource LabelStyle}" FontSize="11"/>
                                        <TextBlock Text="{Binding Stats3Month_Count1, StringFormat={}{0}ê±´}" Style="{StaticResource LabelStyle}" FontSize="11"/>
                                    </StackPanel>
                                </Border>
                                <Border Grid.Row="3" Grid.Column="2" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="0,0,1,1" Padding="8,6">
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                        <TextBlock Text="{Binding Stats3Month_Rate2, StringFormat={}{0:P1}}" Style="{StaticResource ValueStyle}"/>
                                        <TextBlock Text=" / " Style="{StaticResource LabelStyle}" FontSize="11"/>
                                        <TextBlock Text="{Binding Stats3Month_Count2, StringFormat={}{0}ê±´}" Style="{StaticResource LabelStyle}" FontSize="11"/>
                                    </StackPanel>
                                </Border>
                                <Border Grid.Row="3" Grid.Column="3" BorderBrush="{StaticResource BlueGray200Brush}" BorderThickness="0,0,1,1" Padding="8,6">
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                        <TextBlock Text="{Binding Stats3Month_Rate3, StringFormat={}{0:P1}}" Style="{StaticResource ValueStyle}"/>
                                        <TextBlock Text=" / " Style="{StaticResource LabelStyle}" FontSize="11"/>
                                        <TextBlock Text="{Binding Stats3Month_Count3, StringFormat={}{0}ê±´}" Style="{StaticResource LabelStyle}" FontSize="11"/>
                                    </StackPanel>
                                </Border>

                                <!-- ì ìš© ë‚™ì°°ê°€ìœ¨ - í”¼ë“œë°± ë°˜ì˜: ê°€ì‹œì„± ëŒ€í­ ê°œì„  -->
                                <Border Grid.Row="0" Grid.RowSpan="4" Grid.Column="4"
                                        Background="{StaticResource PrimaryBrush}"
                                        CornerRadius="8"
                                        Padding="20,12"
                                        Margin="12,0,0,0"
                                        VerticalAlignment="Center">
                                    <StackPanel>
                                        <TextBlock Text="{Binding AppliedBidRate, StringFormat={}{0:P1}}" 
                                                   FontSize="28"
                                                   FontWeight="Bold"
                                                   Foreground="White"
                                                   HorizontalAlignment="Center"/>
                                        <TextBlock Text="{Binding AppliedBidRateDescription}" 
                                                   FontSize="11"
                                                   Foreground="White"
                                                   Opacity="0.9"
                                                   HorizontalAlignment="Center"
                                                   TextWrapping="Wrap"
                                                   MaxWidth="100"
                                                   TextAlignment="Center"
                                                   Margin="0,6,0,0"/>
                                    </StackPanel>
                                </Border>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- í‰ê°€ê²°ê³¼ ì˜ì—­ -->
                    <Border Style="{StaticResource CardStyle}">
                        <StackPanel>
                            <TextBlock Text="âœ… í‰ê°€ê²°ê³¼" Style="{StaticResource SectionHeaderStyle}"/>
                            
                            <!-- ì‹œë‚˜ë¦¬ì˜¤ 1 -->
                            <Border Background="{StaticResource BlueGray50Brush}" 
                                    CornerRadius="4" 
                                    Padding="16"
                                    Margin="0,0,0,12">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <TextBlock Grid.Row="0" Grid.ColumnSpan="4" 
                                               Text="ì‹œë‚˜ë¦¬ì˜¤ 1" 
                                               FontWeight="Bold" FontSize="14"
                                               Foreground="{StaticResource PrimaryBrush}"
                                               Margin="0,0,0,12"/>

                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="ë‚™ì°°ê°€ì•¡" Style="{StaticResource LabelStyle}"/>
                                    <TextBlock Grid.Row="1" Grid.Column="1" 
                                               Text="{Binding Scenario1_Amount, StringFormat={}{0:N0}ì›}" 
                                               Style="{StaticResource AmountStyle}"
                                               Margin="8,0,24,0"/>
                                    <TextBlock Grid.Row="1" Grid.Column="2" Text="ë‚™ì°°ê°€ìœ¨" Style="{StaticResource LabelStyle}"/>
                                    <TextBlock Grid.Row="1" Grid.Column="3" 
                                               Text="{Binding Scenario1_Rate, StringFormat={}{0:P1}}" 
                                               Style="{StaticResource ValueStyle}"
                                               Margin="8,0,0,0"/>

                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="í‰ê°€ ì‚¬ìœ " Style="{StaticResource LabelStyle}" Margin="0,8,0,0"/>
                                    <TextBox Grid.Row="2" Grid.Column="1" Grid.ColumnSpan="3"
                                             Text="{Binding Scenario1_Reason, UpdateSourceTrigger=PropertyChanged}"
                                             Margin="8,8,0,0"
                                             Padding="8,4"
                                             FontSize="12"/>
                                </Grid>
                            </Border>

                            <!-- ì‹œë‚˜ë¦¬ì˜¤ 2 -->
                            <Border Background="{StaticResource BlueGray50Brush}" 
                                    CornerRadius="4" 
                                    Padding="16">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <TextBlock Grid.Row="0" Grid.ColumnSpan="4" 
                                               Text="ì‹œë‚˜ë¦¬ì˜¤ 2" 
                                               FontWeight="Bold" FontSize="14"
                                               Foreground="{StaticResource SecondaryBrush}"
                                               Margin="0,0,0,12"/>

                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="ë‚™ì°°ê°€ì•¡" Style="{StaticResource LabelStyle}"/>
                                    <TextBlock Grid.Row="1" Grid.Column="1" 
                                               Text="{Binding Scenario2_Amount, StringFormat={}{0:N0}ì›}" 
                                               Style="{StaticResource AmountStyle}"
                                               Foreground="{StaticResource SecondaryBrush}"
                                               Margin="8,0,24,0"/>
                                    <TextBlock Grid.Row="1" Grid.Column="2" Text="ë‚™ì°°ê°€ìœ¨" Style="{StaticResource LabelStyle}"/>
                                    <TextBlock Grid.Row="1" Grid.Column="3" 
                                               Text="{Binding Scenario2_Rate, StringFormat={}{0:P1}}" 
                                               Style="{StaticResource ValueStyle}"
                                               Margin="8,0,0,0"/>

                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="í‰ê°€ ì‚¬ìœ " Style="{StaticResource LabelStyle}" Margin="0,8,0,0"/>
                                    <TextBox Grid.Row="2" Grid.Column="1" Grid.ColumnSpan="3"
                                             Text="{Binding Scenario2_Reason, UpdateSourceTrigger=PropertyChanged}"
                                             Margin="8,8,0,0"
                                             Padding="8,4"
                                             FontSize="12"/>
                                </Grid>
                            </Border>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Grid>

            <!-- ë©”ì‹œì§€ í‘œì‹œ -->
            <Border Grid.Row="1" 
                    Background="#E8F5E9" 
                    CornerRadius="4" 
                    Padding="12"
                    Margin="0,16,0,0"
                    VerticalAlignment="Bottom"
                    Visibility="{Binding SuccessMessage, Converter={StaticResource NullToVisibilityConverter}}">
                <TextBlock Text="{Binding SuccessMessage}" 
                           Foreground="#2E7D32"
                           FontSize="13"/>
            </Border>

            <Border Grid.Row="1" 
                    Background="#FFEBEE" 
                    CornerRadius="4" 
                    Padding="12"
                    Margin="0,16,0,0"
                    VerticalAlignment="Bottom"
                    Visibility="{Binding ErrorMessage, Converter={StaticResource NullToVisibilityConverter}}">
                <TextBlock Text="{Binding ErrorMessage}" 
                           Foreground="#C62828"
                           FontSize="13"/>
            </Border>
        </Grid>
    </ScrollViewer>
</UserControl>

